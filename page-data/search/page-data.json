{"componentChunkName":"component---src-pages-search-tsx","path":"/search/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"rawMarkdownBody":"# 1. íšŒì›ê°€ì… API ì‘ì„±\n\n## SecurityUtil í´ë˜ìŠ¤\n\nê°„ë‹¨í•œ ìœ í‹¸ë¦¬í‹° ë©”ì†Œë“œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ `SecurityUtil` í´ë˜ìŠ¤ë¥¼ util íŒ¨í‚¤ì§€ì— ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\npublic class SecurityUtil {\n\n   private static final Logger logger = LoggerFactory.getLogger(SecurityUtil.class);\n\n   private SecurityUtil() {\n   }\n\n   public static Optional<String> getCurrentUsername() {\n      final Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n\n      if (authentication == null) {\n         logger.debug(\"Security Contextì— ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\n         return Optional.empty();\n      }\n\n      String username = null;\n      if (authentication.getPrincipal() instanceof UserDetails) {\n         UserDetails springSecurityUser = (UserDetails) authentication.getPrincipal();\n         username = springSecurityUser.getUsername();\n      } else if (authentication.getPrincipal() instanceof String) {\n         username = (String) authentication.getPrincipal();\n      }\n\n      return Optional.ofNullable(username);\n   }\n```\n\n`getCurrentUsername` ë©”ì†Œë“œì˜ ì—­í™œì€ SecurityContextì˜ Authentication ê°ì²´ë¥¼ ì´ìš©í•´ `username`ì„ ë¦¬í„´í•´ì£¼ëŠ” ê°„ë‹¨í•œ ìœ í‹¸ì„± ë©”ì†Œë“œì…ë‹ˆë‹¤. \n\n`SecurityContext`ì— Authenticaion ê°ì²´ê°€ ì €ì¥ë˜ëŠ” ì‹œì ì€ JwtFilterì˜ `doFilter`ë©”ì†Œë“œì—ì„œ Requestê°€ ë“¤ì–´ì˜¬ë•Œ SecurityContextì— Authenticaion ê°ì²´ë¥¼ ì €ì¥í•´ì„œ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.\n\n## UserService í´ë˜ìŠ¤\n\níšŒì›ê°€ì…, ìœ ì € ì •ë³´ ì¡°íšŒë“±ì˜ ë©”ì†Œë“œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ UserService í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\n@Service\npublic class UserService {\n    private final UserRepository userRepository;\n    private final PasswordEncoder passwordEncoder;\n\n    public UserService(UserRepository userRepository, PasswordEncoder passwordEncoder) {\n        this.userRepository = userRepository;\n        this.passwordEncoder = passwordEncoder;\n    }\n\n@Transactional\n    public User signup(UserDto userDto) {\n        if (userRepository.findOneWithAuthoritiesByUsername(userDto.getUsername()).orElse(null) != null) {\n            throw new RuntimeException(\"ì´ë¯¸ ê°€ì…ë˜ì–´ ìˆëŠ” ìœ ì €ì…ë‹ˆë‹¤.\");\n        }\n\n        Authority authority = Authority.builder()\n                .authorityName(\"ROLE_USER\")\n                .build();\n\n        User user = User.builder()\n                .username(userDto.getUsername())\n                .password(passwordEncoder.encode(userDto.getPassword()))\n                .nickname(userDto.getNickname())\n                .authorities(Collections.singleton(authority))\n                .activated(true)\n                .build();\n\n        return userRepository.save(user);\n    }\n\n    @Transactional(readOnly = true)\n    public Optional<User> getUserWithAuthorities(String username) {\n        return userRepository.findOneWithAuthoritiesByUsername(username);\n    }\n\n    @Transactional(readOnly = true)\n    public Optional<User> getMyUserWithAuthorities() {\n        return SecurityUtil.getCurrentUsername().flatMap(userRepository::findOneWithAuthoritiesByUsername);\n    }\n}\n```\n\nUserService í´ë˜ìŠ¤ëŠ” `UserRepository`, `PasswordEncoder`ë¥¼ ì£¼ì…ë°›ìŠµë‹ˆë‹¤.\n\n`singup` ë©”ì†Œë“œëŠ” usernameì´ DBì— ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ Authorityì™€ User ì •ë³´ë¥¼ ìƒì„±í•´ì„œ UserRepositoryì˜ `save`ë©”ì†Œë“œë¥¼ í†µí•´ DBì— ì •ë³´ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. \n\nì—¬ê¸°ì„œ **ì¤‘ìš”í•œ ì **ì€ `singup` ë©”ì†Œë“œë¥¼ í†µí•´ ê°€ì…í•œ íšŒì›ì€ USER ROLEì„ ê°€ì§€ê³  ìˆê³  `data.sql` ì—ì„œ ìë™ ìƒì„±ë˜ëŠ” admin ê³„ì •ì€ USER, ADMIN ROLEì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤ ì´ ì°¨ì´ë¥¼ í†µí•´ ê¶Œí•œê²€ì¦ ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸ í•˜ê² ìŠµë‹ˆë‹¤.\n\nê·¸ë¦¬ê³  ìœ ì € ê¶Œí•œì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë©”ì†Œë“œê°€ 2ê°œ ìˆìŠµë‹ˆë‹¤.\n\n`getUserWithAuthorities`ëŠ” usernameì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³ \n\n`getMyUserWithAuthorities`ëŠ” SecurityContextì— ì €ì¥ëœ usernameì˜ ì •ë³´ë§Œ ê°€ì ¸ì˜µë‹ˆë‹¤.\n\nì´ ë‘ê°€ì§€ ë©”ì†Œë“œì˜ í—ˆìš©ê¶Œí•œì„ ë‹¤ë¥´ê²Œ í•´ì„œ ê¶Œí•œê²€ì¦ì— ëŒ€í•œ ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•˜ê² ìŠµë‹ˆë‹¤.\n\n# 2. ê¶Œí•œ ê²€ì¦\n\n## UserController í´ë˜ìŠ¤\n\n`UserService`ì˜ ë©”ì†Œë“œë“¤ì„ í˜¸ì¶œí•  `UserController` í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\n@RestController\n@RequestMapping(\"/api\")\npublic class UserController {\n    private final UserService userService;\n\n    public UserController(UserService userService) {\n        this.userService = userService;\n    }\n\n    @PostMapping(\"/signup\")\n    public ResponseEntity<User> signup(@Valid @RequestBody UserDto userDto) {\n        return ResponseEntity.ok(userService.signup(userDto));\n    }\n\n    @GetMapping(\"/user\")\n    @PreAuthorize(\"hasAnyRole('USER','ADMIN')\")\n    public ResponseEntity<User> getMyUserInfo(HttpServletRequest request) {\n        return ResponseEntity.ok(userService.getMyUserWithAuthorities().get());\n    }\n\n    @GetMapping(\"/user/{username}\")\n    @PreAuthorize(\"hasAnyRole('ADMIN')\")\n    public ResponseEntity<User> getUserInfo(@PathVariable String username) {\n        return ResponseEntity.ok(userService.getUserWithAuthorities(username).get());\n    }\n}\n```\n\n- `@PreAuthorize`\n    - í•´ë‹¹ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ì´ì „ì— ê¶Œí•œì„ ê²€ì‚¬í•œë‹¤\n- `hasAnyRole([role1, role2])`\n    - í˜„ì¬ ì‚¬ìš©ìì˜ ê¶Œí•œì´ íŒŒë¼ë¯¸í„°ì˜ ê¶Œí•œ ì¤‘ ì¼ì¹˜í•˜ëŠ” ê²ƒì´ ìˆëŠ” ê²½ìš° `true` ë¥¼ ë¦¬í„´\n\n`sinup` ë©”ì†Œë“œëŠ” UserDtoë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ UserServiceì˜ `singup` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.\n\n`getMyUserInfo` ë©”ì†Œë“œëŠ” `@PreAuthorize`ë¥¼ í†µí•´ì„œ USER, ADMIN ë‘ê°€ì§€ ê¶Œí•œ ëª¨ë‘ í—ˆìš©í–ˆê³ \n\n`getUserInfo` ë©”ì†Œë“œëŠ” ADMIN ê¶Œí•œë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤ ê·¸ë¦¬ê³  `UserService`ì—ì„œ ë§Œë“¤ì—ˆë˜ username ë§¤ê°œë³€ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìœ ì € ì •ë³´ì™€ ê¶Œí•œ ì •ë³´ë¥¼ ë¦¬í„´í•˜ëŠ” APIê°€ ë˜ê² ìŠµë‹ˆë‹¤. \n\n# 3. Response ì‹œ DTOë¥¼ í†µí•´ì„œë§Œ ë°›ê¸°\n\n## ê¸°ì¡´ ë¬¸ì œì \n\nì¶”ê°€ì ìœ¼ë¡œ ì§€ê¸ˆê¹Œì§€ ë¡œì§ì„ ë³´ì‹œë©´ ì‚¬ìš©ì ìš”ì²­ì— ëŒ€í•´ ì‘ë‹µì„ Entity ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ìˆìŠµë‹ˆë‹¤.  ë¬¸ì œì ì„ ë³´ê¸°ìœ„í•´ Entityë¥¼ í†µí•´ ë°˜í™˜ì„ í•˜ê²Œ ë˜ë©´ ì–´ë–¤ ê²°ê³¼ë¥¼ ë‚˜ì˜¤ëŠ”ì§€ ë³´ê² ìŠµë‹ˆë‹¤.\n\n- Response - `POST` /api/signup\n\n```json\n{\n    \"userId\": 3,\n    \"username\": \"hoon\",\n    \"password\": \"$2a$10$PZhLrJzS9YQX1.M5.ezMhu/VFAbtSiYLU.ExF3qzlBrrk7bHPyzdm\",\n    \"nickname\": \"nick\",\n    \"activated\": true,\n    \"authorities\": [\n        {\n            \"authorityName\": \"ROLE_USER\"\n        }\n    ]\n}\n```\n\ní•´ë‹¹ ì‘ë‹µ ê²°ê³¼ì²˜ëŸ¼, ë³´ì‹œë©´ì€ ì¤‘ìš”í•œ ì •ë³´ë“¤ì´ ê·¸ëŒ€ë¡œ ë°˜í™˜ì´ ë©ë‹ˆë‹¤ ê·¸ ì´ìœ ëŠ” `UserService`ì˜ íšŒì›ê°€ì… ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ë©”ì†Œë“œê°€ User Entity ê·¸ëŒ€ë¡œ ë°˜í™˜í•´ì£¼ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì¸¡ì—ì„œëŠ” í•´ë‹¹ ê²°ê³¼ë¥¼ ë°›ê²Œë©ë‹ˆë‹¤.\n\në³´ì•ˆì ì¸ ì¸¡ë©´ì—ì„œë„ ì•ˆì¢‹ì€ ë°©ì‹ì´ë¯€ë¡œ DTOë¥¼ í†µí•´ ì‘ë‹µí•˜ë„ë¡ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.\n\n## í•´ê²°ë²•\n\n### AuthorityDto í´ë˜ìŠ¤ ìƒì„±\n\nê¶Œí•œì •ë³´ì— ëŒ€í•œ DTO í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class AuthorityDto {\n    private String authorityName;\n}\n```\n\n### UserDto í´ë˜ìŠ¤ ìˆ˜ì •\n\nì•„ë˜ì™€ ê°™ì´ ê¶Œí•œ ì •ë³´ì— ëŒ€í•œ `authorityDtoSet` í•„ë“œë¥¼ ì¶”ê°€í•˜ê³  `from` ë©”ì†Œë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n```java\nprivate Set<AuthorityDto> authorityDtoSet;\n\n    public static UserDto from(User user) {\n        if(user == null) return null;\n\n        return UserDto.builder()\n                .username(user.getUsername())\n                .nickname(user.getNickname())\n                .authorityDtoSet(user.getAuthorities().stream()\n                        .map(authority -> AuthorityDto.builder().authorityName(authority.getAuthorityName()).build())\n                        .collect(Collectors.toSet()))\n                .build();\n    }\n```\n\n`from` ë©”ì†Œë“œëŠ” `User` ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ í•´ë‹¹ ê°ì²´ê°€ `null`ì´ ì•„ë‹ˆë©´, í•´ë‹¹ ê°ì²´ë¥¼ `UserDto`ë¡œ ìƒì„±í•´ì„œ ë°˜í™˜í•©ë‹ˆë‹¤.\n\n### UserService í´ë˜ìŠ¤ ìˆ˜ì •\n\n`User`ë¡œ ë°˜í™˜í•˜ë˜ ì´ì „ ë©”ì†Œë“œë“¤ì„ `UserDto`ë¡œ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤. (êµµì€ ê¸€ì”¨ë¥¼ ë´ì£¼ì„¸ìš”)\n\n```java\n@Transactional\n    public **UserDto** signup(UserDto userDto) {\n        if (userRepository.findOneWithAuthoritiesByUsername(userDto.getUsername()).orElse(null) != null) {\n            throw new RuntimeException(\"ì´ë¯¸ ê°€ì…ë˜ì–´ ìˆëŠ” ìœ ì €ì…ë‹ˆë‹¤.\");\n        }\n\n        Authority authority = Authority.builder()\n                .authorityName(\"ROLE_USER\")\n                .build();\n\n        User user = User.builder()\n                .username(userDto.getUsername())\n                .password(passwordEncoder.encode(userDto.getPassword()))\n                .nickname(userDto.getNickname())\n                .authorities(Collections.singleton(authority))\n                .activated(true)\n                .build();\n\n        return **UserDto.from**(userRepository.save(user));\n    }\n\n    @Transactional(readOnly = true)\n    public **UserDto** getUserWithAuthorities(String username) {\n        return **UserDto.from**(userRepository.findOneWithAuthoritiesByUsername(username)**.orElse(null))**;\n    }\n\n    @Transactional(readOnly = true)\n    public **UserDto** getMyUserWithAuthorities() {\n        return **UserDto.from**(SecurityUtil.getCurrentUsername().flatMap(userRepository::findOneWithAuthoritiesByUsername)**.orElse(null))**;\n    }\n```\n\níšŒì›ê°€ì… ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” `signup` ë©”ì†Œë“œëŠ” ê¸°ì¡´ ì†ŒìŠ¤ ê·¸ëŒ€ë¡œì—ì„œ `UserDto.from` ì„ í†µí•´ `User`ë¥¼ Dtoë¡œ ìƒì„±í•´ì„œ ë°˜í™˜í•©ë‹ˆë‹¤.\n\në‚˜ë¨¸ì§€ ë‘ê°œì˜ ê¶Œí•œ ì •ë³´ì„ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œë„ `UserDto`ë¡œ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤.\n\nê¸°ì¡´ì—ëŠ” `Optional`ì„ í†µí•´ì„œ `null` ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì¤¬ì§€ë§Œ, ì´ì   `null` ê°’ì´ ë“¤ì–´ì˜¤ë©´ í•´ë‹¹ ê°’ ê·¸ëŒ€ë¡œ ë¦¬í„´í•©ë‹ˆë‹¤.\n\n### UserController í´ë˜ìŠ¤ ìˆ˜ì •\n\nìš”ì²­ì— ëŒ€í•´ `User`ë¡œ ë°˜í™˜í•˜ë˜ ì´ì „ ë©”ì†Œë“œë“¤ì„ `UserDto`ë¡œ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\n@PostMapping(\"/signup\")\n    public ResponseEntity<**UserDto**> signup(@Valid @RequestBody UserDto userDto) {\n        return ResponseEntity.ok(userService.signup(userDto));\n    }\n\n    @GetMapping(\"/user\")\n    @PreAuthorize(\"hasAnyRole('USER','ADMIN')\")\n    public ResponseEntity<**UserDto**> getMyUserInfo(HttpServletRequest request) {\n        return ResponseEntity.ok(userService.getMyUserWithAuthorities());\n    }\n\n    @GetMapping(\"/user/{username}\")\n    @PreAuthorize(\"hasAnyRole('ADMIN')\")\n    public ResponseEntity<**UserDto**> getUserInfo(@PathVariable String username) {\n        return ResponseEntity.ok(userService.getUserWithAuthorities(username));\n    }\n```\n\nê¸°ì¡´ê³¼ ë¹„ìŠ·í•˜ê²Œ ë°˜í™˜í•˜ëŠ” ê°ì²´ë¥¼ `UserDto`ë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤.\n\nAPI ìš”ì²­ì— ëŒ€í•´ `Entity`ì„ ë°˜í™˜í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ `Dto`ë¥¼ ë°˜í™˜í•˜ëŠ” ì½”ë“œë¡œ ë³€ê²½ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.\n\n# 4. íšŒì›ê°€ì… API í…ŒìŠ¤íŠ¸\n\nì´ì œ ìš°ë¦¬ê°€ ë§Œë“  3ê°œì˜ APIë¥¼ Postman, H2 Consoleë¥¼ ì´ìš©í•´ í…ŒìŠ¤íŠ¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n## íšŒì›ê°€ì… ìš”ì²­\n\nURL : [http://localhost:8080/api/signup](http://localhost:8080/api/signup) ê²½ë¡œë¡œ `POST` ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.\n\n![Untitled](5-1.png)\n\n- Response\n    \n    ```json\n    {\n        \"username\": \"hoon\",\n        \"nickname\": \"nick\",\n        \"authorityDtoSet\": [\n            {\n                \"authorityName\": \"ROLE_USER\"\n            }\n        ]\n    }\n    ```\n    \n\níšŒì›ê°€ì… APIì— ëŒ€í•œ ì‘ë‹µì´ ì •ìƒì ìœ¼ë¡œ ë°˜í™˜ë¬ìŠµë‹ˆë‹¤ ì´ì œ ê°€ì…ëœ ìœ ì €ì •ë³´ë¥¼ H2 Console ì—ì„œ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n### H2 Console\n\n<img src=\"5-2.png\" width=\"300\" height=\"500\"/>\n\nì¶”ê°€í•œ ìœ ì € ì •ë³´ê°€ ì˜ ë“±ë¡ëœê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\nì´ì œ ê¶Œí•œì´ ë‹¤ë¥¸ ë‘ ê³„ì •(admin, uesr)ì„ ê°€ì§€ê³  ë‘ ê°œì˜ APIë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n## ê¶Œí•œ API í…ŒìŠ¤íŠ¸\n\në¨¼ì € ADMIN ê¶Œí•œë§Œ í—ˆìš©í–ˆë˜ APIë¥¼ í…ŒìŠ¤íŠ¸í•˜ê² ìŠµë‹ˆë‹¤.\n\nURL : [http://localhost:8080/api/user/hoon](http://localhost:8080/api/user/hoon) ê²½ë¡œë¡œ GET ìš”ì²­ì„ í•©ë‹ˆë‹¤.\n\n- Response - `GET` /api/user/hoon\n    \n    ![Untitled](5-3.png)\n    \n\n401 ìƒíƒœê°€ ë°˜í™˜ëœê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n### JWT Token ê°€ì ¸ì˜¤ê¸°\n\nADMIN ê³„ì •ì„ ë¡œê·¸ì¸í•´ì„œ tokenì„ ê°€ì ¸ì˜¤ê² ìŠµë‹ˆë‹¤,\n\nURL : [http://localhost:8080/api/authenticate](http://localhost:8080/api/authenticate) ê²½ë¡œì— POST ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.\n\n- Response - `POST` /api/authenticate\n    \n    ```json\n    {\n        \"token\": \"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImF1dGgiOiJST0xFX0FETUlOLFJPTEVfVVNFUiIsImV4cCI6MTY0MjE2NTU3N30.UyNbN-cX82pIRHOMKWTjnDSTLX-TWzER3otxNaKKTxeB9egSL2gp8FMzr5wznIFRXEyBdU-1cFMcKnQerBjiGg\"\n    }\n    ```\n    \n\nê·¸ë¦¬ê³  í•´ë‹¹ ì–´ë“œë¯¼ ìœ ì €ì˜ í† í°ì„ HTTP Headersì— `Authorization : Bearer {jwt_token}` í˜•ì‹ìœ¼ë¡œ ë‹´ê³  ë‹¤ì‹œ ê¶Œí•œ API ê²½ë¡œë¡œ GET ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.\n\n### ADMIN ê¶Œí•œ í…ŒìŠ¤íŠ¸\n\n- Response - `GET` /api/user/hoon\n    \n    ```json\n    {\n        \"username\": \"hoon\",\n        \"nickname\": \"nick\",\n        \"authorityDtoSet\": [\n            {\n                \"authorityName\": \"ROLE_USER\"\n            }\n        ]\n    }\n    ```\n    \n\n/api/user/hoon ê²½ë¡œëŠ” `ROLE_ADMIN` ê¶Œí•œì„ ê°€ì§„ ìœ ì €ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ë°. ì •ìƒì ìœ¼ë¡œ ì‘ë‹µì´ ëœê²ƒì„ í™•ì¸í• ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n### USER ê¶Œí•œ í…ŒìŠ¤íŠ¸\n\nì´ë²ˆì—ëŠ” hoon ê³„ì •ì˜ í† í°ìœ¼ë¡œ ì´ APIë¥¼ ì¬í˜¸ì¶œ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\n\nê¸°ì¡´ì— ë¡œê·¸ì¸ APIë¥¼ hoon ê³„ì •ìœ¼ë¡œ ìš”ì²­í•˜ê³ , í† í°ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.\n\n- Response - `POST` /api/authenticate\n    \n    ```json\n    {\n        \"token\": \"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJob29uIiwiYXV0aCI6IlJPTEVfVVNFUiIsImV4cCI6MTY0MjE2NjA1N30.UMN19s9OGrX10qcO6tgET91rggoatwtfutr6L2iuL4da67vF7vR_4D1zXOKb4_0pCVtamREhGsDm_Y-iMImBPg\"\n    }\n    ```\n    \n\nhoon ê³„ì •ìœ¼ë¡œ POST ìš”ì²­ì„ í–ˆê³  í•´ë‹¹ í† í°ì„ ì´ìš©í•´ì„œ ë‹¤ì‹œ API ë¥¼ í˜¸ì¶œí•˜ê² ìŠµë‹ˆë‹¤.\n\n- Response - `GET` /api/user/hoon\n    \n    ```json\n    {\n        \"timestamp\": \"2022-01-13T13:15:29.386+00:00\",\n        \"status\": 403,\n        \"error\": \"Forbidden\",\n        \"path\": \"/api/user/hoon\"\n    }\n    ```\n    \n\nhoon ê³„ì •ì˜ í† í°ìœ¼ë¡œ ìš”ì²­ì„ í•´ë³´ë©´ `403 Foribidden` ì—ëŸ¬ê°€ ë°˜í™˜ëœ ê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\ní•´ë‹¹ 403 Forbidden ì—ëŸ¬ëŠ” ì €í¬ê°€ ì‘ì„±í•œ `JwtAccessDeniedHandler`ì— ì˜í•´ ë°œìƒë¬ìŠµë‹ˆë‹¤.\n\nì´ë²ˆì—ëŠ” USERê¶Œí•œì„ í—ˆìš©í•´ì¤¬ë˜ APIë¥¼ hoon ê³„ì •ì˜ í† í°ìœ¼ë¡œ í˜¸ì¶œí•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n- Response - `GET` /api/user\n    \n    ```json\n    {\n        \"username\": \"hoon\",\n        \"nickname\": \"nick\",\n        \"authorityDtoSet\": [\n            {\n                \"authorityName\": \"ROLE_USER\"\n            }\n        ]\n    }\n    ```\n    \n\nhoon ê³„ì •ìœ¼ë¡œ ë°œê¸‰ë°›ì€ í† í°ìœ¼ë¡œ ì´ API ëŠ” ì˜ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\nì´ì œ í•´ë‹¹ ê°•ì˜ì—ì„œ ì¤€ë¹„í•œ JWT Tutorialì˜ ëª¨ë“  ë¶€ë¶„ì´ ì™„ë£Œë¬ìŠµë‹ˆë‹¤. ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ğŸ˜Š\n\n# Reference\n\n[https://gaemi606.tistory.com/entry/Spring-Boot-Spring-Security-PreAuthorizeì‚¬ìš©í•˜ê¸°](https://gaemi606.tistory.com/entry/Spring-Boot-Spring-Security-PreAuthorize%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)\n\n[https://steemit.com/kr-dev/@igna84/spring-security-preauthorize-postauthorize](https://steemit.com/kr-dev/@igna84/spring-security-preauthorize-postauthorize)","excerpt":"1. íšŒì›ê°€ì… API ì‘ì„± SecurityUtil í´ë˜ìŠ¤ ê°„ë‹¨í•œ ìœ í‹¸ë¦¬í‹° ë©”ì†Œë“œë¥¼ ë§Œë“¤ê¸° ìœ„í•´  í´ë˜ìŠ¤ë¥¼ util íŒ¨í‚¤ì§€ì— ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.  ë©”ì†Œë“œì˜ ì—­í™œì€ SecurityContextì˜ Authentication ê°ì²´ë¥¼ ì´ìš©í•´ ì„ ë¦¬í„´í•´ì£¼ëŠ” ê°„ë‹¨í•œâ€¦","fields":{"slug":"/springboot-jwt-tutorial5/"},"frontmatter":{"date":"Jan 14, 2022","title":"SpringBoot JWT íŠœí† ë¦¬ì–¼ - 5ì¥ íšŒì›ê°€ì…, ê¶Œí•œê²€ì¦ [ìµœì¢…]","tags":["SpringBoot","JWT","íŠœí† ë¦¬ì–¼"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"# 1. DTO í´ë˜ìŠ¤ ìƒì„±\n\n## LoginDto í´ë˜ìŠ¤\n\nì™¸ë¶€ì™€ì˜ í†µì‹ ì— ì‚¬ìš©í•  DTO íŒ¨í‚¤ì§€ ë° í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class LoginDto {\n\n    @NotNull\n    @Size(min = 3, max = 50)\n    private String username;\n\n    @NotNull\n    @Size(min = 3, max = 100)\n    private String password;\n}\n```\n\nLombok ì–´ë…¸í…Œì´ì…˜(Get, Set ë“±)ì´ ì¶”ê°€ë˜ì—ˆê³  @Valid ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.\n\në¡œê·¸ì¸ í•  ì´ìš©ìì˜ ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹´ì„ username, password í•„ë“œë¥¼ ê°€ì§‘ë‹ˆë‹¤.\n\n## TokenDto í´ë˜ìŠ¤\n\nToken ì •ë³´ë¥¼ Response í• ë•Œ ì‚¬ìš©í•  TokenDtoë¥¼ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.\n\n```java\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class TokenDto {\n\n    private String token;\n}\n```\n\n## UserDto í´ë˜ìŠ¤\n\níšŒì›ê°€ì…ì‹œì— ì‚¬ìš©í•  UserDto í´ë˜ìŠ¤ë„ ë¯¸ë¦¬ ë§Œë“¤ì–´ì£¼ê² ìŠµë‹ˆë‹¤.\n\n```java\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class UserDto {\n\n    @NotNull\n    @Size(min = 3, max = 50)\n    private String username;\n\n    @JsonProperty(access = JsonProperty.Access.WRITE_ONLY)\n    @NotNull\n    @Size(min = 3, max = 100)\n    private String password;\n\n    @NotNull\n    @Size(min = 3, max = 50)\n    private String nickname;\n}\n```\n\n# 2. Repository ê´€ë ¨ ì½”ë“œ ì‘ì„±\n\nì´ì œ Repositoryë“¤ì„ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ repository íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n## UserRepository ì¸í„°í˜ì´ìŠ¤\n\nì´ì „ì— ë§Œë“¤ì—ˆë˜ User ì—”í‹°í‹°ì— ë§¤í•‘ë˜ëŠ” UserRepository ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.\n\n```java\npublic interface UserRepository extends JpaRepository<User, Long> {\n    @EntityGraph(attributePaths = \"authorities\")\n    Optional<User> findOneWithAuthoritiesByUsername(String username);\n}\n```\n\n- `EntityGraph` : ì¿¼ë¦¬ê°€ ìˆ˜í–‰ë ë•Œ Lazy ì¡°íšŒê°€ ì•„ë‹ˆê³  Eagerì¡°íšŒë¡œ authorities ì •ë³´ë¥¼ ê°™ì´ê°€ì ¸ì˜µë‹ˆë‹¤.\n    - Lazy, Eager : ì§€ì—°ë¡œë”©(lazy), ì¦‰ì‹œë¡œë”©(eager) ì—°ê´€ê´€ê³„ì˜ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ê°€ì ¸ì˜¬ì§€ (fetch)\n\n`JpaRepository`ë¥¼ `extends` í•˜ë©´ `findAll`, `save` ë“±ì˜ ë©”ì†Œë“œë¥¼ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n`findOneWithAuthoritiesByUsername` ë©”ì†Œë“œëŠ” usernameì„ ê¸°ì¤€ìœ¼ë¡œ User ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ë•Œ ê¶Œí•œ ì •ë³´ë„ ê°™ì´ ê°€ì ¸ì˜¤ê²Œë©ë‹ˆë‹¤.\n\n# 3. ë¡œê·¸ì¸ API, ê´€ë ¨ ë¡œì§ ìƒì„±\n\n## CustomUserDetailsService í´ë˜ìŠ¤\n\nSpring Securityì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì¤‘ í•˜ë‚˜ì¸ UserDetailsServiceë¥¼ êµ¬í˜„í•œ CustomUserDetailsService í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤. \n\në¨¼ì € service íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ê³  í•´ë‹¹ íŒ¨í‚¤ì§€ì— í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\n@Component(\"userDetailsService\")\npublic class CustomUserDetailsService implements UserDetailsService {\n    private final UserRepository userRepository;\n\n    public CustomUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    @Transactional\n    public UserDetails loadUserByUsername(final String username) {\n        return userRepository.findOneWithAuthoritiesByUsername(username)\n                .map(user -> createUser(username, user))\n                .orElseThrow(() -> new UsernameNotFoundException(username + \" -> ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\"));\n    }\n\n    private org.springframework.security.core.userdetails.User createUser(String username, User user) {\n        if (!user.isActivated()) {\n            throw new RuntimeException(username + \" -> í™œì„±í™”ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.\");\n        }\n        List<GrantedAuthority> grantedAuthorities = user.getAuthorities().stream()\n                .map(authority -> new SimpleGrantedAuthority(authority.getAuthorityName()))\n                .collect(Collectors.toList());\n        return new org.springframework.security.core.userdetails.User(user.getUsername(),\n                user.getPassword(),\n                grantedAuthorities);\n    }\n}\n```\n\n`UserDetailsService`ë¥¼ `implements`í•˜ê³  `UserRepository`ë¥¼ ì£¼ì…ë°›ìŠµë‹ˆë‹¤. `loadUserByUsername` ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•´ì„œ ë¡œê·¸ì¸ì‹œì— DBì—ì„œ ìœ ì €ì •ë³´ì™€ ê¶Œí•œì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê²Œë©ë‹ˆë‹¤.\n\ní•´ë‹¹ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•´ì„œ `userdetails.user` ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë¦¬í„´í•©ë‹ˆë‹¤.\n\n## AuthController í´ë˜ìŠ¤\n\në¡œê·¸ì¸ APIë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œ AuthController í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.\n\n```java\n@RestController\n@RequestMapping(\"/api\")\npublic class AuthController {\n    private final TokenProvider tokenProvider;\n    private final AuthenticationManagerBuilder authenticationManagerBuilder;\n\n    public AuthController(TokenProvider tokenProvider, AuthenticationManagerBuilder authenticationManagerBuilder) {\n        this.tokenProvider = tokenProvider;\n        this.authenticationManagerBuilder = authenticationManagerBuilder;\n    }\n\n    @PostMapping(\"/authenticate\")\n    public ResponseEntity<TokenDto> authorize(@Valid @RequestBody LoginDto loginDto) {\n\n        UsernamePasswordAuthenticationToken authenticationToken =\n                new UsernamePasswordAuthenticationToken(loginDto.getUsername(), loginDto.getPassword());\n\n        Authentication authentication = authenticationManagerBuilder.getObject().authenticate(authenticationToken);\n        SecurityContextHolder.getContext().setAuthentication(authentication);\n\n        String jwt = tokenProvider.createToken(authentication);\n\n        HttpHeaders httpHeaders = new HttpHeaders();\n        httpHeaders.add(JwtFilter.AUTHORIZATION_HEADER, \"Bearer \" + jwt);\n\n        return new ResponseEntity<>(new TokenDto(jwt), httpHeaders, HttpStatus.OK);\n    }\n}\n```\n\nì´ì „ì— ë§Œë“¤ì—ˆë˜ `TokenProvider`, `AuthenticationManagerBuilder` ë¥¼ ì£¼ì…ë°›ìŠµë‹ˆë‹¤.\n\në¡œê·¸ì¸ API ê²½ë¡œëŠ” `/api/authenticate` ê²½ë¡œì´ê³  `POST` ìš”ì²­ì„ ë°›ìŠµë‹ˆë‹¤.\n\n### authorize ë©”ì†Œë“œ\n\n`authorize` ë©”ì†Œë“œëŠ” LoginDtoì˜ username, passwordë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ê³  ì´ë¥¼ ì´ìš©í•´ `UsernamePasswordAuthenticationToken`ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nauthenticationTokenì„ ì´ìš©í•´ì„œ Authentication ê°ì²´ë¥¼ ìƒì„±í•˜ë ¤ê³  `authenticate` ë©”ì†Œë“œê°€ ì‹¤í–‰ì´ë  ë•Œ `CustomUserDetailsService` í´ë˜ìŠ¤ì˜ `loadUserByUsername` ë©”ì†Œë“œê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.\n\nì´ ê²°ê³¼ê°’ì„ ì´ìš©í•´ì„œ Authenticaion ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì´ë¥¼ SecurityContext ì— ì €ì¥í•˜ê³  Authenticaion ê°ì²´ë¥¼ `createToken` ë©”ì†Œë“œë¥¼ í†µí•´ì„œ JWT Token ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nJWT Token ì„ Response Headerì— ë„£ì–´ì£¼ê³  TokenDtoë¥¼ ì´ìš©í•´ì„œ Response Bodyì—ë„ ë„£ì–´ì„œ ë¦¬í„´í•˜ê²Œ ë©ë‹ˆë‹¤.\n\n# 4. ë¡œê·¸ì¸ API í…ŒìŠ¤íŠ¸\n\nì ì´ì œ ë¡œê·¸ì¸ API ë¥¼ í¬ìŠ¤íŠ¸ë§¨ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n## ë¡œê·¸ì¸ ìš”ì²­\n\n [http://localhost:8080/api/authenticate](http://localhost:8080/api/authenticate) ê²½ë¡œë¡œ ì•„ë˜ì™€ ê°™ì´ `POST` ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.\n\n![Untitled](4-1.png)\n\nadmin ê³„ì • ì •ë³´ëŠ” data.sqlì˜ insertë¬¸ì´ ì„œë²„ê°€ ì‹œì‘ë ë•Œ ìë™ì‹¤í–‰ë˜ì–´ DBì— ì €ì¥ëœ ìƒíƒœì…ë‹ˆë‹¤.\n\n- 405 HTTP ìƒíƒœ ì½”ë“œê°€ ë°œìƒí•˜ë©´?\n    - Server Log\n    \n    ```json\n    2022-01-12 18:35:18.364 DEBUG 5197 --- [nio-8080-exec-1] com.example.jwttutorial.jwt.JwtFilter    : ìœ íš¨í•œ JWT í† í°ì´ ì—†ìŠµë‹ˆë‹¤, uri: /api/authenticate\n    2022-01-12 18:35:18.373  WARN 5197 --- [nio-8080-exec-1] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]\n    2022-01-12 18:35:18.374 DEBUG 5197 --- [nio-8080-exec-1] com.example.jwttutorial.jwt.JwtFilter    : ìœ íš¨í•œ JWT í† í°ì´ ì—†ìŠµë‹ˆë‹¤, uri: /error\n    ```\n    \n    - Response\n    \n    ```json\n    {\n        \"timestamp\": \"2022-01-12T09:33:18.957+00:00\",\n        \"status\": 415,\n        \"error\": \"Unsupported Media Type\",\n        \"path\": \"/api/authenticate\"\n    }\n    ```\n    \n    ìœ„ì™€ ê°™ì´ ì‘ë‹µì´ ë°˜í™˜ë˜ë©´ POST ìš”ì²­ì„ ë³´ë‚¼ë•Œ `JSON` í˜•ì‹ìœ¼ë¡œ ë³´ë‚´ì‹œë©´ë©ë‹ˆë‹¤.\n    \n\n## ì •ìƒ ì‘ë‹µ\n\nì •ìƒì ìœ¼ë¡œ ìš”ì²­ì´ ì‘ë‹µëœë‹¤ë©´ ì„œë²„ì—ì„  í•´ë‹¹ sqlë¬¸ query ë‚´ìš©ì´ ë¡œê·¸ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤\n\n```sql\nHibernate: \n    select\n        user0_.user_id as user_id1_1_0_,\n        authority2_.authority_name as authorit1_0_1_,\n        user0_.activated as activate2_1_0_,\n        user0_.nickname as nickname3_1_0_,\n        user0_.password as password4_1_0_,\n        user0_.username as username5_1_0_,\n        authoritie1_.user_id as user_id1_2_0__,\n        authoritie1_.authority_name as authorit2_2_0__ \n    from\n        user user0_ \n    left outer join\n        user_authority authoritie1_ \n            on user0_.user_id=authoritie1_.user_id \n    left outer join\n        authority authority2_ \n            on authoritie1_.authority_name=authority2_.authority_name \n    where\n        user0_.username=?\n```\n\nê·¸ë¦¬ê³  Repsonse ë‚´ìš©ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ Tokenì´ ì •ìƒì ìœ¼ë¡œ ë¦¬í„´ë©ë‹ˆë‹¤.\n\n```json\n{\n    \"token\": \"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImF1dGgiOiJST0xFX0FETUlOLFJPTEVfVVNFUiIsImV4cCI6MTY0MjA2NjU2NH0.QLtuqh874mipMl-h0cO6p4Jf430RGf2uBArr5nWcnmnvG6YqVo0qFXGxEwbPHD9u7J4Zl1GIL0YuWQTXWdUYHA\"\n}\n```\n\nì´ì œ DTO í´ë˜ìŠ¤, Repository, ë¡œê·¸ì¸ APIì˜ ê°œë°œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. \n\në””ìŒ í¸ì—ì„œëŠ” íšŒì›ê°€ì… APIë¥¼ ë§Œë“¤ê³  íšŒì›ê°€ì…í•œ ìœ ì €ì™€ admin ê´€ë¦¬ìì˜ ê¶Œí•œ ê²€ì¦ì„ êµ¬ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n- Postmanì˜ ìœ ìš©í•œ ê¸°ëŠ¥\n\n![Untitled](4-2.png)\n\nìœ„ì™€ ê°™ì´ Tests íƒ­ì—ì„œ Responseì˜ ë°ì´í„°ë¥¼ ì „ì—­ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ë‹¤ë¥¸ Requestì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n# Reference\n\n[Spring Docs - JpaRepository](https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html)","excerpt":"1. DTO í´ë˜ìŠ¤ ìƒì„± LoginDto í´ë˜ìŠ¤ ì™¸ë¶€ì™€ì˜ í†µì‹ ì— ì‚¬ìš©í•  DTO íŒ¨í‚¤ì§€ ë° í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. Lombok ì–´ë…¸í…Œì´ì…˜(Get, Set ë“±)ì´ ì¶”ê°€ë˜ì—ˆê³  @Valid ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í•  ì´ìš©ìì˜ ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸â€¦","fields":{"slug":"/springboot-jwt-tutorial4/"},"frontmatter":{"date":"Jan 13, 2022","title":"SpringBoot JWT íŠœí† ë¦¬ì–¼ - 4ì¥ DTO,Repository,ë¡œê·¸ì¸ êµ¬í˜„","tags":["SpringBoot","JWT","íŠœí† ë¦¬ì–¼"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"# 1. JWT ì„¤ì •ì¶”ê°€\n\napplication.yml íŒŒì¼ì„ ì—´ê³ , jwt ì„¤ì •ì„ ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤.\n\n```yaml\njwt:\n  header: Authorization\n  #HS512 ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— 512bit, ì¦‰ 64byte ì´ìƒì˜ secret keyë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.\n  #echo 'silvernine-tech-spring-boot-jwt-tutorial-secret-silvernine-tech-spring-boot-jwt-tutorial-secret'|base64\n  secret: c2lsdmVybmluZS10ZWNoLXNwcmluZy1ib290LWp3dC10dXRvcmlhbC1zZWNyZXQtc2lsdmVybmluZS10ZWNoLXNwcmluZy1ib290LWp3dC10dXRvcmlhbC1zZWNyZXQK\n  token-validity-in-seconds: 86400\n```\n\n- header : JWTë¥¼ ê²€ì¦í•˜ëŠ”ë° í•„ìš”í•œ ì •ë³´\n- secret : HS512 ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— 512bit, ì¦‰ 64byte ì´ìƒì˜ secret keyë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤\n    - ìœ„ ì˜ˆì œì—ì„œëŠ” Secret Key ë¥¼ Base64 ë¡œ ì¸ì½”ë”©í•œ ê°’ì„.\n- token-validity-in-seconds : í† í°ì˜ ë§Œë£Œì‹œê°„ì„ ì§€ì •í•¨ (ë‹¨ìœ„ëŠ” ì´ˆ)\n\nì´ì œ build.gradle íŒŒì¼ë¡œ ê°€ì„œ JWT ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n```yaml\nimplementation group: 'io.jsonwebtoken', name: 'jjwt-api', version: '0.11.2'\nruntimeOnly group: 'io.jsonwebtoken', name: 'jjwt-impl', version: '0.11.2'\nruntimeOnly group: 'io.jsonwebtoken', name: 'jjwt-jackson', version: '0.11.2'\n```\n\nê·¸ í›„ ê·¸ë˜ë“¤ì„ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€, í”„ë¡œì íŠ¸ì— ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤. \n\nJWT ê°œë°œì„ ìœ„í•œ ì¤€ë¹„ëŠ” ì™„ë£Œë˜ì—ˆê³  ì´ì œ JWT ì½”ë“œë¥¼ ê°œë°œí•˜ê² ìŠµë‹ˆë‹¤.\n\n# 2. JWT ê´€ë ¨ ì½”ë“œ ì‘ì„±\n\n## TokenProvider í´ë˜ìŠ¤\n\njwt íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ê³ , í† í°ì˜ ìƒì„±ê³¼ í† í°ì˜ ìœ íš¨ì„± ê²€ì¦ë“±ì„ ë‹´ë‹¹í•  Token Provider ë¥¼ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.\n\n```java\n@Component\npublic class TokenProvider implements InitializingBean {\n\n    private final Logger logger = LoggerFactory.getLogger(TokenProvider.class);\n\n    private static final String AUTHORITIES_KEY = \"auth\";\n\n    private final String secret;\n    private final long tokenValidityInMilliseconds;\n\n    private Key key;\n\n    public TokenProvider(\n            @Value(\"${jwt.secret}\") String secret,\n            @Value(\"${jwt.token-validity-in-seconds}\") long tokenValidityInSeconds) {\n        this.secret = secret;\n        this.tokenValidityInMilliseconds = tokenValidityInSeconds * 1000;\n    }\n\n    @Override\n    public void afterPropertiesSet() {\n        byte[] keyBytes = Decoders.BASE64.decode(secret);\n        this.key = Keys.hmacShaKeyFor(keyBytes);\n    }\n}\n```\n\n`InitializingBean`  ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬, `afterPropertiesSet` ë©”ì†Œë“œë¥¼ Override í•œ ì´ìœ ëŠ”\n\nBeanì´ ìƒì„±ì´ ë˜ê³ , ì˜ì¡´ì„± ì£¼ì…ì„ ë°›ì€ í›„ì— secret ê°’ì„ Base64 Decode í•´ì„œ key ë³€ìˆ˜ì— í• ë‹¹í•©ë‹ˆë‹¤.\n\n### createToken ë©”ì†Œë“œ\n\nAuthentication ê°ì²´ì˜ ê¶Œí•œì •ë³´ë¥¼ ì´ìš©í•´ì„œ í† í°ì„ ìƒì„±í•˜ëŠ” createToken ë©”ì†Œë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n```java\npublic String createToken(Authentication authentication) {\n      String authorities = authentication.getAuthorities().stream()\n         .map(GrantedAuthority::getAuthority)\n         .collect(Collectors.joining(\",\"));\n\n      long now = (new Date()).getTime();\n      Date validity = new Date(now + this.tokenValidityInMilliseconds);\n\n      return Jwts.builder()\n         .setSubject(authentication.getName())\n         .claim(AUTHORITIES_KEY, authorities)\n         .signWith(key, SignatureAlgorithm.HS512)\n         .setExpiration(validity)\n         .compact();\n   }\n```\n\nauthenticaion ê°ì²´ë¥¼ ë°›ì•„ì„œ ê¶Œí•œ ì„¤ì •ì„ í•˜ê³ , application.yml ì—ì„œ ì„¤ì •í–ˆë˜ í† í° ë§Œë£Œì‹œê°„ì„ ì„¤ì •í•˜ê³  í† í°ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\n### getAuthenticaion ë©”ì†Œë“œ\n\ntokenì„ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ, í† í°ì— ë‹´ê¸´ ì •ë³´ë¥¼ ì´ìš©í•´ Authenticaion ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\n```java\npublic Authentication getAuthentication(String token) {\n      Claims claims = Jwts\n              .parserBuilder()\n              .setSigningKey(key)\n              .build()\n              .parseClaimsJws(token)\n              .getBody();\n\n      Collection<? extends GrantedAuthority> authorities =\n         Arrays.stream(claims.get(AUTHORITIES_KEY).toString().split(\",\"))\n            .map(SimpleGrantedAuthority::new)\n            .collect(Collectors.toList());\n\n      User principal = new User(claims.getSubject(), \"\", authorities);\n\n      return new UsernamePasswordAuthenticationToken(principal, token, authorities);\n   }\n```\n\ntokenìœ¼ë¡œ í´ë ˆì„ì„ ë§Œë“¤ê³ , í´ë ˆì„ì—ì„œ ê¶Œí•œì •ë³´ë¥¼ ë°›ì•„ì„œ ìœ ì € ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ìµœì¢…ì ìœ¼ë¡œ Authenticaion ê°ì²´ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.\n\n- Claims : JWT ì˜ ì†ì„±ì •ë³´, java ì—ì„œ Claims ëŠ” Json map í˜•ì‹ì˜ ì¸í„°í˜ì´ìŠ¤ì„\n\n### validateToken ë©”ì†Œë“œ\n\ntokenì„ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ, í† í°ì˜ ìœ íš¨ì„± ê²€ì¦ì„ ìˆ˜í–‰í•˜ëŠ” validateToken ë©”ì†Œë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\n```java\npublic boolean validateToken(String token) {\n      try {\n         Jwts.parserBuilder().setSigningKey(key).build().parseClaimsJws(token);\n         return true;\n      } catch (io.jsonwebtoken.security.SecurityException | MalformedJwtException e) {\n         logger.info(\"ì˜ëª»ëœ JWT ì„œëª…ì…ë‹ˆë‹¤.\");\n      } catch (ExpiredJwtException e) {\n         logger.info(\"ë§Œë£Œëœ JWT í† í°ì…ë‹ˆë‹¤.\");\n      } catch (UnsupportedJwtException e) {\n         logger.info(\"ì§€ì›ë˜ì§€ ì•ŠëŠ” JWT í† í°ì…ë‹ˆë‹¤.\");\n      } catch (IllegalArgumentException e) {\n         logger.info(\"JWT í† í°ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n      }\n      return false;\n   }\n```\n\ní† í°ì„ íŒŒì‹±í•˜ê³ , ë°œìƒí•˜ëŠ” ì˜ˆì™¸ë“¤ì„ ìºì¹˜í•˜ì—¬, ë¬¸ì œê°€ ìˆìŒë©´ false, ì •ìƒì´ë©´ trueë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.\n\n## JwtFilter í´ë˜ìŠ¤\n\nJWTë¥¼ ìœ„í•œ ì»¤ìŠ¤í…€ í•„í„°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ JwtFilter í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\npublic class JwtFilter extends GenericFilterBean {\n\n    private static final Logger logger = LoggerFactory.getLogger(JwtFilter.class);\n\n    public static final String AUTHORIZATION_HEADER = \"Authorization\";\n\n    private TokenProvider tokenProvider;\n\n    public JwtFilter(TokenProvider tokenProvider) {\n        this.tokenProvider = tokenProvider;\n    }\n\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)\n            throws IOException, ServletException {\n        \n    }\n}\n```\n\n- doFilter : JWT í† í°ì˜ ì¸ì¦ì •ë³´ë¥¼ í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ SecurityContext ì— ì €ì¥í•˜ëŠ” ì—­í™œ\n\nGenericFilterBeanì„ ìƒì†ë°›ì•„ doFilter ë©”ì†Œë“œë¥¼ Override.\n\nì‹¤ì œ í•„í„°ë§ ë¡œì§ì€ doFilter ë‚´ë¶€ì— ì‘ì„±í•©ë‹ˆë‹¤.\n\n### resolveToken ë©”ì†Œë“œ\n\nRequest Header ì—ì„œ í† í°ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ, resolveToken ë©”ì†Œë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\n```java\nprivate String resolveToken(HttpServletRequest request) {\n      String bearerToken = request.getHeader(AUTHORIZATION_HEADER);\n      if (StringUtils.hasText(bearerToken) && bearerToken.startsWith(\"Bearer \")) {\n         return bearerToken.substring(7);\n      }\n      return null;\n   }\n```\n\n### doFilter ë©”ì†Œë“œ ë‚´ë¶€ ë¡œì§\n\n doFilterì˜ ë‚´ë¶€ ë¡œì§ì„ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```clike\nHttpServletRequest httpServletRequest = (HttpServletRequest) servletRequest;\n      String jwt = resolveToken(httpServletRequest);\n      String requestURI = httpServletRequest.getRequestURI();\n\n      if (StringUtils.hasText(jwt) && tokenProvider.validateToken(jwt)) {\n         Authentication authentication = tokenProvider.getAuthentication(jwt);\n         SecurityContextHolder.getContext().setAuthentication(authentication);\n         logger.debug(\"Security Contextì— '{}' ì¸ì¦ ì •ë³´ë¥¼ ì €ì¥í–ˆìŠµë‹ˆë‹¤, uri: {}\", authentication.getName(), requestURI);\n      } else {\n         logger.debug(\"ìœ íš¨í•œ JWT í† í°ì´ ì—†ìŠµë‹ˆë‹¤, uri: {}\", requestURI);\n      }\n\n      filterChain.doFilter(servletRequest, servletResponse);\n```\n\nresolveToken ì„ í†µí•´ í† í°ì„ ë°›ì•„ì™€ì„œ ìœ íš¨ì„± ê²€ì¦ì„ í•˜ê³  í† í°ì´ ì •ìƒì ì´ë©´ Authenticaion ê°ì²´ë¥¼ ë°›ì•„ì™€ì„œ \n\nSecurityContext ì— ì €ì¥í•©ë‹ˆë‹¤.\n\n## JwtSecurityConfig í´ë˜ìŠ¤\n\nTokenProvider, JwtFilter ë¥¼ SecurityConfigì— ì ìš©í• ë•Œ ì‚¬ìš©í•  JwtSecurityConfig í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\npublic class JwtSecurityConfig extends SecurityConfigurerAdapter<DefaultSecurityFilterChain, HttpSecurity> {\n\n    private TokenProvider tokenProvider;\n\n    public JwtSecurityConfig(TokenProvider tokenProvider) {\n        this.tokenProvider = tokenProvider;\n    }\n\n    @Override\n    public void configure(HttpSecurity http) {\n        JwtFilter customFilter = new JwtFilter(tokenProvider);\n        http.addFilterBefore(customFilter, UsernamePasswordAuthenticationFilter.class);\n    }\n}\n```\n\nSecurityConfigurerAdapterë¥¼ ìƒì†ë°›ê³  TokenProviderë¥¼ ì£¼ì…ë°›ì•„ì„œ configure ë©”ì†Œë“œë¥¼ Override í•˜ì—¬ JwtFilterë¥¼ í†µí•´ Security ë¡œì§ì— í•„í„°ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.\n\n## JwtAuthenticationEntryPoint í´ë˜ìŠ¤\n\nìœ íš¨í•œ ìê²©ì¦ëª…ì„ ì œê³µí•˜ì§€ ì•Šê³  ì ‘ê·¼í•˜ë ¤ í• ë•Œ 401 Unauthorized ì—ëŸ¬ë¥¼ ë¦¬í„´í•  JwtAuthenticationEntryPoint í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\n@Component\npublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {\n\n    @Override\n    public void commence(HttpServletRequest request,\n                         HttpServletResponse response,\n                         AuthenticationException authException) throws IOException {\n        // ìœ íš¨í•œ ìê²©ì¦ëª…ì„ ì œê³µí•˜ì§€ ì•Šê³  ì ‘ê·¼í•˜ë ¤ í• ë•Œ 401\n        response.sendError(HttpServletResponse.SC_UNAUTHORIZED);\n    }\n}\n```\n\nAuthneticaionEntryPoint ë¥¼ êµ¬í˜„í•˜ê³ , commence ë©”ì†Œë“œë¥¼ Override í•©ë‹ˆë‹¤\n\nì´ í´ë˜ìŠ¤ëŠ” ìœ íš¨í•˜ì§€ ì•ŠëŠ” ìê²©ì¦ëª…ì€ 401 ì—ëŸ¬ë¥¼ ì „ì†¡í•˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.\n\n## JwtAccessDeniedHandler í´ë˜ìŠ¤\n\ní•„ìš”í•œ ê¶Œí•œì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì— 403 Forbidden ì—ëŸ¬ë¥¼ ë¦¬í„´í•˜ê¸° ìœ„í•´ JwtAccessDeniedHandler í´ë˜ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\n@Component\npublic class JwtAccessDeniedHandler implements AccessDeniedHandler {\n\n    @Override\n    public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException {\n        //í•„ìš”í•œ ê¶Œí•œì´ ì—†ì´ ì ‘ê·¼í•˜ë ¤ í• ë•Œ 403\n        response.sendError(HttpServletResponse.SC_FORBIDDEN);\n    }\n}\n```\n\nAccessDeniedHandlerë¥¼ êµ¬í˜„í•˜í•˜ê³ , handle ë©”ì†Œë“œë¥¼ Overrideí•©ë‹ˆë‹¤.\n\ní•„ìš”í•œ ê¶Œí•œì´ ì—†ì´ ì ‘ê·¼í• ë•Œ 403 ì—ëŸ¬ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.\n\n# 3. Security ì„¤ì • ì¶”ê°€\n\n## SecurityConfig ì— ì¶”ê°€\n\nì´ì œ ë§Œë“¤ì—ˆë˜ 5ê°œì˜ í´ë˜ìŠ¤ë¥¼ SecurityConfig ì— ì ìš©í•˜ê² ìŠµë‹ˆë‹¤.\n\n```java\n@EnableWebSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true)\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n    private final TokenProvider tokenProvider;\n    private final JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint;\n    private final JwtAccessDeniedHandler jwtAccessDeniedHandler;\n\n    public SecurityConfig(\n            TokenProvider tokenProvider,\n            JwtAuthenticationEntryPoint jwtAuthenticationEntryPoint,\n            JwtAccessDeniedHandler jwtAccessDeniedHandler\n    ) {\n        this.tokenProvider = tokenProvider;\n        this.jwtAuthenticationEntryPoint = jwtAuthenticationEntryPoint;\n        this.jwtAccessDeniedHandler = jwtAccessDeniedHandler;\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Override\n    public void configure(WebSecurity web) {\n        web.ignoring()\n                .antMatchers(\n                        \"/h2-console/**\"\n                        ,\"/favicon.ico\"\n                );\n    }\n\n    @Override\n    protected void configure(HttpSecurity httpSecurity) throws Exception {\n        httpSecurity\n                // tokenì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ê¸° ë•Œë¬¸ì— csrfë¥¼ disableí•©ë‹ˆë‹¤.\n                .csrf().disable()\n\n                .exceptionHandling()\n                .authenticationEntryPoint(jwtAuthenticationEntryPoint)\n                .accessDeniedHandler(jwtAccessDeniedHandler)\n\n                // enable h2-console\n                .and()\n                .headers()\n                .frameOptions()\n                .sameOrigin()\n\n                // ì„¸ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— STATELESSë¡œ ì„¤ì •\n                .and()\n                .sessionManagement()\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n\n                .and()\n                .authorizeRequests()\n                .antMatchers(\"/api/hello\").permitAll()\n                .antMatchers(\"/api/authenticate\").permitAll()\n                .antMatchers(\"/api/signup\").permitAll()\n\n                .anyRequest().authenticated()\n\n                .and()\n                .apply(new JwtSecurityConfig(tokenProvider));\n    }\n}\n```\n\n- `@EnableGlobalMethodSecurity` : @PreAuthorize ì–´ë…¸í…Œì´ì…˜ì„ ë©”ì†Œë“œ ë‹¨ìœ„ë¡œ ì¶”ê°€í•œë‹¤\n\nSecurityConfigëŠ” TokenProvider, JwtAuthenticaionEntryPoint, JwtAccessDeniedHandler ë¥¼ ì£¼ì…ë°›ìŠµë‹ˆë‹¤. \n\npasswordEncoderë¡œ BCryptPasswordEncoderë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\nconfigure ë©”ì†Œë“œì—ì„œ ë§ì€ ë¶€ë¶„ì´ ì¶”ê°€ë¬ëŠ”ë°(HttpSecurity ë§¤ê°œì¸ì) \n\nì¼ë‹¨ í† í°ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— csrf ëŠ” disable í•©ë‹ˆë‹¤ Exceptionì„ í•¸ë“¤ë§í• ë•Œ ìš°ë¦¬ê°€ ì‘ì„±í•œ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.\n\nê·¸ë¦¬ê³  h2-console ì„ ìœ„í•œ ì„¤ì •ë“¤ì„ ì¶”ê°€í•´ì¤¬ê³ , ìš°ë¦¬ëŠ” ì„¸ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì„¸ì…˜ ì„¤ì •ì„ STATELESSë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\n\në¡œê·¸ì¸ API, íšŒì›ê°€ì… API ëŠ” í† í°ì´ ì—†ëŠ” ìƒíƒœì—ì„œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê¸° ë•Œë¬¸ì— ëª¨ë‘ permitAll ì„¤ì •ì„ í•´ì¤¬ìŠµë‹ˆë‹¤.\n\në§ˆì§€ë§‰ìœ¼ë¡œ JwtFilterë¥¼ addFilterBeforeë¡œ ë“±ë¡í–ˆë˜ JwtSecurityConfig í´ë˜ìŠ¤ë„ ì ìš©í•´ì¤ë‹ˆë‹¤.\n\n### ì„œë²„ ì‹¤í–‰\n\nì„œë²„ë¥¼ ìµœì¢…ì ìœ¼ë¡œ ì‹¤í–‰í•˜ë©´ ì•„ë¬´ ì˜¤ë¥˜ì—†ì´ ì˜ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n```java\n2022-01-10 20:36:56.570  INFO 44384 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''\n2022-01-10 20:36:56.575  INFO 44384 --- [           main] c.e.jwttutorial.JwtTutorialApplication   : Started JwtTutorialApplication in 2.078 seconds (JVM running for 2.671)\n```\n\nì´ì œ JWT ì„¤ì • ì¶”ê°€, JWT ê´€ë ¨ ì½”ë“œ ê°œë°œ, Security ì„¤ì • ì¶”ê°€í•˜ëŠ” ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\n\në‹¤ìŒí¸ì—ì„œëŠ” DBì™€ ì—°ê²°í•˜ëŠ” Repositoryë¥¼ ë§Œë“¤ê³  ë¡œê·¸ì¸ API ë¥¼ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤.","excerpt":"1. JWT ì„¤ì •ì¶”ê°€ application.yml íŒŒì¼ì„ ì—´ê³ , jwt ì„¤ì •ì„ ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤. header : JWTë¥¼ ê²€ì¦í•˜ëŠ”ë° í•„ìš”í•œ ì •ë³´ secret : HS512 ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— 512bit, ì¦‰ 64byte ì´ìƒì˜ secreâ€¦","fields":{"slug":"/springboot-jwt-tutorial3/"},"frontmatter":{"date":"Jan 12, 2022","title":"SpringBoot JWT íŠœí† ë¦¬ì–¼ - 3ì¥ JWTì½”ë“œ, Security ì„¤ì • ì¶”ê°€","tags":["SpringBoot","JWT","íŠœí† ë¦¬ì–¼"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"# 1. JWT (Json Web Token)ë€?\n\n---\n\n- JSON ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ í† í° ìì²´ì— ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” Web Token\n- Header, Payload, Signature 3ê°œ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë¨.\n- ì¿ í‚¤ë‚˜ ì„¸ì…˜ì„ ì´ìš©í•œ ì¸ì¦ë³´ë‹¤ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì„\n- ì¼ë°˜ì ìœ¼ë¡œëŠ” `Authorization : <type> <credentials>` í˜•íƒœë¡œ Request Header ì— ë‹´ê²¨ì ¸ ì˜¤ê¸° ë–„ë¬¸ì— Header ê°’ì„ í™•ì¸í•´ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ.\n\n## 1.1 ì¥ë‹¨ì \n\n---\n\n- ì¥ì \n    - ì¤‘ì•™ ì¸ì¦ ì„œë²„, ì €ì¥ì†Œì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ì—†ì–´ì„œ ìˆ˜í‰í™•ì¥ì— ìœ ë¦¬\n    - Base64 URL Safe Encoding ì´ë¼ URL, Cookie, Header ì–´ë–¤ í˜•íƒœë¡œ ì‚¬ìš©ê°€ëŠ¥\n    - Stateless í•œ ì„œë²„ êµ¬í˜„ ê°€ëŠ¥\n    - ì›¹ì´ ì•„ë‹Œ ëª¨ë°”ì¼ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥\n    - ì¸ì¦ ì •ë³´ë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥ (OAuth)\n- ë‹¨ì \n    - Payload ì˜ ì •ë³´ê°€ ë§ì•„ì§€ë©´ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ ì¦ê°€\n    - ë‹¤ë¥¸ ì‚¬ëŒì´ í† í°ì„ decode í•˜ì—¬ ë°ì´í„° í™•ì¸ ê°€ëŠ¥\n    - í† í°ì„ íƒˆì·¨ë‹¹í•œ ê²½ìš° ëŒ€ì²˜í•˜ê¸° ì–´ë ¤ì›€\n        - ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ëŠ”ê²Œ ì•„ë‹ˆë‹¤ë³´ë‹ˆ íƒˆì·¨ë‹¹í•œ ê²½ìš° ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ê°€ ë¶ˆê°€ëŠ¥\n        - í† í° ìœ íš¨ì‹œê°„ì´ ë§Œë£Œë˜ê¸° ì „ê¹Œì§€ëŠ” íƒˆì·¨ìëŠ” ììœ ë¡­ê²Œ ì¸ì¦ ê°€ëŠ¥\n        - ê·¸ë˜ì„œ ìœ íš¨ì‹œê°„ì„ ì§§ê²Œ ê°€ì ¸ê°€ê³  refresh Token ì„ ë°œê¸‰í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë§ì´ ì‚¬ìš©\n\n## 1.2 Token êµ¬ì„±ìš”ì†Œ\n\n---\n\n- Header\n    - `alg` : Signature ë¥¼ í•´ì‹±í•˜ê¸° ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ ì •ë³´ë¥¼ ê°–ê³  ìˆìŒ\n    - `typ` : í† í°ì˜ íƒ€ì…ì„ ë‚˜íƒ€ë‚´ëŠ”ë° ì—†ì–´ë„ ë¨(ë³´í†µ JWT ë¥¼ ì‚¬ìš©)\n- Payload\n    - ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ê³ ë°›ëŠ”, ì‹œìŠ¤í…œì—ì„œ ì‹¤ì œë¡œ ì‚¬ìš©ë  ì •ë³´ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆìŒ\n    - JWTê°€ [ê¸°ë³¸ì ìœ¼ë¡œ ê°–ê³  ìˆëŠ” í‚¤ì›Œë“œ](https://datatracker.ietf.org/doc/html/rfc7519#section-4.1)ê°€ ì¡´ì¬\n    - ì›í•œë‹¤ë©´ ì¶”ê°€ ê°€ëŠ¥\n        - `iss` : í† í° ë°œê¸‰ì\n        - `sub` : í† í° ì œëª©\n        - `aud` : í† í° ëŒ€ìƒ\n        - `exp` : í† í°ì˜ ë§Œë£Œì‹œê°„\n        - `nbf` : Not Before\n        - `iat` : í† í°ì´ ë°œê¸‰ëœ ì‹œê°„\n        - `jti` : JWTì˜ ê³ ìœ  ì‹ë³„ì\n- Signature\n    - ì„œë²„ì—ì„œ í† í°ì´ ìœ íš¨í•œì§€ ê²€ì¦í•˜ê¸° ìœ„í•œ ë¬¸ìì—´\n    - Header + Payload + Secret Key ë¡œ ê°’ì„ ìƒì„±í•˜ë¯€ë¡œ ë°ì´í„° ë³€ì¡° ì—¬ë¶€ë¥¼ íŒë‹¨ ê°€ëŠ¥\n    - Secret Key ëŠ” ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ì„œë²„ì—ì„œ ê´€ë¦¬ í•„ìš”\n\n## 1.3 í† í° ì¸ì¦ íƒ€ì…\n\n---\n\n`Authorization: <type> <credentials>` í˜•íƒœì—ì„œ `<type>` ë¶€ë¶„ì— ë“¤ì–´ê°’ ê°’.\n\nì—„ê²©í•œ ê·œì¹™ì´ ìˆëŠ”ê±´ ì•„ë‹ˆê³ , ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ëŠ” í˜•íƒœ\n\n- Basic\n    - ì‚¬ìš©ì ì•„ì´ë””ì™€ ì•”í˜¸ë¥¼ Base64ë¡œ ì¸ì½”ë”©í•œ ê°’ì„ í† í°ìœ¼ë¡œ ì‚¬ìš©\n- Bearer\n    - JWT ë˜ëŠ” OAuth ì— ëŒ€í•œ í† í°ì„ ì‚¬ìš©\n- Digest\n    - ì„œë²„ì—ì„œ ë‚œìˆ˜ ë°ì´í„° ë¬¸ìì—´ì„ í´ë¼ì´ì–¸íŠ¸ì— ë³´ëƒ„\n    - í´ë¼ì´ì–¸íŠ¸ëŠ” ì‚¬ìš©ì ì •ë³´ì™€ nonce ë¥¼ í¬í•¨í•˜ëŠ” í•´ì‹œê°’ì„ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µ\n- HOBA\n    - ì „ì ì„œëª… ê¸°ë°˜ ì¸ì¦\n- Mutual\n    - ì•”í˜¸ë¥¼ ì´ìš©í•œ í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ìƒí˜¸ ì¸ì¦\n- AWS4-HMAC-SHA256\n    - AWS ì „ì ì„œëª… ê¸°ë°˜ ì¸ì¦\n\n# 2. Refresh Token\n\n---\n\n**JWT ì—­ì‹œ íƒˆì·¨ë˜ë©´ ëˆ„êµ¬ë‚˜ API ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ëŠ” [ë‹¨ì ì´](https://www.notion.so/JWT-6b901ef070744b6bb65fff7f5343fd35) ì¡´ì¬.**\n\nì„¸ì…˜ì€ íƒˆì·¨ëœ ê²½ìš° ì„¸ì…˜ ì €ì¥ì†Œì—ì„œ íƒˆì·¨ëœ ì„¸ì…˜ IDë¥¼ ì‚­ì œí•˜ë©´ë˜ì§€ë§Œ, JWT ëŠ” ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì†ìˆ˜ë¬´ì±…ìœ¼ë¡œ ë‹¹í•  ìˆ˜ ë°–ì— ì—†ìŒ.\n\nê·¸ë˜ì„œ íƒˆì·¨ë˜ì–´ë„ í”¼í•´ê°€ ìµœì†Œí•œ ë˜ë„ë¡ ìœ íš¨ì‹œê°„ì„ ì§§ê²Œ ê°€ì ¸ê°.\n\ní•˜ì§€ë§Œ ë§Œë£Œ ì‹œê°„ì„ 30ë¶„ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì¼ë°˜ ì‚¬ìš©ìëŠ” 30ë¶„ë§ˆë‹¤ ìƒˆë¡œ ë¡œê·¸ì¸í•˜ì—¬ í† í°ì„ ë°œê¸‰ë°›ì•„ì•¼ í•¨.\n\n**ì‚¬ìš©ìê°€ ë§¤ë²ˆ ë¡œê·¸ì¸ í•˜ëŠ” ê³¼ì •ì„ ìƒëµí•˜ê¸° ìœ„í•´ í•„ìš”í•œê²Œ Refresh Token.**\n\n### ë°œê¸‰ ê³¼ì •\n\n1. Refresh Token ì€ ë¡œê·¸ì¸ í† í°(Access Token) ë³´ë‹¤ ê¸´ ìœ íš¨ ì‹œê°„ì„ ê°€ì§€ë©°, Access Token ì´ ë§Œë£Œëœ ì‚¬ìš©ìê°€ ì¬ë°œê¸‰ì„ ì›í•  ê²½ìš° Refresh Toeknì„ í•¨ê»˜ ì „ë‹¬í•¨.\n2. ì„œë²„ëŠ” Access Token ì— ë‹´ê¸´ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  Refresh Token ì´ ì•„ì§ ë§Œë£Œë˜ì§€ ì•Šì•˜ë‹¤ë©´, ìƒˆë¡œìš´ í† í°ì„ ë°œê¸‰í•´ì¤Œ\n\nìœ„ì™€ ê°™ì´ í•˜ë©´ ë§¤ë²ˆ ë¡œê·¸ì¸í•´ì•¼í•˜ëŠ” ë²ˆê±°ë¡œì›€ ì—†ì´ ë¡œê·¸ì¸ì„ ì§€ì†ì ìœ¼ë¡œ ìœ ì§€ í•  ìˆ˜ ìˆìŒ.\n\n### ì£¼ì˜\n\nRefresh Token ì€ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•  ë•Œ ê°™ì´ ë°œê¸‰ë˜ë©°, í´ë¼ì´ì–¸íŠ¸ê°€ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ê³  ìˆì–´ì•¼ í•¨.\n\nAccess Tokenê³¼ ë‹¬ë¦¬ ë§¤ ìš”ì²­ë§ˆë‹¤ ì£¼ê³  ë°›ì§€ ì•Šê¸° ë•Œë¬¸ì— íƒˆì·¨ ë‹¹í•  ìœ„í—˜ì´ ì ìœ¼ë©°, ìš”ì²­ ì£¼ê¸°ê°€ ê¸¸ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ì €ì¥ì†Œì— ë³´ê´€í•¨. (ì •ì±…ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì‚¬ìš©)\n\n## 2.1 Refresh Token ì €ì¥ì†Œ\n\n---\n\nRefresh Token ì€ ì„œë²„ì—ì„œ ë³„ë„ì˜ ì €ì¥ì†Œì— ë³´ê´€í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.\n\n- Refresh Token ì€ ì‚¬ìš©ì ì •ë³´ê°€ ì—†ê¸° ë•Œë¬¸ì— ì €ì¥ì†Œì— ê°’ì´ ìˆìœ¼ë©´ ê²€ì¦ ì‹œ ì–´ë–¤ ì‚¬ìš©ìì˜ í† í°ì¸ì§€ íŒë‹¨í•˜ê¸° ìš©ì´\n- íƒˆì·¨ë‹¹í–ˆì„ ë•Œ ì €ì¥ì†Œì—ì„œ Refresh Token ì •ë³´ë¥¼ ì‚­ì œí•˜ë©´ Access Token ë§Œë£Œ í›„ì— ì¬ë°œê¸‰ì´ ì•ˆë˜ê²Œ ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ê°€ëŠ¥\n- ì¼ë°˜ì ìœ¼ë¡œ Redis ë§ì´ ì‚¬ìš©\n\n## 2.2 Refresh Token ìœ¼ë¡œ Access Token ì¬ë°œê¸‰ ì‹œë‚˜ë¦¬ì˜¤\n\n---\n\n1. í´ë¼ì´ì–¸íŠ¸ëŠ” `access token` ìœ¼ë¡œ API ìš”ì²­í•˜ë©° ì„œë¹„ìŠ¤ ì œê³µ\n2. `access token` ì´ ë§Œë£Œë˜ë©´ ì„œë²„ì—ì„œ `access token` ë§Œë£Œ ì‘ë‹µì„ ë‚´ë ¤ì¤Œ\n3. í´ë¼ì´ì–¸íŠ¸ëŠ” access token ë§Œë£Œì‘ë‹µì„ ë°›ê³  ì¬ë°œê¸‰ì„ ìœ„í•´ `access token + refresh token` ì„ í•¨ê»˜ ë³´ëƒ„\n4. ì„œë²„ëŠ” `refresh token` ì˜ ë§Œë£Œ ì—¬ë¶€ë¥¼ í™•ì¸\n5. `acces token` ìœ¼ë¡œ ìœ ì € ì •ë³´(username ë˜ëŠ” userid) ë¥¼ íšë“í•˜ê³  ì €ì¥ì†Œì— í•´ë‹¹ ìœ ì € ì •ë³´ë¥¼ key ê°’ìœ¼ë¡œ í•œ value ê°€ `refresh token` ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸\n6.  4 - 5 ë²ˆì˜ ê²€ì¦ì´ ëë‚˜ë©´ ìƒˆë¡œìš´ í† í° ì„¸íŠ¸ (access + refresh ) ë°œê¸‰\n7. ì„œë²„ëŠ” `refresh token` ì €ì¥ì†Œì˜ value ì—…ë°ì´íŠ¸\n\n## ì°¸ê³ \n\n- [JWT Token í™•ì¸ ê°€ëŠ¥í•œ ì‚¬ì´íŠ¸](https://jwt.io)\n- [ì°¸ê³ í•œ ë¸”ë¡œê·¸](https://bcp0109.tistory.com/321)","excerpt":"1. JWT (Json Web Token)ë€? JSON ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ í† í° ìì²´ì— ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” Web Token Header, Payload, Signature 3ê°œ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë¨. ì¿ í‚¤ë‚˜ ì„¸ì…˜ì„ ì´ìš©í•œ ì¸ì¦ë³´ë‹¤ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì„ ì¼ë°˜ì ìœ¼ë¡œëŠ”â€¦","fields":{"slug":"/json-web-token/"},"frontmatter":{"date":"Jan 10, 2022","title":"Json Web Token(JWT) ë€?","tags":["ë³´ì•ˆ","Token"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"## 1. 401 Unauthorized í•´ê²°ì„ ìœ„í•œ Security ì„¤ì •\n\n### SecurityConfig ìƒì„±\n\n![Untitled](2-1.png)\n\nconfig íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œë’¤, SecurityConfig í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\n- SecurityConfigurer ì„¤ì •ì„ ìœ„í•œ ë‘ê°€ì§€ ë°©ë²•\n    1. `WebSecurityConfigurer` ë¥¼ `implements` í•˜ê¸°\n    2. `WebSecurityConfigurerAdapter` ë¥¼ `extends` í•˜ê¸°\n    \n    ìœ„ ì½”ë“œì—ì„œëŠ” 2ë²ˆì§¸ ë°©ë²•ìœ¼ë¡œ ì–´ëŒ‘í„° í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì„œ êµ¬í˜„í•œë‹¤.\n    \n- `configure(HttpSecurity http)` ë©”ì†Œë“œ ì˜¤ë°”ë¼ì´ë”©\n    \n    ìƒì†ë°›ì€ í´ë˜ìŠ¤ ë‚´ë¶€ë¥¼ ë³´ë©´, configure í•¨ìˆ˜ê°€ ì˜¤ë²„ë¡œë”©ë˜ì–´ìˆëŠ”ë°, ì´ ì½”ë“œì—ì„œëŠ” HTTPSecurity ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§€ëŠ” í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ì‘ì„±í•œë‹¤.\n    \n- `authorizeRequests()`\n    - HttpServletRequest ë¥¼ ì‚¬ìš©í•œ ìš”ì²­ë“¤ì— ëŒ€í•œ ì ‘ê·¼ì œí•œ\n    - HttpServletRequest?\n        \n        JSP ê¸°ë³¸ ë‚´ì¥ ê°ì²´ ì¤‘Â **request ê°ì²´ëŠ” JSPì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ê°ì²´**ì…ë‹ˆë‹¤.\n        \n        ì›¹ë¸Œë¼ìš°ì € ì‚¬ìš©ìì¸ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì„œë²„ë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì„œë²„ì—ì„œëŠ”Â **HttpServletRequest**Â Â ë¥¼ ìƒì„±í•˜ë©°, ìš”ì²­ì •ë³´ì— ìˆëŠ” íŒ¨ìŠ¤ë¡œ ë§¤í•‘ëœ ì„œë¸”ë¦¿ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.\n        \n        ì´ë ‡ê²Œ ì „ë‹¬ë°›ì€ ë‚´ìš©ë“¤ì„ íŒŒë¼ë¯¸í„°ë¡œ Getê³¼ Post í˜•ì‹ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.\n        \n- `antMatchers(path).permitAll()`\n    - í•´ë‹¹ path ëŠ” ì¸ì¦ì—†ì´(permitAll) ì ‘ê·¼í—ˆìš©í•œë‹¤.\n- `anyRequest().authenticated()`\n    - ê·¸ì™¸ ë‚˜ë¨¸ì§€ ìš”ì²­ë“¤ì€ ì¸ì¦ë˜ì–´ì•¼í•œë‹¤.\n\n### Postmanìœ¼ë¡œ í…ŒìŠ¤íŠ¸\n- GET - localhost:8080/api/hello\n\n![Untitled](2-2.png)\n\nìœ„ì™€ ê°™ì´ ë¬¸ìì—´ â€œhelloâ€ ê°€ ë°˜í™˜ì´ ëœê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n## 2. Datasource, JPA ì„¤ì •\n\n### properties â†’ yml ë¡œ ë³€ê²½\n\nê¸°ë³¸ì ìœ¼ë¡œ ìŠ¤í”„ë§ë¶€íŠ¸ëŠ” key - value í˜•ì‹ì„ ì‚¬ìš©í•˜ëŠ” [application.properties](http://application.properties) íŒŒì¼ì´ ìˆìŠµë‹ˆë‹¤.\n\ní‚¤ì— ë™ì¼í•œ ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•˜ì—¬, ê³„ì¸µì  ë°ì´í„°ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.\n\ní•´ë‹¹ íŒŒì¼ì˜ ê° ë¼ì¸ì€ ë‹¨ì¼ êµ¬ì„±ì´ê³ , ëª¨ë“  í‚¤ëŠ” spring.datasourceì— ì†í•©ë‹ˆë‹¤.\n\n```\nspring.datasource.url=jdbc:h2:dev\nspring.datasource.username=SA\nspring.datasource.password=password\n```\n\nYAML í˜•ì‹ì€ ê³„ì¸µì  êµ¬ì„± ë°ì´í„°ë¥¼ ì§€ì •í•˜ê¸° í¸ë¦¬í•œ í˜•ì‹ì…ë‹ˆë‹¤.\n\n```yaml\nspring:\n    datasource:\n        password: password\n        url: jdbc:h2:dev\n        username: SA\n```\n\në”°ë¼ì„œ ìœ„ ë‘ê°€ì§€ ì°¨ì´ë¥¼ ë³´ë©´, YAML í˜•ì‹ì€ ê°€ë…ì„±ì´ ì¢‹ê³ , í•˜ë‚˜ì˜ íŒŒì¼ë¡œ, í”„ë¡œí•„ì„ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ìˆë‹¤.\n\në³´ê¸° ì¢‹ì€ ê²ƒì„ ì„ í˜¸í•˜ë©´ YAML í˜•ì‹ì„ ì‚¬ìš©í•˜ê±°ë‚˜, ì´ì „ í˜•ì‹ëŒ€ë¡œ ì‚¬ìš©í•´ë„ ìƒê´€ì—†ìŠµë‹ˆë‹¤.\n\nì¸í…”ë¦¬ì œì´ì˜ Refactorë¥¼ ì´ìš©í•´ application.properties ì˜ í™•ì¥ìë¥¼ ymlë¡œ ë³€ê²½í•©ë‹ˆë‹¤.\n\n![Untitled](2-3.png)\n\nH2 ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•  ê²ƒ ì´ê³ , ë©”ëª¨ë¦¬ì— ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.\n\n- h2.console.enabled\n    - h2 ì½˜ì†” í˜ì´ì§€ í™œì„±í™”\n- jpa.hibernate.ddl-auto\n    - Hibernate ì´ˆê¸°í™” ì „ëµ, create-drop ì€ ì¸-ë©”ëª¨ë¦¬ DB ê¸°ë³¸ ì „ëµì…ë‹ˆë‹¤.\n    - SessionFactoryê°€ ì‹œì‘ë  ë•Œ, Drop, Create, Alter ì¢…ë£Œë ë•Œ Drop\n- jpa.properties.hibernate\n    - ì½˜ì†”ì°½ì—ì„œ sql ë¬¸ì„ ë³´ê¸°ì¢‹ê²Œ ì¶œë ¥\n- logging.level\n    - log4j ì˜ ë¡œê·¸ë ˆë²¨ì€ ALL < DEBUG < INFO < WARN < ERROR < FATAL < OFF ìˆœìœ¼ë¡œ ì§€ì •.\n\n## 3. Entity ìƒì„±\n\nentity íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ê³ , User, Authority ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.\n\n```java\n@Entity\n@Table(name = \"user\")\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n\n    @Id\n    @Column(name = \"user_id\")\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long userId;\n\n    @Column(name = \"username\", length = 50, unique = true)\n    private String username;\n\n    @Column(name = \"password\", length = 100)\n    private String password;\n\n    @Column(name = \"nickname\", length = 50)\n    private String nickname;\n\n    @Column(name = \"activated\")\n    private boolean activated;\n\n    @ManyToMany\n    @JoinTable(\n            name = \"user_authority\",\n            joinColumns = {@JoinColumn(name = \"user_id\", referencedColumnName = \"user_id\")},\n            inverseJoinColumns = {@JoinColumn(name = \"authority_name\", referencedColumnName = \"authority_name\")})\n    private Set<Authority> authorities;\n}\n```\n\n```java\npackage com.example.jwttutorial.entity;\n\nimport lombok.*;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name = \"authority\")\n@Getter\n@Setter\n@Builder\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Authority {\n\n    @Id\n    @Column(name = \"authority_name\", length = 50)\n    private String authorityName;\n}\n```\n\n![Untitled](2-4.png)\n\nUser í´ë˜ìŠ¤ë¥¼ ë³´ë©´ @ManyToMany, @JoinTable ì€ ìœ ì €ì™€ ê¶Œí•œ ê°ì²´ì˜ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ìœ„ í…Œì´ë¸” ì²˜ëŸ¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ì˜ ì¡°ì¸ í…Œì´ë¸”ë¡œ ì •ì˜í–ˆìŠµë‹ˆë‹¤. \n\nì´ ë¶€ë¶„ì€ ì¶”í›„ ê°•ì˜ìì˜ JPA ê°•ì˜ì—ì„œ ìì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤. \n\n### data.sql ìƒì„±\n\ní¸ì˜ë¥¼ ìœ„í•´, ì„œë²„ë¥¼ ì‹œì‘í• ë•Œë§ˆë‹¤ Dataë¥¼ ìë™ìœ¼ë¡œ DBì— ë„£ì–´ì£¼ëŠ” ê¸°ëŠ¥ì„ í™œìš©í•˜ê² ìŠµë‹ˆë‹¤.\n\n resource í´ë” ë°‘ì— data.sql íŒŒì¼ì„ ë§Œë“¤ê² ìŠµë‹ˆë‹¤.\n\n```sql\nINSERT INTO USER (USER_ID, USERNAME, PASSWORD, NICKNAME, ACTIVATED) VALUES (1, 'admin', '$2a$08$lDnHPz7eUkSi6ao14Twuau08mzhWrL4kyZGGU5xfiGALO/Vxd5DOi', 'admin', 1);\nINSERT INTO USER (USER_ID, USERNAME, PASSWORD, NICKNAME, ACTIVATED) VALUES (2, 'user', '$2a$08$UkVvwpULis18S19S5pZFn.YHPZt3oaqHZnDwqbCW9pft6uFtkXKDC', 'user', 1);\n\nINSERT INTO AUTHORITY (AUTHORITY_NAME) values ('ROLE_USER');\nINSERT INTO AUTHORITY (AUTHORITY_NAME) values ('ROLE_ADMIN');\n\nINSERT INTO USER_AUTHORITY (USER_ID, AUTHORITY_NAME) values (1, 'ROLE_USER');\nINSERT INTO USER_AUTHORITY (USER_ID, AUTHORITY_NAME) values (1, 'ROLE_ADMIN');\nINSERT INTO USER_AUTHORITY (USER_ID, AUTHORITY_NAME) values (2, 'ROLE_USER');  \n```\n\n## 4. H2 Console ê²°ê³¼ í™•ì¸\n\nìš°ë¦¬ê°€ ë§Œë“¤ì—ˆë˜ ì—”í‹°í‹°ë“¤ì´ DBì— ìƒì„±ì´ ë˜ëŠ”ì§€ í™•ì¸ì„ í•´ë´…ë‹ˆë‹¤. \n\nê·¸ ì „ì— Security ì„¤ì •ì„ ì¶”ê°€í•´ì¤˜ì•¼ì§€ h2-console ì ‘ê·¼ì„ ì›í• í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![Untitled](2-5.png)\n\nh2-console í•˜ìœ„ ëª¨ë“  ìš”ì²­ë“¤ê³¼ íŒŒë¹„ì½˜ ê´€ë ¨ ìš”ì²­ì€ Spring Security ë¡œì§ì„ ìˆ˜í–‰í•˜ì§€ ì•Šê³  ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ \n\nconfigure(WebSecurity) ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•©ë‹ˆë‹¤.\n\nê·¸ í›„ ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.\n\n- DB ì´ˆê¸°í™” ì¤‘ ì—ëŸ¬ ë°œìƒ\n    \n    ```java\n    2022-01-07 16:36:18.468  WARN 2873 --- [           main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSourceScriptDatabaseInitializer' defined in class path resource [org/springframework/boot/autoconfigure/sql/init/DataSourceInitializationConfiguration.class]: Invocation of init method failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of URL [file:/Users/seonghun/Desktop/dev/projects/jwt-tutorial/build/resources/main/data.sql]: INSERT INTO USER (USER_ID, USERNAME, PASSWORD, NICKNAME, ACTIVATED) VALUES (1, 'admin', '$2a$08$lDnHPz7eUkSi6ao14Twuau08mzhWrL4kyZGGU5xfiGALO/Vxd5DOi', 'admin', 1); \n    nested exception is org.h2.jdbc.JdbcSQLSyntaxErrorException: Table \"USER\" not found; SQL statement:\n    \n    INSERT INTO USER (USER_ID, USERNAME, PASSWORD, NICKNAME, ACTIVATED) VALUES (1, 'admin', '$2a$08$lDnHPz7eUkSi6ao14Twuau08mzhWrL4kyZGGU5xfiGALO/Vxd5DOi', 'admin', 1) [42102-200]\n    ```\n    <br/>\n    hibernate ì´ˆê¸°í™” ê³¼ì •ì— ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n    \n    Spring Boot Application êµ¬ë™í•˜ëŠ” ê³¼ì • ì¤‘ì— `data.sql`ì„ ì‹¤í–‰í•˜ëŠ” ë„ì¤‘, User í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ Insert êµ¬ë¬¸ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì¸ë°. \n    \n    ê°•ì˜ì—ì„œ ìŠ¤í”„ë§ë¶€íŠ¸ì˜ ë²„ì „ì€ 2.4ì´ê³  í˜„ì¬ 2.6 ì¸ë° ë²„ì „ì´ ì—…ë°ì´íŠ¸ ë˜ë©´ì„œ ì´ëŸ¬í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ë“¯ í•©ë‹ˆë‹¤.(ëŒ€ë¶€ë¶„ì˜ ì˜¤ë¥˜ëŠ” ë²„ì „ì—…ë°ì´íŠ¸ ê´€ë ¨ì„ ë§ì´ê²ªìŒ)\n    <br/>\n    - Hibernate and data.sql ê³µì‹ ë…¸íŠ¸ ë‚´ìš© ([ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ë§í¬)](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.5-Release-Notes)\n    \n    > By default, data.sql scripts are now run before Hibernate is initialized. This aligns the behavior of basic script-based initialization with that of Flyway and Liquibase. If you want to use data.sql to populate a schema created by Hibernate, set spring.jpa.defer-datasource-initialization to true. While mixing database initialization technologies is not recommended, this will also allow you to use a schema.sql script to build upon a Hibernate-created schema before itâ€™s populated via data.sql.\n    > \n    \n    Spring Boot 2.5ë²„ì „ ë¶€í„° ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ ì´ˆê¸°í™”ì˜ ë™ì‘ê³¼ì •ì„ Flyway, Liquibaseì™€ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ì„œÂ `data.sql`Â ì€ Hibernate ì´ˆê¸°í™”ë˜ê¸° ì „ì— ì‹¤í–‰ëœë‹¤ëŠ” ë‚´ìš©ì¸ê²ƒ ê°™ìŠµë‹ˆë‹¤.\n    \n    ë”°ë¼ì„œ Hibernate ì´ˆê¸°í™”ë¥¼ í†µí•´ ìƒì„±ëœ ìŠ¤í‚¤ë§ˆì—ë‹¤ê°€ ë°ì´í„°ë¥¼ ì±„ìš°ê¸°ë¥¼ ìœ„í•´ì„œÂ `data.sql`ê°€ ì‹¤í–‰ë˜ê¸°ë¥¼ ì›í•œë‹¤ë©´Â **application.yml**(ë˜ëŠ” properties)ì—Â **`spring.jpa.defer-datasource-initialization`**Â ì˜µì…˜ ê°’ì„ **true**ë¡œ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. \n    \n    ë˜ëŠ”Â `schema.sql`ì„ ì¶”ê°€í•´ì„œ hibernate ê°€ ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë˜ë„ë¡í•˜ì—¬ í•´ë‹¹ ìŠ¤í‚¤ë§ˆì— data.sqlì„ ì±„ìš°ë„ë¡í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤ê³  í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ DB ì´ˆê¸°í™” ê¸°ìˆ ì„ í˜¼í•©í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ë°©ë²•ì´ë¼ê³  í•©ë‹ˆë‹¤.\n    \n    ë”°ë¼ì„œ application.yml ì— `defer-datasource-initialization: true` ì˜µì…˜ì„ ê¶Œì¥í•˜ì§€ ì•Šì§€ë§Œ ì¶”ê°€í•©ë‹ˆë‹¤.\n    \n\n```sql\n2022-01-07 16:43:40.706  INFO 2951 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect\nHibernate: \n    \n    drop table if exists authority CASCADE \nHibernate: \n    \n    drop table if exists user CASCADE \nHibernate: \n    \n    drop table if exists user_authority CASCADE \nHibernate: \n    \n    create table authority (\n       authority_name varchar(50) not null,\n        primary key (authority_name)\n    )\nHibernate: \n    \n    create table user (\n       user_id bigint generated by default as identity,\n        activated boolean,\n        nickname varchar(50),\n        password varchar(100),\n        username varchar(50),\n        primary key (user_id)\n    )\nHibernate: \n    \n    create table user_authority (\n       user_id bigint not null,\n        authority_name varchar(50) not null,\n        primary key (user_id, authority_name)\n    )\nHibernate: \n    \n    alter table user \n       add constraint UK_sb8bbouer5wak8vyiiy4pf2bx unique (username)\nHibernate: \n    \n    alter table user_authority \n       add constraint FK6ktglpl5mjosa283rvken2py5 \n       foreign key (authority_name) \n       references authority\nHibernate: \n    \n    alter table user_authority \n       add constraint FKpqlsjpkybgos9w2svcri7j8xy \n       foreign key (user_id) \n       references user\n```\n\nHibernate DB ì´ˆê¸°í™” ì˜¤ë¥˜ë¥¼ í•´ê²°í•˜ê³  ì‹¤í–‰ì„ í•˜ë‹ˆ, ë¡œê·¸ì— SQL ë¬¸ì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤. \n\nì´ ë¡œê·¸ë“¤ì„ ë³´ë©´, ìš°ë¦¬ê°€ ë§Œë“¤ì–´ë‘” Entity ë‚´ìš©ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ DB ê´€ë ¨ ì •ë³´ë“¤ì„ ìƒì„±í•˜ëŠ” ì¿¼ë¦¬ë“¤ì´ ì˜ ìˆ˜í–‰ ëœê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n### ì‹¤ì œ DB ë°˜ì˜ í™•ì¸\n\n[localhost:8080/h2-console](http://localhost:8080/h2-console) ì— ì ‘ì†í•©ë‹ˆë‹¤. (ì¸ì¦ì„ ë¬´ì‹œí•˜ë„ë¡ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ,ì ‘ì†ì´ ì˜ ë˜ì•¼í•©ë‹ˆë‹¤)\n\n![Untitled](2-6.png)\n\nìš°ë¦¬ê°€ ë§Œë“¤ì—ˆë˜ Entity ì •ë³´ë“¤ê³¼ data.sql íŒŒì¼ì˜ ì¿¼ë¦¬ë‚´ìš©ë“¤ì´ ì˜ ë“¤ì–´ì™€ìˆëŠ”ê²ƒì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\në‹¤ìŒ ê°•ì˜ì—ëŠ” JWT ê´€ë ¨ ì½”ë“œë“¤ì„ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n### Reference\n\n[HttpServletRequest ê°œë…](https://chobopark.tistory.com/43)\n\n[properties â†’ YAML](https://devgoat.tistory.com/15)\n\n[log4j loggin level](https://myblog.opendocs.co.kr/archives/950)\n\n[hibernate ddl-auto ì´ˆê¸°í™”ì „ëµ](https://pravusid.kr/java/2018/10/10/spring-database-initialization.html)\n\n[ìŠ¤í”„ë§ë¶€íŠ¸ 2.5 hibernate data.sql](https://velog.io/@khsb2012/ìŠ¤í”„ë§-ë¶€íŠ¸-2.5-ì—…ë°ì´íŠ¸-hibernate-data.sql-ê´€ë ¨-ë³€ë™ì‚¬í•­)","excerpt":"1. 401 Unauthorized í•´ê²°ì„ ìœ„í•œ Security ì„¤ì • SecurityConfig ìƒì„±  config íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œë’¤, SecurityConfig í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. SecurityConfigurer ì„¤ì •ì„ ìœ„í•œ ë‘ê°€ì§€ ë°©ë²•  ë¥¼ â€¦","fields":{"slug":"/springboot-jwt-tutorial2/"},"frontmatter":{"date":"Jan 08, 2022","title":"SpringBoot JWT íŠœí† ë¦¬ì–¼ - 2ì¥ Security ì„¤ì •, Data ì„¤ì •","tags":["SpringBoot","JWT","íŠœí† ë¦¬ì–¼"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"\nì¸í”„ëŸ° ê°•ì˜(Spring Boot JWT Tutorial)ë¥¼ ìˆ˜ê°•í•˜ë©°, ë‚´ìš©ë“¤ì„ ê¸°ë¡í•œ í˜ì´ì§€ì…ë‹ˆë‹¤.\n\n- ë°°ìš°ëŠ” ê²ƒ\n    - Spring Bootë¥¼ ì´ìš©í•œ JWT ì¸ì¦, ì¸ê°€ êµ¬í˜„\n    - Spring Security ê¸°ì´ˆ\n    - íšŒì›ê°€ì…, ë¡œê·¸ì¸, ê¶Œí•œë¡œì§\n\n# JWT ì†Œê°œ ([JWT.io](http://JWT.io) [í™ˆí˜ì´ì§€](https://jwt.io))\n\n---\n\n![Untitled](1-1.png)\n\nJWT ëŠ” Json ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ í† í° ìì²´ì— ì •ë³´ë“¤ì„ ì €ì¥í•˜ê³  ìˆëŠ” Web Token ì´ë¼ í•  ìˆ˜ ìˆë‹¤.\n\níŠ¹íˆ, JWTë¥¼ ì´ìš©í•˜ëŠ” ë°©ì‹ì€ í—¤ë¹„í•˜ì§€ ì•Šê³  ì•„ì£¼ ê°„í¸í•˜ê³  ì‰½ê²Œ ì ì‘í•  ìˆ˜ ìˆë‹¤.\n\n- JWT ëŠ” Header, Payload, Signature  3ê°œì˜ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.\n    - Header : Signature ë¥¼ í•´ì‹±í•˜ê¸° ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ ì •ë³´ë“¤ì´ ë‹´ê¹€\n    - Payload :  ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ê³ ë°›ëŠ”, ì‹œìŠ¤í…œì—ì„œ ì‹¤ì œë¡œ ì‚¬ìš©ë  ì •ë³´ì— ëŒ€í•œ ë‚´ìš©ë“¤ì„ ë‹´ê³ ìˆë‹¤.\n    - Signature : í† í°ì˜ ìœ íš¨ì„± ê²€ì¦ì„ ìœ„í•œ ë¬¸ìì—´\n- ì¥ì \n    - ì¤‘ì•™ì˜ ì¸ì¦ì„œë²„, ë°ì´í„° ìŠ¤í† ì–´ì— ëŒ€í•œ ì˜ì¡´ì„± ì—†ìŒ, ìˆ˜í‰í™•ì¥ì— ìœ ë¦¬\n    - Base64 URL Safe Encoding  > URL, Cookie, Header ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥\n- ë‹¨ì \n    - Payload ì˜ ì •ë³´ê°€ ë§ì•„ì§€ë©´ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ ì¦ê°€, ë°ì´í„° ì„¤ê³„ ê³ ë ¤ í•„ìš”\n    - í† í°ì´ í´ë¼ì´ì–¸íŠ¸ì— ì €ì¥, ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ í† í°ì„ ì¡°ì‘í•  ìˆ˜ ì—†ìŒ\n\n## í”„ë¡œì íŠ¸ ìƒì„±\n\n---\n\n### 1. ìŠ¤í”„ë§ ì´ë‹ˆì…œë¼ì´ì €ë¥¼ í†µí•œ í”„ë¡œì íŠ¸ ìƒì„±\n\n![Untitled](1-2.png)\n\n- í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°ë¥¼ ì…ë ¥í•œë‹¤\n- ìë°” ë²„ì „ì€ 8\n- ë¹Œë“œ ë„êµ¬ëŠ” Gradle\n\n![Untitled](1-3.png)\n\n- ìŠ¤í”„ë§ ë¶€íŠ¸ ë²„ì „ì€ 2.6.2 (ê°•ì¢ŒëŠ” 2.4.1ì„)\n- ì¶”ê°€í•œ ì˜ì¡´ì„±\n    - Lombok (í¸ì˜ì„±)\n    - Spring Web\n    - Spring Security\n    - h2 Database\n    - Spring Data JPA\n    - Validation\n    \n\n![Untitled](1-5.png)\n\n- í”„ë¡œì íŠ¸ê°€ ìƒì„±ëœ ëª¨ìŠµ\n\n![Untitled](1-4.png)\n\n- Lombokì„ ì‚¬ìš©í•˜ë¯€ë¡œ Enable annotaion processing ì„ ì²´í¬í•˜ì.\n\n### 2. ê°„ë‹¨í•œ Rest API í…ŒìŠ¤íŠ¸\n\n![Untitled](1-6.png)\n\nê°„ë‹¨í•œ ë¬¸ìì—´(hello)ì„ ë¦¬í„´í•´ì£¼ëŠ” apië¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\n- `RestController` : ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ JSONì„ ë°˜í™˜í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.\n- `RequestMapping` : ìš”ì²­ì— ëŒ€í•´ ì–´ë–¤ Controllerê°€ ì²˜ë¦¬í• ì§€ë¥¼ ë§µí•‘í•˜ê¸° ìœ„í•œ ì–´ë…¸í…Œì´ì…˜.\n- `GetMapping` : HTTP Methodì¸ Getì¸ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆëŠ” APIë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.\n- `ResponseEntity<>` : ì‚¬ìš©ìì˜ HttpRequestì— ëŒ€í•œ ì‘ë‹µ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” í´ë˜ìŠ¤.\n- `ResponseEntity.ok()`: ì •ìƒì ì¸ ìš”ì²­ì´ë©´ ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„° ë‚´ìš©ì„ ë°˜í™˜í•œë‹¤.\n\nìœ„ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê³  Postmanì„ í†µí•´ì„œ í•´ë‹¹ urlë¡œ ìš”ì²­ì„ ë³´ë‚´ê² ìŠµë‹ˆë‹¤.\n\n![Untitled](1-7.png)\n\nìš”ì²­ì„ ë³´ë‚´ë©´ 401 HTTP ìƒíƒœ ì½”ë“œê°€ ë°˜í™˜ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ Security ì„¤ì •ê³¼, ê¸°ë³¸ì ì¸ Data ì„¤ì •ì„ í•˜ê² ìŠµë‹ˆë‹¤.\n\n### Reference\n\n- [ResponseEntity ìŠ¤í”„ë§ ê³µì‹ ë¬¸ì„œ](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/ResponseEntity.html)","excerpt":"ì¸í”„ëŸ° ê°•ì˜(Spring Boot JWT Tutorial)ë¥¼ ìˆ˜ê°•í•˜ë©°, ë‚´ìš©ë“¤ì„ ê¸°ë¡í•œ í˜ì´ì§€ì…ë‹ˆë‹¤. ë°°ìš°ëŠ” ê²ƒ Spring Bootë¥¼ ì´ìš©í•œ JWT ì¸ì¦, ì¸ê°€ êµ¬í˜„ Spring Security ê¸°ì´ˆ íšŒì›ê°€ì…, ë¡œê·¸ì¸, ê¶Œí•œë¡œì§ JWT ì†Œê°œ (JWâ€¦","fields":{"slug":"/springboot-jwt-tutorial1/"},"frontmatter":{"date":"Jan 07, 2022","title":"SpringBoot JWT íŠœí† ë¦¬ì–¼ - 1ì¥ JWTì†Œê°œ,í”„ë¡œì íŠ¸ìƒì„±","tags":["SpringBoot","JWT","íŠœí† ë¦¬ì–¼"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"# asdfë€? ([asdf ì„¤ì¹˜ í•˜ê¸°](https://subicura.com/mac/dev/terminal-apps.html#asdf))\n\nasdf-vmì€ ê°ì¢… í”„ë¡œê·¸ë¨ì˜ ë²„ì „ì„ ì†ì‰½ê²Œ ê´€ë¦¬í•´ì£¼ëŠ” **ì„±ì˜ ì—†ì–´ ë³´ì´ëŠ” ì´ë¦„**ì˜ ë„êµ¬ì…ë‹ˆë‹¤.<br/>\nê¸°ì¡´ì— nvm, rbenvë“± ì–¸ì–´, í”„ë¡œê·¸ë¨ë³„ë¡œ ë‹¬ëë˜ ê´€ë¦¬ ë„êµ¬ë¥¼ í•˜ë‚˜ë¡œ í†µí•©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <br/>\nhomebrewë„ ì¼ë¶€ ë²„ì „ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ë§Œ asdfë§Œí¼ ê°•ë ¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>\nasdfë¥¼ ì´ìš©í•˜ë©´ ë²„ì „ ë³„ë¡œ ì„¤ì¹˜í•  ìˆ˜ ìˆëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.<br/>\nê·¸ë˜ì„œ ì´ë²ˆì—ëŠ” Java 8 JDKì™€, Java 11 JDK ë¥¼ ë‘˜ë‹¤ ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.<br/>\n\n### ì£¼ì˜\n\në§¥ OS ê°€ ì•„ë‹Œ ë¶„ë“¤ì„ ì•„ì‰½ì§€ë§Œ ë“¤ì–´ì˜¨ ë¬¸ìœ¼ë¡œ ë‚˜ê°€ì£¼ì„¸ìš”. \n\n## ì‹œì‘\n\n```json\nâ¯ java --version\nopenjdk 11.0.13 2021-10-19 LTS\nOpenJDK Runtime Environment Zulu11.52+13-CA (build 11.0.13+8-LTS)\nOpenJDK 64-Bit Server VM Zulu11.52+13-CA (build 11.0.13+8-LTS, mixed mode)\n```\n\ní˜„ì¬ ì €ì˜ ìë°” jdk ë²„ì „ì€ 11ì…ë‹ˆë‹¤. ì €ëŠ” jdk 8 ë²„ì „ì˜ ìë°” í™˜ê²½ë„ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤. \n<br/>ê·¸ëŸ´ë ¤ë©´ í™˜ê²½ë³€ìˆ˜ë„ ë§¤ë²ˆ ì§€ì •í•´ì¤˜ì•¼í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ìˆìŠµë‹ˆë‹¤. \n<br/>asdf ë¥¼ ì´ìš©í•´ì„œ 8ë²„ì „ê³¼ 11ë²„ì „ì„ ìœ ì—°í•˜ê²Œ ëŒì•„ê°€ë©° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.\n\n### ì´ì „ì— ì´ë¯¸ ì„¤ì¹˜í•œ JAVA JDK ëŠ” ì–´ë–¡í•©ë‹ˆê¹Œ?\n\në§Œì•½ brewë¥¼ í†µí•´ì„œ javaë¥¼ ì„¤ì¹˜í•˜ì‹  ë¶„ì´ë¼ë©´ brew uninstall ì„ í†µí•´ jdkë¥¼ ì‚­ì œí•˜ë©´ ë˜ê³ .\n\nì•„ë‹ˆë©´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‚­ì œí•˜ì‹œë©´ ë©ë‹ˆë‹¤.\n\n```json\nâ¯ sudo rm -fr /Library/Internet\\ Plug-Ins/JavaAppletPlugin.plugin\nâ¯ sudo rm -fr /Library/PreferencesPanes/JavaControlPanel.prefPane\nâ¯ sudo rm -fr ~/Library/Application\\ Support/Java\n\nâ¯ cd /Library/Java/JavaVirtualMachines/ \nâ¯ ls \nâ¯ sudo -rm -rf jdk-x.x.x.jdk\n```\n\n### JAVA Plugin ì¶”ê°€\n\n[asdf-java plugin ê¹ƒí—ˆë¸Œ ë§í¬](https://github.com/halcyon/asdf-java#java_home)\n\n- ë¨¼ì € ìë°” í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤\n\n```json\nâ¯ asdf plugin-add java https://github.com/halcyon/asdf-java.git\n```\n\n### ìë°” í”ŒëŸ¬ê·¸ì¸ ì—…ë°ì´íŠ¸\n\ní”ŒëŸ¬ê·¸ì¸ ëª©ë¡ì„ ìµœì‹ í™”í•©ë‹ˆë‹¤.\n\n```json\nâ¯ asdf plugin update java\n```\n\n### ìë°” ë²„ì „ ë³„ í”ŒëŸ¬ê·¸ì¸ ë³´ê¸°\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ë©´ ì„¤ì¹˜í•  ìˆ˜ ìˆëŠ” ìë°”ì˜ ë²„ì „ë“¤ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.\n\n```json\nâ¯ asdf list-all java\n...\nsapmachine-jre-18-internal.0\ntemurin-17.0.0+35\ntemurin-17.0.1+12\ntemurin-jre-17.0.1+12\nzulu-8.52.0.23\nzulu-8.54.0.21\nzulu-8.56.0.23\nzulu-8.58.0.13\nzulu-11.43.1017\nzulu-11.43.1021\nzulu-11.45.27\nzulu-11.48.21\nzulu-11.50.19\nzulu-11.52.13\nzulu-13.35.1019\nzulu-13.35.1025\nzulu-13.37.21\nzulu-13.40.15\nzulu-13.42.17\nzulu-13.44.13\nzulu-15.28.1013\nzulu-15.29.15\nzulu-15.32.15\nzulu-15.34.17\nzulu-15.36.13\nzulu-16.28.11\nzulu-16.30.15\nzulu-16.30.19\nzulu-16.32.15\nzulu-17.28.13\nzulu-17.30.15\n...\n```\n\n(ì˜¤ë¼í´ jdkëŠ” ì„¤ì¹˜ì•ˆí•˜ëŠ”ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. [[JDK ë¼ì´ì„ ìŠ¤ ìœ ë£Œí™”]](https://zdnet.co.kr/view/?no=20181102140004)\n\n### JAVA 8, 11 ë²„ì „ ì„¤ì¹˜\n\nìë°” 8ë²„ì „ê³¼ 11ë²„ì „ì˜ openjdkë¥¼ ì„¤ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.\n\n```json\nâ¯ asdf install java zulu-8.58.0.13\nâ¯ asdf install java zulu-11.52.13\n```\n\n### asdf ì„¤ì¹˜í•œ ìë°” ë²„ì „ í™•ì¸í•˜ê¸°\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´, ì„¤ì¹˜ëœ ìë°” ë²„ì „ë“¤ì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n```json\nâ¯ asdf list java\n  zulu-11.52.13\n  zulu-8.58.0.13\n```\n\n### Global ë²„ì „ìœ¼ë¡œ ì§€ì •í•˜ê¸°\n\nì„¤ì¹˜í•œ ë²„ì „ì„ ì „ì—­ ë²„ì „ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤. ì¦‰ ë‚´ ì»´í“¨í„°ì˜ ìë°” ë²„ì „ì„ ì§€ì •í•œ ë²„ì „ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\n\nì €ëŠ” 8ë²„ì „ì„ ì§€ì •í–ˆìŠµë‹ˆë‹¤.\n\n```json\nâ¯ asdf global java zulu-8.58.0.13\n```\n\n### JAVA_HOME ì„¤ì •í•˜ê¸°\n\n[sadf java-plugin JAVA_HOME ì„¤ì •](https://github.com/halcyon/asdf-java#java_home)\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´, ìë°” ìœ„ì¹˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. (ì²˜ìŒ í•œë²ˆë§Œ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤)\n\n```json\n. ~/.asdf/plugins/java/set-java-home.zsh\n```\n\n### ìë°” ë²„ì „ í™•ì¸í•˜ê¸°\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.\n\n```json\nâ¯ java -version\nopenjdk version \"1.8.0_312\"\nOpenJDK Runtime Environment (Zulu 8.58.0.13-CA-macos-aarch64) (build 1.8.0_312-b07)\nOpenJDK 64-Bit Server VM (Zulu 8.58.0.13-CA-macos-aarch64) (build 25.312-b07, mixed mode)\n```\n\nì •ìƒì ìœ¼ë¡œ 8ë²„ì „ì˜ jdkê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në˜í•œ ìë°” í™˜ê²½ ë³€ìˆ˜ ìœ„ì¹˜ê¹Œì§€ jdk 8ë¡œ ë³€ê²½ëœ ê²ƒ ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```json\nâ¯ echo $JAVA_HOME\n/Users/seonghun/.asdf/installs/java/zulu-8.58.0.13/zulu-8.jdk/Contents/Home\n```\n\n### í˜„ì¬ ì „ì—­ìœ¼ë¡œ ì„¤ì •ëœ ë²„ì „ë“¤ ë³´ê¸°\n\nìë°” ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ë“¤ì˜ ë²„ì „ í˜„í™©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (global version)\n\n```json\nâ¯ asdf current\njava            zulu-8.58.0.13  /Users/seonghun/.tool-versions\nnodejs          lts-fermium     Not installed. Run \"asdf install nodejs lts-fermium\"\nyarn            1.22.17         /Users/seonghun/.tool-versions\n```\n\n### ìë°” ë²„ì „ ë³€ê²½í•˜ê¸°\n\nì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ 11ë²„ì „ì˜ ìë°” jdk ë¡œ ë³€ê²½í•˜ê² ìŠµë‹ˆë‹¤.\n\n```json\nâ¯ asdf global java zulu-11.52.13\n```\n\nê·¸ í›„ ì •ìƒì ìœ¼ë¡œ ë²„ì „ì´ ë³€ê²½ë¬ëŠ”ì§€ í™•ì¸í•˜ê² ìŠµë‹ˆë‹¤.\n\n```json\nâ¯ java --version\nopenjdk 11.0.13 2021-10-19 LTS\nOpenJDK Runtime Environment Zulu11.52+13-CA (build 11.0.13+8-LTS)\nOpenJDK 64-Bit Server VM Zulu11.52+13-CA (build 11.0.13+8-LTS, mixed mode)\n```\n\n8ë²„ì „ì—ì„œ 11ë²„ì „ìœ¼ë¡œ ë³€ê²½ëœ ê²ƒ ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì•„ë˜ ëª…ë ¹ì–´ë¡œ ìë°” í™˜ê²½ë³€ìˆ˜ ê²½ë¡œê¹Œì§€ ìë™ìœ¼ë¡œ ë³€ê²½ëœ ê²ƒ ì„ ë³¼ìˆ˜ìˆìŠµë‹ˆë‹¤.\n\n```json\nâ¯ echo $JAVA_HOME\n/Users/seonghun/.asdf/installs/java/zulu-11.52.13/zulu-11.jdk/Contents/Home\n```\n\n### ê²°ë¡ \n\n`asdf globale java <version>` ëª…ë ¹ì–´ í•œ ì¤„ ë§Œìœ¼ë¡œ ìë°” ë²„ì „ì„ ì‰½ê²Œ ë³€ê²½í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.\n\n(ì›ë˜ë¼ë©´ ìë°” ë²„ì „ì„ ë²„ì „ë§ˆë‹¤ ë³€ìˆ˜ë¡œ ì¶”ê°€í•´ì¤˜ì•¼í•¨)\n\nìë°” ë¿ë§Œ ì•„ë‹ˆë¼ npm, yarn ê°™ì€ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ë˜í•œ ì§€ì›í•˜ë‹ˆ ê²€ìƒ‰í•´ì„œ ìœ ìš©í•˜ê²Œ ì“°ì‹œë©´ ë˜ê² ìŠµë‹ˆë‹¤.\n\n---\n\n[ì°¸ê³ ](https://www.wiserfirst.com/blog/install-java-with-asdf/)\n\n[subicura ë‹˜ mac asdf ì„¤ì¹˜](https://subicura.com/mac/dev/terminal-apps.html#asdf/)\n\n[ë§¥ì—ì„œ Brewë¡œ ìë°” ì„¤ì¹˜í•˜ê¸°(ìë°” ë²„ì „ ë°”ê¾¸ê¸°)](https://llighter.github.io/install-java-on-mac/)","excerpt":"asdfë€? (asdf ì„¤ì¹˜ í•˜ê¸°) asdf-vmì€ ê°ì¢… í”„ë¡œê·¸ë¨ì˜ ë²„ì „ì„ ì†ì‰½ê²Œ ê´€ë¦¬í•´ì£¼ëŠ” ì„±ì˜ ì—†ì–´ ë³´ì´ëŠ” ì´ë¦„ì˜ ë„êµ¬ì…ë‹ˆë‹¤.\nê¸°ì¡´ì— nvm, rbenvë“± ì–¸ì–´, í”„ë¡œê·¸ë¨ë³„ë¡œ ë‹¬ëë˜ ê´€ë¦¬ ë„êµ¬ë¥¼ í•˜ë‚˜ë¡œ í†µí•©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \nhomebrâ€¦","fields":{"slug":"/asdf-java/"},"frontmatter":{"date":"Jan 05, 2022","title":"asdf ë¥¼ ì´ìš©í•œ JAVA ë²„ì „ ë³„ ì„¤ì¹˜","tags":["JAVA","ìë°”","asdf"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"## Spring Securityë€?\n\n- Spring ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ(ì¸ì¦ê³¼ ê¶Œí•œ, ì¸ê°€ ë“±)ì„ ë‹´ë‹¹í•˜ëŠ” ìŠ¤í”„ë§ í•˜ìœ„ í”„ë ˆì„ì›Œí¬\n- **ì¸ì¦**ê³¼ **ê¶Œí•œ**ì— ëŒ€í•œ ë¶€ë¶„ì„ **Filter** íë¦„ì— ë”°ë¼ ì²˜ë¦¬\n    - FilterëŠ” Dispatcher Servlet ìœ¼ë¡œ ê°€ê¸°ì „ì— ì ìš©\n    - ë”°ë¼ì„œ ê°€ì¥ ë¨¼ì € URL ìš”ì²­ì„ ë°›ëŠ”ë‹¤.\n    - í•˜ì§€ë§Œ, InterceptorëŠ” Dispatcherì™€ Contoller ì‚¬ì´ì— ìœ„ì¹˜í•œë‹¤ëŠ” ì ì—ì„œ ì ìš© ì‹œê¸°ì˜ ì°¨ì´ê°€ ìˆë‹¤.\n\n### ì¸ì¦(Authentication)ê³¼ ì¸ê°€(Authorization)\n\n- ì¸ì¦(Authentiacation) : í•´ë‹¹ ì‚¬ìš©ìê°€ ë³¸ì¸ì´ ë§ëŠ”ì§€ë¥¼ **í™•ì¸**í•˜ëŠ” ì ˆì°¨\n- ì¸ê°€(Authorization) : ì¸ì¦ëœ ì‚¬ìš©ìê°€ ìš”ì²­í•œ ìì›ì— ì ‘ê·¼ ê°€ëŠ¥í•œì§€ë¥¼ ê²°ì •í•˜ëŠ” ì ˆì°¨\n\n> Authentiacation â†’ (ì¸ì¦ ì„±ê³µ í›„) â†’ Authorization\n> \n\n- Spring SecurityëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì¸ì¦ ì ˆì°¨ë¥¼ ê±°ì¹œ í›„, ì¸ê°€ ì ˆì°¨ë¥¼ ì§„í–‰\n- ì¸ê°€ ê³¼ì •ì—ì„œ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê²Œ ëœë‹¤.\n- Spring Securityì—ì„œëŠ” ì´ëŸ¬í•œ ì¸ì¦ê³¼ ì¸ê°€ë¥¼ ìœ„í•´ Principalì„ ì•„ì´ë””ë¡œ, Credentialì„ ë¹„ë°€ë²ˆí˜¸ë¡œ ì‚¬ìš©í•˜ëŠ” **Credential ê¸°ë°˜ì˜ ì¸ì¦ ë°©ì‹ì„** ì‚¬ìš©í•œë‹¤.\n    - Principal(ì ‘ê·¼ ì£¼ì²´) : ë³´í˜¸ë°›ëŠ” ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ëŠ” ëŒ€ìƒ\n    - Credential(ë¹„ë°€ì „í˜¸) : ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ëŠ” ëŒ€ìƒì˜ ë¹„ë°€ë²ˆí˜¸","excerpt":"Spring Securityë€? Spring ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ(ì¸ì¦ê³¼ ê¶Œí•œ, ì¸ê°€ ë“±)ì„ ë‹´ë‹¹í•˜ëŠ” ìŠ¤í”„ë§ í•˜ìœ„ í”„ë ˆì„ì›Œí¬ ì¸ì¦ê³¼ ê¶Œí•œì— ëŒ€í•œ ë¶€ë¶„ì„ Filter íë¦„ì— ë”°ë¼ ì²˜ë¦¬ FilterëŠ” Dispatcher Servlet ìœ¼ë¡œ ê°€ê¸°ì „ì—â€¦","fields":{"slug":"/spring-security-1/"},"frontmatter":{"date":"Jan 04, 2022","title":"SpringSecurity ë€?","tags":["Spring Security"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"\nê°œì¸ì ìœ¼ë¡œ ì°¸ê³ í• ë ¤ê³  ê¸°ë¡í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.\n\n## MSA êµ¬ì„±ìš”ì†Œ ë° íŒ¨í„´ì˜ ìœ í˜•\n\n- ì¸í”„ë¼ êµ¬ì„±ìš”ì†Œ : ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ì§€íƒ±í•˜ëŠ” í•˜ë¶€êµ¬ì¡° ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•˜ëŠ”ë° í•„ìš”í•œ êµ¬ì„±ìš”ì†Œ\n- í”Œë«í¼ íŒ¨í„´ : ì¸í”„ë¼ ìœ„ì—ì„œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì˜ ìš´ì˜ê³¼ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í”Œë«í¼ ì°¨ì›ì˜ íŒ¨í„´\n- ì• í”Œë¦¬ì¼€ì´ì…˜ íŒ¨í„´ : ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ”ë° í•„ìš”í•œ íŒ¨í„´\n\n## ì„œë¹„ìŠ¤ ìœ í˜•ë³„ ëŒ€í‘œì ì¸ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤\n\n- `Iaas(Infrastructure as a Service)` :\n  ê°€ìƒ ë¨¸ì‹ , ìŠ¤í† ë¦¬ì§€, ë„¤íŠ¸ì›Œí¬ ê°™ì€ ì¸í”„ë¼ë¥¼ í•„ìš”í•œ ë§Œí¼ ì ì‹œì— ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤\n  (ì˜ˆì‹œ : AWS EC2, GCP Compute Engine, Azure VM)\n\n- `CaaS(Container as a Service)` :\n  ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ê°€ìƒí™”ë¥¼ ì‚¬ìš©í•´ ì»¨í…Œì´ë„ˆë¥¼ ì—…ë¡œë“œ, êµ¬ì„±, ì‹¤í–‰, í™•ì¥, ì¤‘ì§€í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤\n  (ì˜ˆì‹œ : Google Kubernetes Engine, AWS ECS)\n\n- `Paas(Platform as a Service)` : ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¦‰ì‹œ ê°œë°œ, ì‹¤í–‰, ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” í”Œë«í¼ í™˜ê²½ ì„œë¹„ìŠ¤\n  (ì˜ˆì‹œ : Azure Web App, Google App Engine, Heroku, AWS Elastic Beanstalk)\n\n## ê°œë°œ ì§€ì› í™˜ê²½ DevOps\n\n- `DevOps` : ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ë¹Œë“œí•˜ê³  í…ŒìŠ¤íŠ¸í•œ ë’¤ ë°°í¬í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ê°œë°œ ì§€ì› í™˜ê²½\n\n- `CI/CD` - ìë™í™”ëœ ë¹Œë“œë‚˜ ë°°í¬ì‘ì—…,\n\n  - `CI`ëŠ” `ì§€ì†ì  í†µí•©(Continuous Integration)` ìë™ìœ¼ë¡œ í†µí•© ë° í…ŒìŠ¤íŠ¸í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ëŠ” í™œë™\n  - `CD`ëŠ” `ì§€ì†ì  ì œê³µ(Continuous Delivery)` ë° `ì§€ì†ì  ë°°í¬(Continouss Deployment)` ì‹¤í–‰í™˜ê²½ì— ë‚´ë³´ë‚´ëŠ” í™œë™\n  - `ì§€ì†ì  ì œê³µ`ì€ ë¹Œë“œëœ ì†ŒìŠ¤ì½”ë“œì˜ ì‹¤í–‰ íŒŒì¼ì„ ì‹¤í–‰í™˜ê²½ì— ë°˜ì˜í•˜ê¸° ìœ„í•´ ìŠ¹ì¸ ë° ë°°í¬ ë‹´ë‹¹ìì˜ í—ˆê°€ë¥¼ ë°›ì•„ì•¼í•˜ê³ \n    ë°°í¬ë„ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.\n  - `ì§€ì†ì  ë°°í¬`ì€ ì†ŒìŠ¤ì½”ë“œ ì €ì¥ì†Œ(Github)ì—ì„œ ë¹Œë“œí•œ ì†ŒìŠ¤ì½”ë“œì˜ ì‹¤í–‰ íŒŒì¼ì„ ì‹¤í–‰ í™˜ê²½ ê¹Œì§€ ìë™ìœ¼ë¡œ ë°°í¬í•˜ëŠ” ë°©ì‹\n    ëª¨ë“  ì˜ì—­ì„ ìë™í™”í•˜ëŠ” ê²ƒì— í•´ë‹¹í•¨.\n\n- `Infrastructure as a Code` - ì¸í”„ë¼ êµ¬ì„±ì„ ë§ˆì¹˜ í”„ë¡œê·¸ë˜ë°í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ì²˜ë¦¬í•˜ê³  ì†Œìˆ˜ì˜ ì¸ì›ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ë°°í¬ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •\n  (ë°°í¬ íŒŒì´í”„ë¼ì¸ ì ˆì°¨ë¥¼ ì½”ë“œë¡œ ì™„ë²½íˆ ìë™í™”)\n\n## MSA ì£¼ìš” ì•„í‚¤í…ì²˜ íŒ¨í„´\n\n- Spring Cloud + DevOps\n  - Spring Cloud : Spring Boot + Netflix OSS\n\n## ì°¸ê³ í•œ ìë£Œ\n\n- [ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„ë¡œ ì‹œì‘í•˜ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°œë°œ](http://www.yes24.com/Product/Goods/98880996)","excerpt":"ê°œì¸ì ìœ¼ë¡œ ì°¸ê³ í• ë ¤ê³  ê¸°ë¡í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤. MSA êµ¬ì„±ìš”ì†Œ ë° íŒ¨í„´ì˜ ìœ í˜• ì¸í”„ë¼ êµ¬ì„±ìš”ì†Œ : ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ì§€íƒ±í•˜ëŠ” í•˜ë¶€êµ¬ì¡° ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•˜ëŠ”ë° í•„ìš”í•œ êµ¬ì„±ìš”ì†Œ í”Œë«í¼ íŒ¨í„´ : ì¸í”„ë¼ ìœ„ì—ì„œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì˜ ìš´ì˜ê³¼ ê´€ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” í”Œë«í¼ ì°¨ì›ì˜ íŒ¨â€¦","fields":{"slug":"/msa-related-term/"},"frontmatter":{"date":"Sep 28, 2021","title":"ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜(MSA) ê´€ë ¨ ìš©ì–´ ì •ë¦¬","tags":["MSA","ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì³","ì •ë¦¬"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"\nì²˜ìŒì—ëŠ” Jekyllë¡œ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ì—ˆëŠ”ë° ìƒê°ë³´ë‹¤ ë§ˆìŒì— ì•ˆë“¤ì–´ì„œ, ê²€ìƒ‰í•˜ë‹¤ë³´ë‹ˆ Gatsbyë¥¼ ë°œê²¬í–ˆë‹¤.\nGatsbyëŠ” `React` í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì—ˆëŠ”ë° Reactë¥¼ ì „ì— í•œë²ˆ ì…ë¬¸í•´ë´ì„œ ì´ê±¸ë¡œ ì„ íƒí–ˆë‹¤.\n<br>\n<br>\nì²˜ìŒì—ëŠ” `npm`ìœ¼ë¡œ node moduleë¥¼ ì„¤ì¹˜í•´ì„œ í™˜ê²½ì„ êµ¬ì„±í–ˆëŠ”ë°. í›„ë°˜ì— ê°€ë‹ˆê¹ í•œë²ˆ ê¼¬ì´ë‹ˆê¹ ê³„ì† ê¼¬ì—¬ì„œ\nnpmì„ ì¬ì„¤ì¹˜í•˜ê³  ì‹œê°„ì„ ë§ì´ ì¡ì•„ ë¨¹ì—ˆë‹¤. ê·¸ë˜ì„œ `yarn`ìœ¼ë¡œ ë‹¤ì‹œ íŒ¨í‚¤ì§€ ì„¤ì¹˜í•˜ê³  í•˜ë‹ˆ ì˜ë˜ë”ë¼.\n<br>\n<br>\n# 1. Gatsby ì„¤ì¹˜\n\n## Gatsby-cli ì„¤ì¹˜\níŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¥¼ í†µí•´ì„œ `gatsby-cli`ë¥¼ ì„¤ì¹˜í•œë‹¤.\n``` sh\n# npm\nnpm install -g gatsby-cli\n```\n```sh\n# yarn\nyarn add gatsby-cli\n```\n\n## í…Œë§ˆ ì„¤ì¹˜\n```sh\ngatsby new [ë””ë ‰í„°ë¦¬ ì´ë¦„] [í…Œë§ˆ ê¹ƒí—ˆë¸Œ ì£¼ì†Œ]\n```\në””ë ‰í„°ë¦¬ì— ë‹¤ìš´ë°›ì€ í…Œë§ˆê°€ ìœ„ì¹˜ëœë‹¤.\n```sh\ncd [ë””ë ‰í„°ë¦¬ ì´ë¦„]\nyarn start\n```\n\nê·¸í›„ [localhost:8000](localhost:8000) ë¥¼ ì ‘ì†í•´ì„œ ì„¤ì¹˜í•œ í…Œë§ˆë¥¼ ë§›ë³¸ë‹¤.\n\n# 2. ë‚˜ë§Œì˜ ë¸”ë¡œê·¸ë¡œ ê¾¸ë¯¸ê¸°\n## í¬ìŠ¤íŠ¸ ìœ„ì¹˜\në‹¤ìŒ ìœ„ì¹˜ì—ì„œ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.\n\n- `content/blog` : í¬ìŠ¤íŠ¸ íŒŒì¼ ìœ„ì¹˜\n- `content/__about` : í”„ë¡œí•„ íŒŒì¼ ìœ„ì¹˜\n\n<br>\n\ní¬ìŠ¤íŠ¸ íŒŒì¼ì€ `.markdown` ë˜ëŠ” `.md`ì„ ì‚¬ìš©í•œë‹¤.\n<br>\n\n## ë©”íƒ€ë°ì´í„°\n`gatsby-config.js` íŒŒì¼ì´ë‚˜ `gatsby-meta-config.js`íŒŒì¼ì—ì„œ \n<br>\në¸”ë¡œê·¸ë¥¼ ì„¤ì •í•˜ëŠ”\nì—¬ëŸ¬ ìš”ì†Œë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.\nì›í•˜ëŠ” ì„¤ì •ìœ¼ë¡œ ìˆ˜ì •í•˜ë©´ëœë‹¤.\n\nê·¸ ì™¸ì˜ ì„¤ì •ì€ \n`gatsby-browser.js`, `gatsby-node.js`ì„ ì°¸ê³ \n\n## CSS íŒŒì¼\n`src/styles` ìœ„ì¹˜ì—ì„œ CSS ì†ì„±ë“¤ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.\n\n<br>\nì§ì ‘ ì„¤ì •ì„ ë‹¤í•˜ë©´ ê¸€ì„ í•œë²ˆ ì‘ì„±í•´ë´ì„œ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œë‚˜ ìì‹ ë§Œì˜ ì„œë²„ì—ì„œ ë°°í¬í•˜ë©´ëœë‹¤.\n\n# 3. SEO ì ìš©\nSEOëŠ” `search engine optimization`ë¡œ ê²€ìƒ‰ ì—”ì§„ ìµœì í™”, êµ¬ê¸€ì´ë‚˜ ë„¤ì´ë²„ì—ì„œ ìš°ë¦¬ ë¸”ë¡œê·¸ë¥¼ ì°¾ê¸° ì‰½ë„ë¡ ì‚¬ì´íŠ¸ë¥¼ ê°œì„ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì´ë‹¤.\n\n## sitemap.xml ìƒì„±\nê²€ìƒ‰ì—”ì§„ì— ê²€ìƒ‰ì´ ì˜ ë˜ê²Œ í• ë ¤ë©´ ì›¹ í¬ë¡¤ëŸ¬ê°€ ìš°ë¦¬ ì‚¬ì´íŠ¸ë¥¼ ì°¾ì•„ì™€ í¬ë¡¤ë§ì„ í•˜ëŠ”ë°, ìš°ë¦¬ëŠ” ì´ì •í‘œë¥¼ ë§Œë“¤ì–´ì¤˜ì•¼í•œë‹¤.\n`sitemap.xml`ì´ ì´ì •í‘œ ì—­í™œì„ í•œë‹¤.\n<br>\ngatsbyëŠ” `sitemap.xml`ì„ ìë™ ìƒì„±í•´ì£¼ëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ìˆë‹¤. ì¶”ê°€í•˜ì\n<br>\n<br>\n`gastby-config.js`\n```js\n    plugins: [\n        ...\n        'gatsby-plugin-sitemap',\n    ]\n```\npluginsì— ì¶”ê°€í•˜ë©´ build ë  ë•Œ ë§ˆë‹¤ íŒŒì¼ì„ ìƒì„±í•´ì¤€ë‹¤.\n\n<br>\nê·¸ í›„ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ê³ , gatsbyë¥¼ ì‹¤í–‰ í•œë‹¤.\n\n```sh\nyarn add gatsby-plugin-sitemap\ngatsby develop\n```\n\n[http://localhost:8000/sitemap.xml](http://localhost:8000/sitemap.xml)ì— ì ‘ì†\n\n```xml\n<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:news=\"http://www.google.com/schemas/sitemap-news/0.9\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:mobile=\"http://www.google.com/schemas/sitemap-mobile/1.0\" xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\" xmlns:video=\"http://www.google.com/schemas/sitemap-video/1.1\">\n    <url>\n    ...\n    </url>\n</urlset>\n```\nìœ„ì™€ ê°™ì€ xml í˜•ì‹ì˜ ë¬¸ì„œê°€ ë‚˜ì˜¤ë©´ ì„±ê³µ.\n\n## rss.xml ìƒì„±\nrssëŠ” ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì§€ ì•Šì•„ë„ ê·¸ ì‚¬ì´íŠ¸ì˜ ìƒˆë¡œìš´ ê¸€ì´ ì˜¬ë¼ì˜¤ë©´ ì•ŒëŒì„ ì¤€ë‹¤ê³  ìƒê°í•˜ë©´ëœë‹¤.\nê·¸ë¦¬ê³  rssë¥¼ ë“±ë¡í•˜ëŠ”ê²ƒë„ ê²€ìƒ‰ì—”ì§„ìµœì í™” ì‘ì—…ì— í•´ë‹¹ëœë‹¤.\n\n```sh\nyarn add gatsby-plugin-feed\n```\n`sitemap`ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ build í• ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•˜ë‹ˆ pluginsì— ì¶”ê°€í•˜ì.\n\n`gastby-config.js`\n```js\n    plugins: [\n        ...\n        'gatsby-plugin-feed',\n    ]\n```\n`rss.xml` ì´ ì œëŒ€ë¡œ ìƒì„±ë¬ëŠ”ì§€ í™•ì¸í•˜ì\n```sh\ngatsby develop\n```\nê·¸ í›„ [http://localhost:8000/rss.xml](http://localhost:8000/rss.xml)ì— ì ‘ì†\n<br>\n`rss.xml` í˜ì´ì§€ê°€ ì œëŒ€ë¡œ ë‚˜ì˜¨ë‹¤ë©´ ì„±ê³µ.\n\n## robots.txt ìƒì„±\n`robots.txt`ë„ ì›¹ í¬ë¡¤ëŸ¬ê°€ ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ë©´ ì°¾ëŠ” íŒŒì¼ì´ë¯€ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.\n\n```sh\nyarn add gatsby-plugin-robots-txt\n```\n`gastby-config.js`\n\n```js\nplugins: [\n\t...\n\t{\n      resolve: 'gatsby-plugin-robots-txt',\n      options: {\n        host: ì›¹ì‚¬ì´íŠ¸ê²½ë¡œ,\n        sitemap: ì›¹ì‚¬ì´íŠ¸ê²½ë¡œ/sitemap.xml',\n        policy: [{\n          userAgent: '*',\n          allow: '/'\n        }]\n      }\n    },\n\t...\n]\n```\nê·¸ë¦¬ê³  ë¹Œë“œí•´ì„œ í™•ì¸.\n\n```sh\ngatsby develop\n```\nê·¸ í›„ [http://localhost:8000/robots.txt](http://localhost:8000/robots.txt)ì— ì ‘ì†í•´\n`robots.txt`ê°€ ìƒì„±ë¬ëŠ”ì§€ í™•ì¸í•œë‹¤.\n\n## êµ¬ê¸€ ì„œì¹˜ ì½˜ì†”(GSC) ë“±ë¡\n[êµ¬ê¸€ë“±ë¡](https://search.google.com/search-console/about)ì—ì„œ ì‹œì‘í•˜ê¸°ë¥¼ í†µí•´ ë“±ë¡í•œë‹¤.\nìš°ì¸¡ì— URL ì ‘ë‘ì–´ë¥¼ ì„ íƒí•˜ê³  ì¸ì¦ìš© html íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•œë‹¤.\në‹¤ìš´ë°›ì€ html íŒŒì¼ì€ í”„ë¡œì íŠ¸ ê²½ë¡œì— ë³µì‚¬í•˜ê³  `package.json`ì—ì„œ build ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œë‹¤.\n<br>\n`package.json`\n\n```json\n  \"scripts\": {\n        ...\n        \"copy\" : \"cp content/googleì¸ì¦ìš©íŒŒì¼.html public/\",\n        \"build\": \"gatsby build && npm run copy\",\n        ...\n  }\n```\në¹Œë“œì‹œ `npm run copy`ë¥¼ í†µí•´ ì¸ì¦ html íŒŒì¼ì„ public ê²½ë¡œë¡œ ë³µì‚¬í•´ ì¤„ ê²ƒì´ë‹¤.\n\n```\nyarn build\ngatsby serve\n```\në¥¼ í†µí•´ \"http://localhost:9000/googleì¸ì¦íŒŒì¼.html\" ì ‘ì†í•´ì„œ ì˜ ëœ¨ëŠ”ì§€ í™•ì¸í•œë‹¤.\nê·¸ë¦¬ê³  sitemaps ë©”ë‰´ë‚´ì— ë¹ˆì¹¸ì— `sitemap.xml` ì…ë ¥í•˜ê³  ì œì¶œí•œë‹¤.\n\nê·¸ëŸ¬ë©´ êµ¬ê¸€ê²€ìƒ‰ì—”ì§„ì— ë“±ë¡ë˜ê¸°ê¹Œì§„ ëª‡ì‹œê°„ì •ë„ ê±¸ë¦¬ë¯€ë¡œ ê¸°ë‹¤ë¦¬ê³  ê²€ìƒ‰ì°½ì— `site: ë¸”ë¡œê·¸ì£¼ì†Œ` ë¥¼ ì…ë ¥í•´ì„œ í™•ì¸í•˜ì.\n\n\n## ë„¤ì´ë²„ ê²€ìƒ‰ ë…¸ì¶œ\n\në„¤ì´ë²„ ê²€ìƒ‰ë„ êµ¬ê¸€ì— í•˜ë˜ê²ƒì²˜ëŸ¼ í•˜ë©´ëœë‹¤.\nhttps://searchadvisor.naver.com/console/board ì ‘ì†í•´ì„œ ì‚¬ì´íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.\n- ì¢Œì¸¡ ì‚¬ì´ë“œë°” ë©”ë‰´ì—ì„œ ìš”ì²­ - ì‚¬ì´íŠ¸ë§µ ì œì¶œì—ì„œ sitemap.xmlì˜ ê²½ë¡œë¥¼ ì…ë ¥í•œë‹¤.\n- ìš”ì²­ - RSS ì œì¶œì—ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ ê²½ë¡œë¥¼ ì…ë ¥í•œë‹¤.\n- ê²€ì¦ - robots.txtì—ì„œ robots.txt ê²€ì¦ ë° ìˆ˜ì§‘ìš”ì²­ì„ í•œë‹¤.\n- ì„¤ì • - ìˆ˜ì§‘ ì£¼ê¸° ì„¤ì •ì„ ë¹ ë¥´ê²Œë¥¼ ì²´í¬í•œë‹¤.\nëª¨ë“  ë“±ë¡ì´ ëë‚¬ìœ¼ë©´ ëª‡ì‹œê°„ë’¤ì— ê²€ìƒ‰ì°½ì—ì„œ `site: ë¸”ë¡œê·¸ì£¼ì†Œ`ë¥¼ ì…ë ¥í•´ì„œ ë“±ë¡ë¬ëŠ”ì§€ í™•ì¸í•œë‹¤.\n\n## ë‹¤ìŒ ê²€ìƒ‰ ë…¸ì¶œ\në‹¤ìŒì€ ë‹¤ë¥¸ ê²€ìƒ‰ì—”ì§„ë³´ë‹¤ ë§¤ìš° ê°„ë‹¨í•´ì„œ.\nhttps://register.search.daum.net/index.daumì— ì ‘ì†í•´ì„œ ë¸”ë¡œê·¸ë¥¼ ë“±ë¡ë§Œí•˜ë©´ ëì´ë‹¤.\n\n\n# ëìœ¼ë¡œ\nì´ë ‡ê²Œ ê°„ë‹¨í•˜ê²Œ ê²Ÿì¸ ë¹„ë¥¼ í†µí•´ì„œ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ê³  SEO ì ìš©ê¹Œì§€ í•´ë´¤ë‹¤.\nìƒëµëœ ë¶€ë¶„ë„ ë§ì§€ë§Œ ì¶©ë¶„íˆ ì°¸ê³ í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.\nReactë¥¼ ì˜ ì‚¬ìš©í•˜ê±°ë‚˜ ì•ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ê°œë°œìê°€ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤ë©´\nGatsbyë¡œ ë§Œë“¤ì–´ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. í…Œë§ˆë¡œ ë§Œë“¤ì–´ë„ ë˜ì§€ë§Œ ìì‹ ì´ ì§ì ‘ reactë¡œ ë§Œë“¤ì–´ë„ ì¢‹ì„ê²ƒì´ë‹¤.\n<br>\në§Œì•½ì— ë¸”ë¡œê·¸ë¥¼ ìˆ˜ì •í•˜ë‹¤ê°€ `npm` ê´€ë ¨ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´, yarnìœ¼ë¡œ ì „í™˜í•´ì„œ êµ¬ì¶•í•˜ê±°ë‚˜,\nnpm íŒ¨í‚¤ì§€ë¥¼ ì¬ì„¤ì¹˜ í•´ë³´ì.\n\n\n","excerpt":"ì²˜ìŒì—ëŠ” Jekyllë¡œ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ì—ˆëŠ”ë° ìƒê°ë³´ë‹¤ ë§ˆìŒì— ì•ˆë“¤ì–´ì„œ, ê²€ìƒ‰í•˜ë‹¤ë³´ë‹ˆ Gatsbyë¥¼ ë°œê²¬í–ˆë‹¤.\nGatsbyëŠ”  í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì—ˆëŠ”ë° Reactë¥¼ ì „ì— í•œë²ˆ ì…ë¬¸í•´ë´ì„œ ì´ê±¸ë¡œ ì„ íƒí–ˆë‹¤.\n\n\nì²˜ìŒì—ëŠ” ìœ¼ë¡œ node moduleë¥¼ â€¦","fields":{"slug":"/gatsby-blog-start/"},"frontmatter":{"date":"Sep 28, 2021","title":"Gatsbyë¡œ ë¸”ë¡œê·¸ë¥¼ ë§Œë“¤ê¸°","tags":["Gatsby","Blog"],"update":"Jan 01, 0001"}}},{"node":{"rawMarkdownBody":"\n#application.properties\n\nìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ê°€ ì£¼ì–´ì§„ ìˆœì„œëŒ€ë¡œ ê³ ë ¤ëœë‹¤.\n\n1. ëª…ë ¹í–‰ ì¸ìˆ˜\n2. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì™¸ë¶€ì˜ `application.properties`\n3. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì˜ `application.properties`\n\napplication-{profile}.propertiesëŠ” í”„ë¡œí•„ì— ê´€ë ¨ë˜ì§€ ì•Šì€ íŒŒì¼ ë³´ë‹¤ ìš°ì„ ëœë‹¤.\n\n1. ëª…ë ¹í–‰ ì¸ìˆ˜\n2. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì™¸ë¶€ì˜ `application-{profile}.properties`\n3. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì™¸ë¶€ì˜ `application.properties`\n4. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì˜ `application-{profile}.properties`\n5. íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì˜ `application.properties`\n\n##application.properties ì—ì„œ ì†ì„± ê°’ ì‚¬ìš©í•˜ê¸°\nì†ì„± ì™¸ë¶€í™”ë¥¼ ìœ„í•´ ìš°ë¦¬ê°€ ë§Œë“  application.propertiesë¥¼ ì‚¬ìš©í• ë ¤ë©´ `@Value` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.\n`@Value` ì–´ë…¸í…Œì´ì…˜ì€ ìŠ¤í”„ë§ì´ ì†ì„±ì„ ì°¾ê³  í•´ë‹¹ ì†ì„±ì˜ ê°’ì„ ì‚¬ìš©í•˜ë„ë¡ ì§€ì‹œí•œë‹¤.\n\n```java\npublic ë¦¬í„´íƒ€ì… ë©”ì†Œë“œ(@Value(\"${hi}\") int hi) {\n  ...\n}\n```\n\nìŠ¤í”„ë§ì€ hië¼ëŠ” ì´ë¦„ì„ ê°€ì§„ ì†ì„±ì„ ê°ì§€í•˜ê³  ê·¸ ê°’ì„ ì‚¬ìš©í•œë‹¤.\n\në˜í•œ `:`ì„ ì‚¬ìš©í•´ ê¸°ë³¸ê°’ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.\n\n```java\npublic ë¦¬í„´íƒ€ì… ë©”ì†Œë“œ(@Value(\"${hi:10}\") int hi) {\n  ...\n}\n```\n\në§Œì•½ `:` ê¸°ë³¸ê°’ì„ ì§€ì •í•˜ë©´ ê°’ì„ ì°¾ì§€ ëª»í–ˆì„ ë•Œ 10ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.\nê¸°ë³¸ê°’ì„ ì •ì˜í•˜ì§€ ì•Šê³ , í•´ë‹¹ ì†ì„±ì´ ì—†ì„ ë•Œ `IllegalArgumentException`ì´ ë°œìƒí•œë‹¤.\n\n##í”„ë¡œí•„ì„ ì‚¬ìš©í•œ ì†ì„± ì¬ì •ì˜\nìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” í”„ë¡œí•„ì„ ì‚¬ìš©í•´ ì¶”ê°€ êµ¬ì„± íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ ê¸°ì¡´ì˜ application.propertiesë¥¼ ì „ë¶€ ëŒ€ì²´ ë˜ëŠ” ì¼ë¶€ë¥¼ ì¬ì •ì˜í•  ìˆ˜ ìˆë‹¤.\n`application-{profile}.properties`ë¥¼ ë§Œë“¤ë©´ ëœë‹¤.\në§Œì•½ì— `application.properties`ì— `hi` ê°’ì´ ìˆê³ , `application-hi.properties`ì— `hi`ë¼ëŠ” ê°’ì´ ìˆìœ¼ë©´\n`application-hi.properties`ì˜ ì†ì„± ìš°ì„ ìˆœìœ„ê°€ ë†’ê¸° ë•Œë¬¸ì— ëŒ€ì²´ëœë‹¤.\n\n##ë‹¤ë¥¸ ì†ì„± íŒŒì¼ë¡œë¶€í„° ì†ì„± ë¶ˆëŸ¬ì˜¤ê¸°\në‚´ê°€ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ì†ì„± íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ê³ ì í•˜ë©´ì€, `@SpringBootApplication` ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ì—\n`@PropertySource` ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.\n\n```java\n@PropertySource(\"classpath:ì„ì˜ì˜ì†ì„±íŒŒì¼.properties\")\n@SpringBootApplication\npublic class MySpringApp {\n...\n}\n```\n\n`@PropertySource` ì–´ë…¸í…Œì´ì…˜ì€ ìŠ¤í”„ë§ë¶€íŠ¸ê°€ ì‹œì‘í•  ë•Œ ì¶”ê°€ ì†ì„± íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ì¤€ë‹¤.\ní•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ ëŒ€ì‹  ë°‘ì— í‘œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì¶”ê°€ ì†ì„± íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.\n\n| ë§¤ê°œë³€ìˆ˜                          |                         ì„¤ëª… |\n| :-------------------------------- | ---------------------------: |\n| spring.config.name                |             ë¶ˆëŸ¬ì˜¬ íŒŒì¼ ëª©ë¡ |\n| spring.config.location            |             ì†ì„± íŒŒì¼ì˜ ìœ„ì¹˜ |\n| spring.config.additional-location | ì†ì„± íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ì¶”ê°€ ìœ„ì¹˜ |\n\nìœ„ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´, application.propertiesëŠ” ë¶ˆëŸ¬ì˜¤ì§€ ì•ŠëŠ”ë‹¤.\nëª¨ë‘ ê²€ìƒ‰í•˜ëŠ” ë°©ë²•ìœ¼ë¡œëŠ” `--spring.config.name=application,ë¶ˆëŸ¬ì˜¬ì†ì„±íŒŒì¼`ì„ ì‚¬ìš©í•œë‹¤.","excerpt":"application.properties ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ê°€ ì£¼ì–´ì§„ ìˆœì„œëŒ€ë¡œ ê³ ë ¤ëœë‹¤. ëª…ë ¹í–‰ ì¸ìˆ˜ íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì™¸ë¶€ì˜  íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì˜  application-{profile}.propertiesëŠ” í”„ë¡œí•„ì— ê´€â€¦","fields":{"slug":"/springboot-application-properties-extern/"},"frontmatter":{"date":"Sep 27, 2021","title":"[SpringBoot] ì†ì„± ì™¸ë¶€í™”","tags":["SpringBoot","ì†ì„±","Properties"],"update":"Jan 01, 0001"}}}]}},"pageContext":{}},"staticQueryHashes":["2027115977","694178885"]}