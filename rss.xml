<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Hoon's Blog | Feed]]></title><description><![CDATA[Hoon's Backend Dev Blog]]></description><link>https://hoon9901.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Fri, 28 Jul 2023 10:19:56 GMT</lastBuildDate><item><title><![CDATA[[AWS] CodeDeploy, Github action, docker-compose를 이용한 CI/CD 구축]]></title><description><![CDATA[Artscope 서비스를 AWS에 배포하기 위해 CI/CD를 구축하였는데 구축 과정과 시행착오를 기록했습니다. 기존에는 개발 환경에서 깃허브로 커밋을 하게 되면 (develop 브랜치) GitAction을 통해서 Build와 Test과정을 진행하게 …]]></description><link>https://hoon9901.github.io/aws-codedeploy/</link><guid isPermaLink="false">https://hoon9901.github.io/aws-codedeploy/</guid><pubDate>Fri, 28 Jul 2023 19:17:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;http://artscope.kr&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Artscope&lt;/a&gt; 서비스를 AWS에 배포하기 위해 CI/CD를 구축하였는데 구축 과정과 시행착오를 기록했습니다.&lt;/p&gt;
&lt;p&gt;기존에는 개발 환경에서 깃허브로 커밋을 하게 되면 (develop 브랜치) GitAction을 통해서 Build와 Test과정을 진행하게 되는데
Docker 이미지를 저장소에 업로드 하게 되고 온프레미스로 운영중인 개발 서버의 ArgoCD가 해당 이미지를 감지하여 Kubernetes 오브젝트로 배포를 (CD) 진행하게 됩니다. 개발 환경까지는 배포가 자동으로 진행되지만 배포 환경 (main 브랜치)에서는 업로드된 도커 이미지를 직접 가져와 AWS EC2로 배포해야하는 번거로움이 있었습니다.&lt;/p&gt;
&lt;p&gt;그래서 이번에 AWS CodeDeploy를 이용해 배포 환경까지 자동으로 배포를 진행하고자 합니다.
CI/CD 과정은 다음과 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;github 저장소로 commit&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;git action을 통해 build, test 진행 (CI)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;spring boot 프로젝트를 docker 이미지로 빌드&lt;/li&gt;
&lt;li&gt;빌드된 이미지를 docker hub에 업로드&lt;/li&gt;
&lt;li&gt;AWS S3에 새로운 이미지 버전에 대한 정보를 저장&lt;/li&gt;
&lt;li&gt;AWS CodeDeploy에 배포 요청&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;AWS CodeDeploy를 통해 AWS EC2에 배포 (CD)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;고민한-부분&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B3%A0%EB%AF%BC%ED%95%9C-%EB%B6%80%EB%B6%84&quot; aria-label=&quot;고민한 부분 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;고민한 부분&lt;/h3&gt;
&lt;h4 id=&quot;aws-인스턴스는-도커-이미지를-pull하고-run만-하도록-고안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#aws-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4%EB%8A%94-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-pull%ED%95%98%EA%B3%A0-run%EB%A7%8C-%ED%95%98%EB%8F%84%EB%A1%9D-%EA%B3%A0%EC%95%88&quot; aria-label=&quot;aws 인스턴스는 도커 이미지를 pull하고 run만 하도록 고안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AWS 인스턴스는 도커 이미지를 Pull하고 Run만 하도록 고안&lt;/h4&gt;
&lt;p&gt;위 과정을 구성하며 고민한 부분은 AWS CodeDeploy 이용한 배포 레퍼런스를 찾아보니 S3에 애플리케이션 빌드 파일을 업로드 후 EC2 상에서 Docker 이미지를 빌드하고 실행하거나 곧 바로 Java 애플리케이션을 실행하는데 이런 과정으로 진행하지 않고싶었습니다. 이유는 AWS 인스턴스는 한정된 자원으로 운영중인 서비스가 있어서 S3로 부터 무거운 빌드 파일을 받아오거나 Docker 이미지 빌드 과정으로 운영중인 서비스에 조금이라도 영향이 없도록 하고 싶었습니다. &lt;/p&gt;
&lt;p&gt;그래서 고안한 방법으로 GitAction의 Task 중 새롭게 갱신된 도커 이미지명을 파일로 저장해 S3 저장소에 이미지명이 담긴 파일을 업로드하고 CodeDeploy Script상에서 해당 파일 내용을 환경변수로 저장해 컨테이너로 실행하는 방법으로 진행하였습니다.&lt;/p&gt;
&lt;p&gt;위 방법을 적용하니 스프링 빌드 파일(jar, 약 75MB)을 S3에 업로드하지 않아도 되고 도커 이미지 빌드를 EC2가 진행하지 않고 GitAction이 담당하게 되니 최종적으로 EC2 인스턴스에서는 해당 이미지를 Pull 하고 Run하는 과정만 진행하면 되어서 효율적인 방법이라고 생각해 적용했습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;1-iam-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-iam-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;1 iam 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. IAM 설정&lt;/h2&gt;
&lt;h3 id=&quot;11-github-action-iam-사용자-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-github-action-iam-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;11 github action iam 사용자 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.1 Github Action IAM 사용자 생성&lt;/h3&gt;
&lt;p&gt;Github Action에서 사용할 IAM 사용자를 생성합니다. (IAM - 사용자 - 사용자 추가)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;사용자 이름 : artscope-deploy&lt;/li&gt;
&lt;li&gt;액세스 유형 : 프로그래밍 방식 액세스&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;권한 정책&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;인라인 정책 생성&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2012-10-17&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Statement&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Effect&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Action&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;autoscaling:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;codedeploy:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;ec2:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;lambda:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;elasticloadbalancing:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;s3:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;logs:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;sns:*&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Resource&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;생성 후 보안 자격 증명 - 액세스 키 발급 (Access Key ID, Secret Access Key)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;발급받은 Key를 Github 저장소의 Secrets에 등록합니다.&lt;/p&gt;
&lt;h3 id=&quot;12-ec2-iam-역활-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-ec2-iam-%EC%97%AD%ED%99%9C-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;12 ec2 iam 역활 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2 EC2 IAM 역활 생성&lt;/h3&gt;
&lt;p&gt;EC2에서 사용할 IAM 역활을 생성합니다. (IAM - 역활 - 역활 생성)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;역활 이름 : ec2-deploy&lt;/li&gt;
&lt;li&gt;역활 유형 : AWS 서비스&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;권한 정책&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AmazonEC2RoleforAWSCodeDeploy&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;EC2에서 CodeDeploy Agent가 S3에 접근할 수 있도록 권한을 추가합니다.&lt;/p&gt;
&lt;h3 id=&quot;13-codedeploy-iam-역활-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-codedeploy-iam-%EC%97%AD%ED%99%9C-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;13 codedeploy iam 역활 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3 CodeDeploy IAM 역활 생성&lt;/h3&gt;
&lt;p&gt;그리고 CodeDeploy에서 사용할 IAM 역활을 생성합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;역활 이름: artscope-codedeploy&lt;/li&gt;
&lt;li&gt;역활 유형: AWS 서비스&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;권한 정책&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AWSCodeDeployRole&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CodeDeploy가 EC2에 접근할 수 있도록 권한을 추가합니다.&lt;/p&gt;
&lt;h3 id=&quot;14-ec2에-iam-역활-연결&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#14-ec2%EC%97%90-iam-%EC%97%AD%ED%99%9C-%EC%97%B0%EA%B2%B0&quot; aria-label=&quot;14 ec2에 iam 역활 연결 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4 EC2에 IAM 역활 연결&lt;/h3&gt;
&lt;p&gt;EC2에 IAM 역활을 연결합니다.
저는 사용중인 EC2가 있어서 IAM 역활 수정을 했습니다 (EC2 - 인스턴스 - 인스턴스 선택 - IAM 역활 수정)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IAM 역활 : ec2-deploy&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;만약에 EC2를 새로 생성한다면 인스턴스 생성 시 생성한 IAM 역활을 선택하면 됩니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;2-ec2-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-ec2-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;2 ec2 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. EC2 설정&lt;/h2&gt;
&lt;h3 id=&quot;21-aws-cli-설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-aws-cli-%EC%84%A4%EC%B9%98&quot; aria-label=&quot;21 aws cli 설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1 AWS CLI 설치&lt;/h3&gt;
&lt;p&gt;저는 Ubuntu 22.04.2 LTS를 사용하고 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; awscli&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;설치 후 &lt;code class=&quot;language-text&quot;&gt;aws configure&lt;/code&gt; 명령어를 통해 AWS 계정 정보를 입력합니다.
저는 EC2에 IAM 역활을 연결했기 때문에 Access Key ID, Secret Access Key는 입력하지 않습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; aws configure
AWS Access Key ID &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;None&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: 
AWS Secret Access Key &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;None&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: 
Default region name &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;None&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: ap-northeast-2
Default output &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;None&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;:     &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 다음 명령어를 통해 iam-role을 확인합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; aws configure list
      Name                    Value             Type    Location
      ----                    -----             ----    --------
   profile                &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;not set&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;             None    None
access_key     ****************24FZ         iam-role    
secret_key     ****************xJAl         iam-role    
    region           ap-northeast-2      config-file    ~/.aws/config&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 처럼 나오면 정상적으로 설정이 된 것입니다.
만약에 iam-role 관련 access_key, secret_key 가 안나온다면 &lt;code class=&quot;language-text&quot;&gt;~/.aws&lt;/code&gt; 폴더에 credentials 파일을 확인하거나
EC2 역활을 다시 확인하면 됩니다.&lt;/p&gt;
&lt;p&gt;이렇게 하면 EC2에서 AWS CLI, CodeDeploy Agent에 필요한 설정이 완료됩니다.&lt;/p&gt;
&lt;h3 id=&quot;22-codedeploy-agent-설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-codedeploy-agent-%EC%84%A4%EC%B9%98&quot; aria-label=&quot;22 codedeploy agent 설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2 CodeDeploy Agent 설치&lt;/h3&gt;
&lt;p&gt;다음 명령어를 실행해 CodeDeploy Agent를 설치합니다. (Ubuntu 22.04.2 LTS 기준)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; ruby-full
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~ &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;wget&lt;/span&gt; https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/latest/install
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x ./install
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; ./install auto&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;설치가 완료되면 다음 명령어를 통해 CodeDeploy Agent가 정상적으로 실행되는지 확인합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; codedeploy-agent status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;EC2 재시작되면 CodeDeploy Agent가 자동으로 실행되도록 설정합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 다음 명령어를 실행합니다&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;vim&lt;/span&gt; /etc/init.d/codedeploy-startup.sh

&lt;span class=&quot;token comment&quot;&gt;# 다음 내용으로 작성합니다&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#!/bin/bash &lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Starting codedeploy-agent&apos;&lt;/span&gt; 
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; codedeploy-agent restart


&lt;span class=&quot;token comment&quot;&gt;# 실행 권한을 추가합니다&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x /etc/init.d/codedeploy-startup.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 EC2에 CodeDeploy Agent가 정상적으로 설치되었습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;3-codedeploy-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-codedeploy-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;3 codedeploy 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. CodeDeploy 설정&lt;/h2&gt;
&lt;h3 id=&quot;31-codedeploy-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#31-codedeploy-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;31 codedeploy 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1 CodeDeploy 생성&lt;/h3&gt;
&lt;p&gt;CodeDeploy 애플리케이션을 생성합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;CodeDeploy - 애플리케이션 - 애플리케이션 생성&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;애플리케이션 이름 : artscope-codedeploy&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그리고 배포 그룹을 생성합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;CodeDeploy - 배포 그룹 - 배포 그룹 생성&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배포 그룹 이름 : artscope-codedeploy-group&lt;/li&gt;
&lt;li&gt;서비스 역활 : artscope-codedeploy (이전에 생성한 IAM 역활입니다.)&lt;/li&gt;
&lt;li&gt;배포 유형 : 현재 위치&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;환경 구성 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Amazon EC2 인스턴스&lt;/li&gt;
&lt;li&gt;키 : Name&lt;/li&gt;
&lt;li&gt;값 : artscope&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;배포 설정 : CodeDeployDefault.OneAtATime&lt;/li&gt;
&lt;li&gt;로드 밸런싱 : 없음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;32-codedeploy-appspec-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#32-codedeploy-appspec-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;32 codedeploy appspec 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.2 CodeDeploy AppSpec 생성&lt;/h3&gt;
&lt;p&gt;CodeDeploy에서 배포할 때 필요한 설정 파일입니다.
프로젝트에서 다음 파일을 생성했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;./appspec.yml&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; linux
&lt;span class=&quot;token key atrule&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /
    &lt;span class=&quot;token key atrule&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /home/ubuntu/deploy/
    &lt;span class=&quot;token key atrule&quot;&gt;overwrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; yes

&lt;span class=&quot;token key atrule&quot;&gt;permissions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /home/ubuntu/deploy/
    &lt;span class=&quot;token key atrule&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;**&quot;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;owner&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; root
    &lt;span class=&quot;token key atrule&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; root
    &lt;span class=&quot;token key atrule&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;777&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;ApplicationStop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; scripts/stop.sh
      &lt;span class=&quot;token key atrule&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;runas&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; root

  &lt;span class=&quot;token key atrule&quot;&gt;ApplicationStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; scripts/start.sh
      &lt;span class=&quot;token key atrule&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;runas&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; root&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;CodeDeploy에는 다음과 같은 단계가 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ApplicationStop&lt;/li&gt;
&lt;li&gt;DownloadBundle&lt;/li&gt;
&lt;li&gt;BeforeInstall&lt;/li&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;li&gt;AfterInstall&lt;/li&gt;
&lt;li&gt;ApplicationStart&lt;/li&gt;
&lt;li&gt;ValidateService&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;저는 ApplicationStop, ApplicationStart 단계에서 스크립트를 실행하도록 했습니다.&lt;/p&gt;
&lt;h3 id=&quot;33-codedeploy-배포-스크립트-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#33-codedeploy-%EB%B0%B0%ED%8F%AC-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;33 codedeploy 배포 스크립트 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3 CodeDeploy 배포 스크립트 생성&lt;/h3&gt;
&lt;p&gt;CodeDeploy에서 배포할 때 필요한 스크립트 파일입니다.
프로젝트에서 다음 파일을 생성했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;./scripts/stop.sh&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;art-backend

&lt;span class=&quot;token comment&quot;&gt;# 도커 컨테이너가 있는지 확인 (-a 옵션으로 정지된 컨테이너도 확인)&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;RUNNING_CONTAINER_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-aq&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--filter&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;name=&lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;실행중인 컨테이너 ID: &lt;span class=&quot;token variable&quot;&gt;$RUNNING_CONTAINER_ID&lt;/span&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이전 도커 컨테이너 종료&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$RUNNING_CONTAINER_ID&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;이전 도커 컨테이너 종료 및 삭제합니다&quot;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; stop &lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 스크립트는 실행 중인 컨테이너가 있다면 종료하고 삭제합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;./scripts/start.sh&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;IMAGE_FILE_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/home/ubuntu/deploy/image.txt&quot;&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;IMAGE_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$IMAGE_FILE_PATH&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;CONTAINER_ENV_PATH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/home/ubuntu/env/.env&quot;&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;SERVICE_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;art-be

&lt;span class=&quot;token comment&quot;&gt;# Docker Compose YAML을 새로운 도커 버전으로 작성해서 저장&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;version: &apos;3.8&apos;

services:
  art-be:
    container_name: art-backend
    image: &lt;span class=&quot;token variable&quot;&gt;${IMAGE_NAME}&lt;/span&gt;
    ports:
      - 8080:8080
    env_file:
      - &lt;span class=&quot;token variable&quot;&gt;${CONTAINER_ENV_PATH}&lt;/span&gt;
    volumes:
      - logs_data:/logs
      - /home/ubuntu/art-be/pinpoint/profiles:/pinpoint-agent/profiles:rw
      - pinpoint-volumes:/pinpoint-agent
    depends_on:
      - redis
      - pinpoint-agent
      - filebeat

  pinpoint-agent:
    container_name: art-pinpoint-agent
    image: pinpointdocker/pinpoint-agent:2.5.2
    volumes:
      - pinpoint-volumes:/pinpoint-agent

  redis:
    image: redis:7.0-alpine
    command: redis-server --port 6379
    container_name: art-redis
    labels:
      - &quot;&lt;/span&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;redis&lt;span class=&quot;token string&quot;&gt;&quot;
      - &quot;&lt;/span&gt;mode&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;standalone&lt;span class=&quot;token string&quot;&gt;&quot;
    ports:
      - 6379:6379

  filebeat:
    image: filebeat-custom:0.18
    container_name: art-filebeat
    volumes:
      - logs_data:/logs
    ports:
      - 5044:5044

volumes:
  logs_data:
  pinpoint-volumes:

networks:
  default:
    name: art
    external: true&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; docker-compose.yaml

&lt;span class=&quot;token comment&quot;&gt;# 새로운 도커 컨테이너 실행&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;IMAGE_NAME: &lt;span class=&quot;token variable&quot;&gt;$IMAGE_NAME&lt;/span&gt; 도커 실행&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker-compose&lt;/span&gt; up &lt;span class=&quot;token parameter variable&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$SERVICE_NAME&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;새로운 도커 이미지 버전을 알기위해 &lt;code class=&quot;language-text&quot;&gt;/home/ubuntu/deploy/&lt;/code&gt; 경로에 저장된 &lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 파일을 읽어 &lt;code class=&quot;language-text&quot;&gt;IMAGE_NAME&lt;/code&gt; 환경변수에 저장합니다.
그리고 저는 스프링 애플리케이션 뿐만 아니라 pinpoint, redis, filebeat도 함께 실행하기 때문에 docker-compose를 이용해 실행하고 싶어서 갱신된 스프링 서버의 이미지 버전 (&lt;code class=&quot;language-text&quot;&gt;$IMAGE\_NAME&lt;/code&gt;)을 이용하는 docker-compose.yaml을 생성합니다. 그리고 &lt;code class=&quot;language-text&quot;&gt;docker-compose up -d {서비스_이름}&lt;/code&gt; 명령어로 컨테이너를 실행합니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 파일은 Github Action에서 생성하고 S3에 업로드합니다. 그리고 CodeDeploy 배포 요청이 시작되면 Agent가 EC2 인스턴스에서 S3에서 &lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 파일이 담긴 zip을 다운로드 받아 사용합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;4-github-action-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-github-action-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;4 github action 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. GitHub Action 설정&lt;/h2&gt;
&lt;h3 id=&quot;41-github-action-tasks-작성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#41-github-action-tasks-%EC%9E%91%EC%84%B1&quot; aria-label=&quot;41 github action tasks 작성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1 Github Action Tasks 작성&lt;/h3&gt;
&lt;p&gt;프로젝트에서 다음 파일을 생성했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;.github/workflows/prod-ci.yml&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Docker Prod CI

&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;main&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;pull_request&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;main&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;REGISTRY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; docker.io
  &lt;span class=&quot;token key atrule&quot;&gt;IMAGE_NAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository/image&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;name
  &lt;span class=&quot;token key atrule&quot;&gt;DOCKER_REGISTRY_USERNAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.DOCKERHUB_USERNAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;DOCKER_REGISTRY_PASSWORD&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.DOCKERHUB_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;JASYPT_ENCRYPTOR_PASSWORD&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.JASYPT_ENCRYPTOR_PASSWORD &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;AWS_S3_BUCKET_NAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.AWS_S3_BUCKET_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# S3 버킷 이름&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;AWS_CODE_DEPLOY_NAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; artscope&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;codedeploy &lt;span class=&quot;token comment&quot;&gt;# CodeDeploy 애플리케이션 이름&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;AWS_CODE_DEPLOY_GROUP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; artscope&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;codedeploy&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;group &lt;span class=&quot;token comment&quot;&gt;# CodeDeploy 배포 그룹 이름&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    
  &lt;span class=&quot;token key atrule&quot;&gt;build-dockerized-production&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build and push Docker image
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest

    &lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;

    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v3

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Set up JDK 11
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;java@v3
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;java-version&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;11&apos;&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;distribution&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;temurin&apos;&lt;/span&gt;

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Cache Gradle packages
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/cache@v2
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
            ~/.gradle/caches
            ~/.gradle/wrapper&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; runner.os &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;gradle&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; hashFiles(&apos;&lt;span class=&quot;token important&quot;&gt;**/*.gradle*&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &apos;&lt;span class=&quot;token important&quot;&gt;**/gradle-wrapper.properties&apos;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;restore-keys&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
            ${{ runner.os }}-gradle-    &lt;/span&gt;

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Grant execute permission for gradlew
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; chmod +x ./gradlew

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build with Gradle
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; gradle/gradle&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;build&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v2.4.2
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
            build&lt;/span&gt;

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Setup Docker buildx
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; docker/setup&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;buildx&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@79abd3f86f79a9d68a23c75a09a9a85889262adf

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Build the Docker image
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; docker build &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;tag $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.IMAGE_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MAJOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MINOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;f Dockerfile.prod .

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Login to registry $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.REGISTRY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; echo &quot;$DOCKER_REGISTRY_PASSWORD&quot; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; docker login &quot;$REGISTRY&quot; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;u &quot;$DOCKER_REGISTRY_USERNAME&quot; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;password&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;stdin

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Push to $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.REGISTRY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; docker push $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.IMAGE_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MAJOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MINOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;token comment&quot;&gt;# Docker 이미지 이름을 image.txt 파일에 쓰기&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Write Docker image name to file
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; echo &quot;$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.IMAGE_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MAJOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;.$&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.MINOR &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&quot; &lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt; image.txt

      &lt;span class=&quot;token comment&quot;&gt;# CodeDeploy 배포를 위한 관련 파일 압축&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Create zip file for AWS CodeDeploy
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; mkdir $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.AWS_CODE_DEPLOY_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token important&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cp &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;r appspec.yml image.txt scripts $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.AWS_CODE_DEPLOY_NAME &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;token comment&quot;&gt;# AWS 설정&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AWS Configure
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; aws&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;actions/configure&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;aws&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;credentials@v1
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;aws-access-key-id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.AWS_ACCESS_KEY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;aws-secret-access-key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.AWS_SECRET_KEY &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;aws-region&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ap&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;northeast&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;

      &lt;span class=&quot;token comment&quot;&gt;# AWS S3로 배포 파일 업로드&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Upload to AWS S3
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
          aws deploy push \
            --application-name ${{ env.AWS_CODE_DEPLOY_NAME }} \
            --s3-location s3://${{ env.AWS_S3_BUCKET_NAME }}/codedeploy/$GITHUB_SHA.zip \
            --ignore-hidden-files \
            --source ${{ env.AWS_CODE_DEPLOY_NAME }}&lt;/span&gt;

      &lt;span class=&quot;token comment&quot;&gt;# AWS EC2 CodeDeploy 배포 요청&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Delpoy to AWS EC2
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
          aws deploy create-deployment \
            --application-name ${{ env.AWS_CODE_DEPLOY_NAME }} \
            --deployment-config-name CodeDeployDefault.OneAtATime \
            --deployment-group-name ${{ env.AWS_CODE_DEPLOY_GROUP }} \
            --description &quot;Deploy artscope&quot; \
            --s3-location bucket=$AWS_S3_BUCKET_NAME,key=codedeploy/$GITHUB_SHA.zip,bundleType=zip&lt;/span&gt;
          

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Autoincrement a new minor version
        &lt;span class=&quot;token key atrule&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
          echo &quot;NEW_MINOR_VERSION=$((${{ secrets.MINOR }}+1))&quot; &gt;&gt; $GITHUB_ENV&lt;/span&gt;

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Update Minor version
        &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; hmanzur/actions&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;set&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;secret@v2.0.0
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;MINOR&apos;&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; env.NEW_MINOR_VERSION &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;repository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.REPO &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.REPO_ACCESS_TOKEN &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;중요한 부분이라면 다음과 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;빌드된 Docker 이미지 이름을 &lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 파일에 쓰기&lt;/li&gt;
&lt;li&gt;AWS S3로 배포 파일 업로드&lt;/li&gt;
&lt;li&gt;AWS EC2 CodeDeploy 배포 요청&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;업데이트된 이미지명을 기록하고 CodeDeploy의 Script에서 사용하기 위해 &lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 파일을 생성하였고 해당 파일에는 다음 내용으로 쓰여집니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;repository/image-name:1.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;CodeDeploy Agent에서 배포 작업들을 실행 하기 위해 &lt;code class=&quot;language-text&quot;&gt;appspec.yml&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;scripts\&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;image.txt&lt;/code&gt; 를 함께 압축하여 AWS S3에 업로드합니다 그리고 해당 s3 파일의 경로를 알려주면 CodeDeploy Agent가 압축을 풀고 appspec에 명시된 내용을 토대로 배포를 진행합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;5-codedeploy-실행&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-codedeploy-%EC%8B%A4%ED%96%89&quot; aria-label=&quot;5 codedeploy 실행 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. CodeDeploy 실행&lt;/h2&gt;
&lt;p&gt;이제 CodeDeploy를 실행해보겠습니다. &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 브랜치에 푸시를 하면 다음과 같이 Github Actions가 실행됩니다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/99fd3ee320e2961d989b86ea71bbde7b/d8817/image.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQoz2WSa3KjQAyEOUqMw3PeMIDBxsRbrtTe/0K9rcH2OpUfXQKV9M2oNVm33GH7MyodocOCUvWo7ITWz8z1KFSHY+1+6bPxryi95aMuq+2QIB+FTjoUCoU/owhXlAQ2ftrlRmpCbfcouSNhB0LCfIMbNxwqAt1wQZiuaAiWgo/SQLEpjle4bkZLaGt65jgBa0TKRBgeYMMJjpKc/BsekjVsrljwHEGAN+/w93TG97ziPs74E0+4mIBFOczaY+EBc2sxK5tym49YbIdvpZGJTzK/jJtXhkCL0Vls44LbsuHrtGIdFkTl4WsNV2lGC1e2L0UdmDOYqgbZgTcS5ZWlB4wEHnUHEy8wXJYK88ND8Y+2tB3ypmetfakyQ1qe+JkJKMESdAeWHE/TP0uoRNMv6SXId8EF5k231z56ZcufbaBl9j/wHVzSDzeuXNYGN6wJ7EeJ3L6K6YZ5+QbkDooEdD+Bz9FlQTLe/r72t/iMx9ojF731PWE5n80/ZBcTU90XKF8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/99fd3ee320e2961d989b86ea71bbde7b/fcda8/image.png&quot;
        srcset=&quot;/static/99fd3ee320e2961d989b86ea71bbde7b/12f09/image.png 148w,
/static/99fd3ee320e2961d989b86ea71bbde7b/e4a3f/image.png 295w,
/static/99fd3ee320e2961d989b86ea71bbde7b/fcda8/image.png 590w,
/static/99fd3ee320e2961d989b86ea71bbde7b/efc66/image.png 885w,
/static/99fd3ee320e2961d989b86ea71bbde7b/c83ae/image.png 1180w,
/static/99fd3ee320e2961d989b86ea71bbde7b/d8817/image.png 1238w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CodeDeploy 배포 요청이 성공적으로 이뤄지면 다음과 같이 배포 내역을 확인할 수 있습니다.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0e52345bd8c1d99339ecc02620662606/264eb/image-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABb0lEQVQoz42SUU/EIBCE7///Qn3QB03s3UFboC0FShl3tmeNiSaSEOjCfjO79HI3Bi8vr3h6esbb+ztyzudMKcHYHkuM8NOk6yoxrknOg8R4Z14WTPOs+8s4OjjnzyATeLCunCuWJSLKypkeIozr+rhL8SgiFLhQTT9C0AMCpulQY9w5J+uiEApPksS9l/sxHkLOe4WFIMBDJaMzI2IqorrCjAa1VhXozAA/R2zbhuvtDlbEM7aKAowbayU+opSCC51sdUcXMtxSUPeCW+iw7zv2Bti5oJfJMQyDVvK1J6S1pjEr0BNYCHQrpnUTeME9XA+gEO2UMMxZE/v+G9gTKO1g3EvJfd//DTwdKjArEP8FrgqsuHk6KbIvuP4AphNo5RdiMocVwFfJ7OWvJXc+oxZ5afOBtlfpYYMJSXooQDRNYjIHH4J9JJBOjTzSt8OtPoAJVV62XAUorqs4pHNCWzuAp0NxOwyjVuIUaJEF+AnPIQT6AguodAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/0e52345bd8c1d99339ecc02620662606/fcda8/image-1.png&quot;
        srcset=&quot;/static/0e52345bd8c1d99339ecc02620662606/12f09/image-1.png 148w,
/static/0e52345bd8c1d99339ecc02620662606/e4a3f/image-1.png 295w,
/static/0e52345bd8c1d99339ecc02620662606/fcda8/image-1.png 590w,
/static/0e52345bd8c1d99339ecc02620662606/264eb/image-1.png 867w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;배포가 성공적으로 이뤄지면 EC2에 접속하면 실행된 컨테이너와 배포 파일을 확인할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배포된 컨테이너
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/29cd593a21305263c59b71ba2d316085/f0685/image-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 21.62162162162162%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxElEQVQY01WQ2aqEQAxE211xwwWXQUQRURT1QRH0//+rhgrcC/NQkNCpU+mo8zxxHAeKosA0TajrGmEYIkkSuK4LpdS/8jzHvu/ybhgGNE2D53kYhgG+70PXdSgC7/tG13UoyxKfz0fgBNq2/QOkieH0jOOIOI4FSA/FXl3Xhfd90bYt0jQVGMFZlsE0zR9gEATo+x7rumJZFgngpvRQrGXDv0SCqqpC0zRSR1EkqZTjOPLVeZ7xPA+2bZM5noWzlGVZ+ALcAGSEmrpPrwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/29cd593a21305263c59b71ba2d316085/fcda8/image-2.png&quot;
        srcset=&quot;/static/29cd593a21305263c59b71ba2d316085/12f09/image-2.png 148w,
/static/29cd593a21305263c59b71ba2d316085/e4a3f/image-2.png 295w,
/static/29cd593a21305263c59b71ba2d316085/fcda8/image-2.png 590w,
/static/29cd593a21305263c59b71ba2d316085/f0685/image-2.png 835w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;li&gt;배포 파일
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 388px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/28d6cd6030b12b057ba994c0bc0d5d2d/96c67/image-3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 64.1891891891892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNElEQVQ4y5VT2XLaQBCUANtIAgkjg8R9GCNuEIc4hJBsBKmAXYSn/EX+/60zu4nLOE4qyUPXbO1IvT0zPcJut8N4PIbjOJhOp+h0OqjX62i32/zc7/cxGo3QarWQy+Xgui4WiwUmkwny+Ty/EwThDefzGb7vw/M8dLtdzOdzqKqKwWCAIAjQoztGUiwWOSn7LgxDWJaFeDwOwzB4ZGSiKELYUnK+XGJM6tabDTpE0B8MYZOC7k91TEmhUIAsy2g0GrwCBkbGKnkl5DgdDziEW4Qbj8e1M+PYBz623hqr1YqrY0gkEpywUqmgXC4jlUrxxxiSySRM04TwzSrg2VRxyibxklGwV2M46BL22jXOWQVfS2ncZbNcDVPIyEqlEo+MkN1nMhlIkgRN0yC0VRlC7BoWDeDeaqHaeIBumPzMSnBjwvum/w2rIjU1Qeqo9POXE0bDIRY0mHT6FiJ94MsiouLbD7zxF/EDbF2FrKUwGdvcNs5sBpX6wZI3VzF4cQGR/1FYitJrkgI9k0WaeuVufDyQPbqk1DBzWF4JiP1Jze8wpB7F6aDHROQUCU6riZnVwOi+inREwCMRir+UeokPhC+mhk9mCs9FHceCjs+5W7hKBL52gyPlnkoGxGj03xUGtHpLcn+wDeEFj5gulujQljRp6oPxBD4Zn61frVbjNun1emg2m6hWqxhSW2zbfj+kGiXYEFLkoTtdR0JRkCQDM8iy9CNHRDrl2Ea87i/zHyNluCT8Do78TlhlYApKAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/28d6cd6030b12b057ba994c0bc0d5d2d/96c67/image-3.png&quot;
        srcset=&quot;/static/28d6cd6030b12b057ba994c0bc0d5d2d/12f09/image-3.png 148w,
/static/28d6cd6030b12b057ba994c0bc0d5d2d/e4a3f/image-3.png 295w,
/static/28d6cd6030b12b057ba994c0bc0d5d2d/96c67/image-3.png 388w&quot;
        sizes=&quot;(max-width: 388px) 100vw, 388px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이렇게 AWS CodeDeploy와 Github Action, Docker를 이용해 CI/CD를 구축하였습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;시행착오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%ED%96%89%EC%B0%A9%EC%98%A4&quot; aria-label=&quot;시행착오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시행착오&lt;/h1&gt;
&lt;p&gt;구축 과정을 진행하며 저는 여러 오류를 겪었습니다. 그 중 몇 가지를 정리해보겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;1-awscodedeploycommanderrorsaccessdeniedexception&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-awscodedeploycommanderrorsaccessdeniedexception&quot; aria-label=&quot;1 awscodedeploycommanderrorsaccessdeniedexception permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Aws::CodeDeployCommand::Errors::AccessDeniedException&lt;/h2&gt;
&lt;h3 id=&quot;문제점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C%EC%A0%90&quot; aria-label=&quot;문제점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제점&lt;/h3&gt;
&lt;p&gt;CodeDeploy로 배포 요청을 보냈지만 다음과 같은 오류가 발생했습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;aws codedeploy agent log&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-07-22T10:56:39 ERROR &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;codedeploy-agent&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3744996&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: InstanceAgent::Plugins::CodeDeployPlugin::CommandPoller: Error polling &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;host&lt;/span&gt; commands: Aws::CodeDeployCommand::Errors::AccessDeniedException - Aws::CodeDeployCommand::Errors::AccessDeniedException - /opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/raise_response_errors.rb:17:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/jsonvalue_converter.rb:22:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/idempotency_token.rb:19:in `call&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/param_converter.rb:26:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/request_callback.rb:71:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/response_paging.rb:12:in `call&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/response_target.rb:24:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/request.rb:72:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;send_request&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/codedeploy-commands-1.0.0/sdks/codedeploy_commands_sdk.rb:856:in `poll_host_command&apos;&lt;/span&gt;
/opt/codedeploy-agent/lib/instance_agent/plugins/codedeploy/command_poller.rb:170:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;next_command&apos;
/opt/codedeploy-agent/lib/instance_agent/plugins/codedeploy/command_poller.rb:94:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;perform&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/lib/instance_agent/agent/base.rb:28:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:44:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; run&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:86:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;with_error_handling&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:43:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:70:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; run_with_error_handling&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:86:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;with_error_handling&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:69:in `run_with_error_handling&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:33:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; start&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:22:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;loop&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:22:in `start&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:206:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; spawn_child&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:204:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;fork&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:204:in `spawn_child&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:196:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; spawn_children&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:195:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;times&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:195:in `spawn_children&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:134:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;start&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:37:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; start&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:36:in `fork&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:36:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;start&apos;
/opt/codedeploy-agent/bin/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/lib/codedeploy-agent.rb:43:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;block &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; levels&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;main&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/command_support.rb:126:in `execute&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:284:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; call_command&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:297:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call_command&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:79:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/bin/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/lib/codedeploy-agent.rb:90:in `&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;main&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&apos;
&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-07-22T10:56:39 ERROR &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;codedeploy-agent&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3744996&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: InstanceAgent::Plugins::CodeDeployPlugin::CommandPoller: Cannot reach InstanceService: Aws::CodeDeployCommand::Errors::AccessDeniedException - Aws::CodeDeployCommand::Errors::AccessDeniedException&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;해결방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0%EB%B0%A9%EC%95%88&quot; aria-label=&quot;해결방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해결방안&lt;/h3&gt;
&lt;p&gt;AcessDeniedException 에러가 발생했는데 이는 IAM Role에 CodeDeploy에 대한 권한이 없어서 발생한 문제였습니다. 그래서 IAM Role에 CodeDeploy에 대한 권한을 추가해주었습니다.&lt;/p&gt;
&lt;h2 id=&quot;2-awscodedeploycommanderrorsunrecognizedclientexception---the-security-token-included-in-the-request-is-invalid&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-awscodedeploycommanderrorsunrecognizedclientexception---the-security-token-included-in-the-request-is-invalid&quot; aria-label=&quot;2 awscodedeploycommanderrorsunrecognizedclientexception   the security token included in the request is invalid permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Aws::CodeDeployCommand::Errors::UnrecognizedClientException - The security token included in the request is invalid.&lt;/h2&gt;
&lt;h3 id=&quot;문제점-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C%EC%A0%90-1&quot; aria-label=&quot;문제점 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;aws codedeploy agent log&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-07-25T00:00:00 ERROR &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;codedeploy-agent&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8749&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: InstanceAgent::Plugins::CodeDeployPlugin::CommandPoller: Error polling &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;host&lt;/span&gt; commands: Aws::CodeDeployCommand::Errors::UnrecognizedClientException - The security token included &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; the request is invalid. - /opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/raise_response_errors.rb:17:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/jsonvalue_converter.rb:22:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/idempotency_token.rb:19:in `call&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/param_converter.rb:26:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/request_callback.rb:71:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/aws-sdk-core/plugins/response_paging.rb:12:in `call&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/plugins/response_target.rb:24:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;call&apos;
/opt/codedeploy-agent/vendor/gems/aws-sdk-core-3.121.1/lib/seahorse/client/request.rb:72:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;send_request&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/codedeploy-commands-1.0.0/sdks/codedeploy_commands_sdk.rb:856:in `poll_host_command&apos;&lt;/span&gt;
/opt/codedeploy-agent/lib/instance_agent/plugins/codedeploy/command_poller.rb:170:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;next_command&apos;
/opt/codedeploy-agent/lib/instance_agent/plugins/codedeploy/command_poller.rb:94:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;perform&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/lib/instance_agent/agent/base.rb:28:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:44:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; run&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:86:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;with_error_handling&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:43:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:70:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; run_with_error_handling&apos;
/opt/codedeploy-agent/lib/instance_agent/runner/child.rb:86:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;with_error_handling&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:69:in `run_with_error_handling&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:33:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; start&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:22:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;loop&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/child.rb:22:in `start&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:206:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; spawn_child&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:204:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;fork&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:204:in `spawn_child&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:196:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; spawn_children&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:195:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;times&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:195:in `spawn_children&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:134:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;start&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:37:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; start&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:36:in `fork&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/process_manager-0.0.13/lib/process_manager/master.rb:36:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;start&apos;
/opt/codedeploy-agent/bin/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/lib/codedeploy-agent.rb:43:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;block &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; levels&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;main&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/command_support.rb:126:in `execute&apos;&lt;/span&gt;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:284:in &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; call_command&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:297:in &lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;call_command&lt;span class=&quot;token string&quot;&gt;&apos;
/opt/codedeploy-agent/vendor/gems/gli-2.11.0/lib/gli/app_support.rb:79:in `run&apos;&lt;/span&gt;
/opt/codedeploy-agent/bin/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/lib/codedeploy-agent.rb:90:in `&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;main&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&apos;
&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-07-25T00:00:00 ERROR &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;codedeploy-agent&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8749&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: InstanceAgent::Plugins::CodeDeployPlugin::CommandPoller: Cannot reach InstanceService: Aws::CodeDeployCommand::Errors::UnrecognizedClientException - The security token included &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; the request is invalid.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;IAM 권한에 대한 문제는 없었는데 지속적으로 Agent에서 에러가 발생했습니다 Agent 로그 상에서도
&lt;code class=&quot;language-text&quot;&gt;Aws::CodeDeployCommand::Errors::UnrecognizedClientException - The security token included in the request is invalid.&lt;/code&gt;
Secret token이 유효하지 않다고 메시지가 보였습니다.&lt;/p&gt;
&lt;p&gt;IAM 액세스 키나 EC2 IAM 역활도 여러 권한을 추가하고 Agent를 재설치하거나 EC2를 재시작해도 해결이 되지 않아 CodeDeploy Agent aws_wire_log를 활성화하여 해당 로그를 확인해봤습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;aws codedeploy agent aws_wire log&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;opening connection to codedeploy-commands.ap-northeast-2.amazonaws.com:443&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
opened
starting SSL &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; codedeploy-commands.ap-northeast-2.amazonaws.com:443&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
SSL established, protocol: TLSv1.2, cipher: ECDHE-RSA-AES128-GCM-SHA256
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;- &lt;span class=&quot;token string&quot;&gt;&quot;POST / HTTP/1.1&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Content-Type: application/x-amz-json-1.1&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Accept-Encoding: &lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;User-Agent: aws-sdk-ruby3/3.121.1 ruby/3.0.2 x86_64-linux-gnu aws-sdk-codedeploycommand/1.0.0&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;X-Amz-Target: CodeDeployCommandService_v20141006.PollHostCommand&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;X-Amz-Codedeploy-Agent-Version: OFFICIAL_1.6.0-49_deb&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Host: codedeploy-commands.ap-northeast-2.amazonaws.com&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;X-Amz-Date: 20230726T071557Z&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;X-Amz-Content-Sha256: 43bee01b74391facd1d25...75a441ac49517bfc71ccf565&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Authorization: AWS4-HMAC-SHA256 Credential=AKIAX...C26VMCRNUX/20230726/ap-northeast-2/codedeploy-commands/aws4_request, SignedHeaders=content-type;host;x-amz-codedeploy-agent-version;x-amz-content-sha256;x-amz-date;x-amz-target, Signature=2271f959ef...7a6e66b278&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Content-Length: 89&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;Accept: */*&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;HTTP/1.1 400 Bad Request&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;x-amzn-RequestId: 897d8a0f-869a-47ef-80d9-c13d0ec189b7&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Date: Wed, 26 Jul 2023 07:15:57 GMT&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Content-Type: application/x-amz-json-1.1&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Content-Length: 107&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;connection: keep-alive&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token entity&quot; title=&quot;\r&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
reading &lt;span class=&quot;token number&quot;&gt;107&lt;/span&gt; bytes&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
-&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;{&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;__type&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;:&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;UnrecognizedClientException&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;,&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;message&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;:&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;The security token included in the request is invalid.&lt;span class=&quot;token entity&quot; title=&quot;\&amp;quot;&quot;&gt;\&quot;&lt;/span&gt;}&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;read&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;107&lt;/span&gt; bytes
Conn keep-alive
I, &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-07-26T07:15:57.958765 &lt;span class=&quot;token comment&quot;&gt;#25534]  INFO -- : [Aws::CodeDeployCommand::Client 400 0.017194 0 retries] poll_host_command(host_identifier:&quot;arn:aws:ec2:ap-northeast-2:539239817397:instance/i-0e9fe7b11be081a65&quot;) Aws::CodeDeployCommand::Errors::UnrecognizedClientException The security token included in the request is invalid.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;AWS CodeDeploy Server로 Agent가 주기적으로 요청을 보내는데 이때, 요청에 대한 응답이 400 Bad Request로 오고 &lt;code class=&quot;language-text&quot;&gt;The security token included in the request is invalid&lt;/code&gt; 라는 메시지가 포함되어 있었습니다.&lt;/p&gt;
&lt;p&gt;이를 통해 Agent가 AWS CodeDeploy Server로 요청을 보낼 때, 요청에 대한 인증이 실패하고 있음을 알 수 있었습니다.&lt;/p&gt;
&lt;p&gt;저는 처음에 IAM 사용자나 EC2 역활이 제대로 aws configure에 등록되지 않았나 싶어서 액세스 키를 새롭게 발급해서 등록하거나, EC2 역활을 새롭게 생성해서 다시 등록해봐도 해결이 되지 않았습니다 그리고 Agent도 여러번 삭제했지만 해결이 되지 않았습니다.&lt;/p&gt;
&lt;p&gt;로그를 다시 확인하니 &lt;code class=&quot;language-text&quot;&gt;Authorization&lt;/code&gt; 요청 헤더에 포함된 &lt;code class=&quot;language-text&quot;&gt;Credentials&lt;/code&gt;를 확인해보니 제가 발급한 액세스키와 비밀키도 아니였고 EC2 역활의 액세스 키와 비밀키도 아니였습니다. 그래서 &lt;code class=&quot;language-text&quot;&gt;.aws&lt;/code&gt; 경로를 확인해봐도 로그에 나타나는 Credentials와 일치하는 액세스 키와 비밀키가 없었습니다.&lt;/p&gt;
&lt;h3 id=&quot;해결방안-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0%EB%B0%A9%EC%95%88-1&quot; aria-label=&quot;해결방안 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해결방안&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;.aws&lt;/code&gt; 관련해서 이상한 액세스 키를 이용해 요청하니 해당 경로가 문제가 있다고 생각했습니다. 그래서 &lt;code class=&quot;language-text&quot;&gt;ubuntu&lt;/code&gt; 계정이 아닌 &lt;code class=&quot;language-text&quot;&gt;root&lt;/code&gt; 계정으로 &lt;code class=&quot;language-text&quot;&gt;/.aws&lt;/code&gt; 경로를 확인하니 &lt;code class=&quot;language-text&quot;&gt;credentials&lt;/code&gt; 파일이 존재했습니다. 해당 파일을 확인하니 요청에 담긴 Credentials의 액세스 키가 있었습니다. 이전에 root 계정으로 aws cli를 실행한 적이 있는데 이로 인해 발생한 문제였습니다. 해당 파일을 삭제하니 정상적으로 Agent가 AWS CodeDeploy Server로 요청을 보내고 응답을 받을 수 있었습니다. &lt;/p&gt;
&lt;p&gt;혹시나 저와 같은 증상이 발생한다면 &lt;code class=&quot;language-text&quot;&gt;root&lt;/code&gt; 나 aws cli를 사용했던 계정들의 &lt;code class=&quot;language-text&quot;&gt;.aws&lt;/code&gt; 폴더를 확인하면 될것 같습니다.&lt;/p&gt;
&lt;h2 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://jwkim96.tistory.com/272&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://jwkim96.tistory.com/272&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jojoldu.tistory.com/281&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://jojoldu.tistory.com/281&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[23년도 상반기 회고 - 한중일 캡스톤대회, ETRI 인턴 그리고 Artscope]]></title><description><![CDATA[23년도의 반이 흘렀다. 올해부터 4학년이 되었고 정신없이 지낸거 같고 깃허브의 잔디를 보면 많이한거 같지만 내가 생각했을땐 유의미한 뭐가 없었던 것 같기도 하다. 그 동안 해왔던 거를 이력서나 포토폴리오로 작성해보기도 하고 몇번 서류 합격을 받았지…]]></description><link>https://hoon9901.github.io/23-first-half/</link><guid isPermaLink="false">https://hoon9901.github.io/23-first-half/</guid><pubDate>Tue, 18 Jul 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/af89f619eddf61decf9f98c162582d74/64639/Pasted%20image%2020230708180132.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 28.37837837837838%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABK0lEQVQY021QSW7DMAz0K4oETeJ4kWU7tkRaS+psPfTSXlqg///LlJaBnHoYDElxSGoyinfYcBPcMUwzjL8JrtCDx1ENKPSIohlX/gfqNEGPPmGJs0XYjQGdCYl7E9GPEU0/QXWMphPuGapl1C2tucRKS64JuncJS3/dEbKezygsoSbZxAGKPdpzRM0TjlGanAgooJoc6kmukDc9R6j3iCIwqmtAPkufdWlhNoQLtjeD1zeDPDIOgbC/EHY3xsuHWYeSw+ZusHsQNp+E/Nsj//XYfjG2P4zNw6L0MvDEyJqTS6JSLlLGJXEl1+69wcHZ5Es9MI4TobSMwgh7qYW1/xAJxWX1sewtsuXf7RBWSLEVLxdfK21RNTZx2Zpn/OTWJu/KkaBm8XBwqfYH4Pa2TpcFyMMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/af89f619eddf61decf9f98c162582d74/fcda8/Pasted%20image%2020230708180132.png&quot;
        srcset=&quot;/static/af89f619eddf61decf9f98c162582d74/12f09/Pasted%20image%2020230708180132.png 148w,
/static/af89f619eddf61decf9f98c162582d74/e4a3f/Pasted%20image%2020230708180132.png 295w,
/static/af89f619eddf61decf9f98c162582d74/fcda8/Pasted%20image%2020230708180132.png 590w,
/static/af89f619eddf61decf9f98c162582d74/efc66/Pasted%20image%2020230708180132.png 885w,
/static/af89f619eddf61decf9f98c162582d74/c83ae/Pasted%20image%2020230708180132.png 1180w,
/static/af89f619eddf61decf9f98c162582d74/64639/Pasted%20image%2020230708180132.png 1568w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;23년도의 반이 흘렀다. 올해부터 4학년이 되었고 정신없이 지낸거 같고 깃허브의 잔디를 보면 많이한거 같지만 내가 생각했을땐 유의미한 뭐가 없었던 것 같기도 하다. 그 동안 해왔던 거를 이력서나 포토폴리오로 작성해보기도 하고 몇번 서류 합격을 받았지만 매번 코테에서 좋은 결과를 받지 못해서 그런가 번아웃이 오고 그래서 그동안의 내가 뭘 했는지 되돌아 볼려고 회고를 작성하면서 지금까지를 정리해보려고 한다. 23년도 상반기 회고 이지만 22년도 12월 부터 시작한다.&lt;/p&gt;
&lt;h2 id=&quot;cedc-2022-한중일-캡스톤-디자인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cedc-2022-%ED%95%9C%EC%A4%91%EC%9D%BC-%EC%BA%A1%EC%8A%A4%ED%86%A4-%EB%94%94%EC%9E%90%EC%9D%B8&quot; aria-label=&quot;cedc 2022 한중일 캡스톤 디자인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CEDC 2022 한중일 캡스톤 디자인&lt;/h2&gt;
&lt;p&gt;23년도 2학기엔 캡스톤 디자인이라는 프로그램을 통해 &lt;code class=&quot;language-text&quot;&gt;클라우드 서버를 이용한 스마트팜 관리 플랫폼&lt;/code&gt;이라는 주제를 통해 팀 프로젝트를 진행했는데 나는 팀장으로 수행했고 백엔드 개발도 했었다. 교내 경진대회에서 좋은 평가를 받아 수상까지 하게 되었고 지도 교수님이 한번 12월에 열리는 한중일 글로벌 캡스톤 디자인 대회에서도 참가해서 발표를 해보라고 하셔서 발표날 까지 많은 준비를 했었다. &lt;/p&gt;
&lt;p&gt;22년도 CEDC 대회는 코로나로 인해 비대면 ZOOM으로 대회가 진행이 되었는데 코로나 전에는 대회가 열리는 국가에 직접 가서 발표를 했다고 한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f4e886ed263018a79fc1d49f64d7f09b/b1584/Pasted%20image%2020230718172141.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 137.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEGUlEQVRIx31VZ3PbRhDV//8n+pixE2usjHscyyWm2AAQLCAJNnSABNj5su+AoyBPJpx52r3d02L73UB+l8sF9d/5fEaapoiiSCGO4yslgiBAGIY4nU749f9veNCgoTrq8v/jtVHiRgvGYwetZhPdbhf9fl/R4XAI07LQarXQ6XRgGAba7TZMoT2RW6aJkdwpf5VBsrvdFo4ox70eptMpnPEYI8fBdDLBlPzIwUTkY9uWOxYmcm8iH3XE6Mx1n4V+QwfjLMfCjxDGKYIohh9GCoEgJOKkPIuOPEHeC0rdOi9wOB7LHB6OZ7z9OcTrBwsd05ZwbfR6Nmz7CT3xiGmw7d71bNfQlXSwWMog/6RJguViAc/zsFyusBB+tSrpcrlUckLLFtXd+XwO3/eRZRkOh0NpkJWiIBGj/ArbhaCMlHLN6zNp/W5RFDjqkGmQXriSXHrAosxmM/V17V3dW1Lql9pT8ZA0z/Mng7qJSUOh2+1WfZFhaMpKkif2+30pJxUd9bRzNZjEMgVRqBCF4ZVnWPSOk8FccTquPKeIEyOReHKnECeUwdPpjL4zgzWcwB5NMRxLuL4YCmL5UDlyzJsePZ3r8ix8pdvtdlXbiMF30jZ/fO7i/quJdz96eP3VwucGW8JCr2oTDYsTIlCtU+k4QUma6La5YJMl2KSxUPEgCpAlEbL0qeoMUy8KgqHXFwcLx7xWIZ+kSkup6gKuVC+Qy+vNBuv1WlWOlNhUsjol9J1nbcO8aGgDBPuvzms9+Xqfkl49pEGGROhe0/32X2dWmOf6h+nps0kp+5D5yhRljuoT8mvOdG61x5TTQ06MMhiHkvTQh++tEAYyGdV00BsiSeJavjbPvKNMh0zc7A8n3D8Y+O19A6/+auL3T7JM2y21VJuycIlO14Bhlu1hyt60NCxTnbmMr9uGVpdeoHaiF3IfZqJkOCk29Eg8K8IptslCvMyl31Klj0UfxSwkC1fbNmXsOfgQOPMC7UGCR1v6Ma8ensUXuI079I0GzulUiTpyp2FF+GlKXrPD9YFSG5sGU0n+ZV+g+fM7nL4Jz3XgTUfIvQkOK3lbHt/DMX5Is/voi47FCpIQfrKSvB1U7s7nSzV64mrAIpgN3P35Emb7G5pv7tD5eI/EHSCTMEejoRhLsd4e8ertnbw3QyRiNAx8OJMZvDR/bnDpSV95LUSDjziHDSSjTzAe34gnMxnHVD1aM5mkTb6Vqu5ly8RoS7Gstinp2qHYHXHS62t/OMosuiiiDnL/EXncwTY14LsP8OM5kk2hlmkQhJL4IyLXlwJlcAYDRCsPl6PsSVkw3FqlhxK/7wcY+QNYqw7M8T9oj74L/4heMIa7WGE+c+HKJvfmM3wYzGXDGBjLe/zixUvc3t7i299fpCClwX8BnEnv94T9M90AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/f4e886ed263018a79fc1d49f64d7f09b/fcda8/Pasted%20image%2020230718172141.png&quot;
        srcset=&quot;/static/f4e886ed263018a79fc1d49f64d7f09b/12f09/Pasted%20image%2020230718172141.png 148w,
/static/f4e886ed263018a79fc1d49f64d7f09b/e4a3f/Pasted%20image%2020230718172141.png 295w,
/static/f4e886ed263018a79fc1d49f64d7f09b/fcda8/Pasted%20image%2020230718172141.png 590w,
/static/f4e886ed263018a79fc1d49f64d7f09b/efc66/Pasted%20image%2020230718172141.png 885w,
/static/f4e886ed263018a79fc1d49f64d7f09b/c83ae/Pasted%20image%2020230718172141.png 1180w,
/static/f4e886ed263018a79fc1d49f64d7f09b/b1584/Pasted%20image%2020230718172141.png 1342w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;영어로 발표를 해야하기 때문에 참가 문서, 소개 문서, 발표 PPT 등 전부를 한글로 초안을 작성하고 번역을 하는 식으로 해서 필요한 문서를 작성했다. 논문과 같은 학술 문서를 작성해본적이 없어서 팀원들의 도움과 지도교수님의 첨삭을 통해서 문서를 계속 초안에서 최종까지 날밤세면서 작성을 했다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1268347e318e44c5ad89faf2de5e2ecf/e1596/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAAB0EZUmuCYV//EABsQAAIDAAMAAAAAAAAAAAAAAAABAgMRBBMh/9oACAEBAAEFAnXhbJRFPB8tj7bIN+//xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAwEBPwFX/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQIBAT8BR//EAB0QAAIBBAMAAAAAAAAAAAAAAAABERIhIjEDMqH/2gAIAQEABj8C7eFLIex4qxUnZvSJ5Fkz/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARITFRYUH/2gAIAQEAAT8hAeu4tk0eoJMBiM+BcNblqnnJRA9AaZ//2gAMAwEAAgADAAAAEAvf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/ENSBG3//xAAXEQEBAQEAAAAAAAAAAAAAAAABABFB/9oACAECAQE/EMGQPb//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhQXExUbH/2gAIAQEAAT8QBZh4ZvkrPqFiqKXVMAjKqLoF9l52ABUIAI6vOiOQRMhXrXJ//9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/1268347e318e44c5ad89faf2de5e2ecf/1c72d/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg&quot;
        srcset=&quot;/static/1268347e318e44c5ad89faf2de5e2ecf/a80bd/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 148w,
/static/1268347e318e44c5ad89faf2de5e2ecf/1c91a/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 295w,
/static/1268347e318e44c5ad89faf2de5e2ecf/1c72d/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 590w,
/static/1268347e318e44c5ad89faf2de5e2ecf/a8a14/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 885w,
/static/1268347e318e44c5ad89faf2de5e2ecf/fbd2c/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 1180w,
/static/1268347e318e44c5ad89faf2de5e2ecf/e1596/998AB42A-941D-4225-BC78-972AE1942C64_1_102_o.jpg 2048w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그렇게 해서 문서를 계속계속 수정하다 보니 발표 당일이 되었고 내 차례가 오기까지 다른 참가 조의 발표를 같이 있던 팀원 들과 모니터링 하면서 기다리고 있었다 영어로 발표를 해야하기 때문에 개인적인 시간에 영어 발음과 작성한 발표 대본을 계속 읽고 다른 사람들한테 들려주면서 연습을 했었고 전날 밤에는 꿈에서 영어로 말하는 지경까지 왔었다 (한동안 영어로 생각까지 했다..)&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c66174da24900c8d60742ec8b40e053d/21e8f/Pasted%20image%2020230718172936.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 62.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAADX0lEQVQozx2RWUycZRSGf2MsskqkLNPiMC1TFmkqbSxMO0BaljDAYAICNZRa0MTaNFGJMdUUTC0xMXpBTYOApkSrrYFoVS5qC9IC7ehkwhbW4Z9hth9mY1gUbXr3+MHFuThfTp7vOeeVnk+MJy4hngSVit2qJFGJJCbvQZWyl2RNMqoXVKJPRKVWkZal5WB2BoeOZJJzPJuiUj1VtQYMVUWUGHTkHlEjRcY+hyZtP5rMVJJS1aQfzkRfnMPJMr2oE5RXGznVWM9b756npa2Frusd9N7+katftfPJ559x5ct29MZyDhXkUlmZg3SyopCK1yp552IzX3/bycD93xibGMZiGWF0dIiJMTNul0zQ78Fht+J2yqK3Mzm9wNSYhRnbHF90XCNOu48yowA2XDhLXVMtfX032QiuoDhkAitOVn1OgisOfIqdZbeMTZ4RICvLigPnkpU7gxZu/HCL3u+7ebu5mcTMDAqKspGKqgyUVhu4ees7/t3w41+2E/K7WF91sRZ0sRHyEPQ6MZtGka3TO7ZLtnnGx03cG7yLzWblg9ZLRKdoKDHqkSobXuEl/VGuXmvnyVYI3zYw4BZA9w40FHAyM2vBYZthTbxvf+iQ58Wck4DXw+OtTTq6Onkqdjf5ZQVI5acqiU1J5f0PL+4Ybq9oGhnAZZ/dMVXcVnpudDM3bcEjVlWci1gXxrELy23T1cAKv/x6m4j4JLJ0LyPlFucTlayhoalJ3M0t7udgaKAf6+wELnmBZRGC372Ez2PDNje1Y/rI3C8CWhDgeRSPE9PDYfalH2D/i+lIx0ryiNdqqaiuxuNYFEAXow/uMTn2CK/iwiv/iU82E/Rt31VhQ5lkU5nin40A6wGFv9cDIignh4/loM7QIpXWlGOoryPPYBBWk4SEpV9ZYjO0wpPHa/y3FcQvQvEuO0QoMwyPDDJ0/y53fu/nm+tdtF7+mLNvNqE9mEHC3jikusYaOn/qQZ19FJPpIfLiAn+ZTTwY+YO+n3tp+7SN8xfOcbq+lnJDIVWFOl4t0REWHcMzEeGERz3LrvCniY4OIzZmF9LphhJyTuiEbhqNZ6q49F4jb9SWkpd9gONZai6fK6b7IyM9V+rpaX2drjP5DLbUoN6TQFhEBDExUQIWSWRkOJERYfwP6VZ69Iu+D2UAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/c66174da24900c8d60742ec8b40e053d/fcda8/Pasted%20image%2020230718172936.png&quot;
        srcset=&quot;/static/c66174da24900c8d60742ec8b40e053d/12f09/Pasted%20image%2020230718172936.png 148w,
/static/c66174da24900c8d60742ec8b40e053d/e4a3f/Pasted%20image%2020230718172936.png 295w,
/static/c66174da24900c8d60742ec8b40e053d/fcda8/Pasted%20image%2020230718172936.png 590w,
/static/c66174da24900c8d60742ec8b40e053d/efc66/Pasted%20image%2020230718172936.png 885w,
/static/c66174da24900c8d60742ec8b40e053d/c83ae/Pasted%20image%2020230718172936.png 1180w,
/static/c66174da24900c8d60742ec8b40e053d/21e8f/Pasted%20image%2020230718172936.png 1684w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;드디어 발표 차례가 왔고 ZOOM의 화면 공유를 누르면서 발표를 시작했다. 발표를 끝나고 다른 나라의 참가하시는 분들의 질문까지 잘 답변해서 성공적으로 마무리를 했다. 발표가 끝나고 손이 벌벌떨렸는데.. 아직까지 생각하면 어떻게 했는지 의문이다. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/952d52d1de7278047d444e826594ba0f/0faf1/Pasted%20image%2020230718173439.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACO0lEQVQozy2QWU/bUBCFDWQlOE5s33hL7Njxkg0IS2lE2VTS9qWlregiQEilVdv//wu+TlwejuZo7syZc64Wug5pOGCepuzmGa+O9nn/esnj5yv+3q/4+W3F77s3/Llb8ev7NT9uL7m5PmGvKGQ+JY9CYt8l6Nn0Om00X9mErluKTkYxi0nOcjHj3fkBDzenPH254PHTOQ8fz3i6PeP+w5LV6T6TOKF4Fhv0FK7ZxdJ30JTRwbUsIs9jFPbJhyHjeEgRx4IR0zRnnhVlzYcjsigWV8NnZx4DR+HbFsow6Gxvo1m6TqAsPNvGV6p0GweBOA5FICqFx2skyf8j0sujqBSL3B6BbeJ0OuKuRbvZQJvEDl/fzkkHDn2Jvx5K+uK275MEvvQDiReJaFRGDF1fXDlioidCXVR77ayFXm8I6mi9rs5+EXAyj1juDTmeRlwvc86PUi6OM65ernkm/zYp614WMkvlv5NAEniSRsl3WXLAoFmtogVGi4OhzdDUSSyDYbdd1lR1GAlyx5RqUng2mWMx7zuMhRciMg3sciZV670djK1NtGMRu70sSN0OfrtFbLcFBokMZk5XFk1yWR7L8ti3Zc4kE6TyZjUaGJUKOxubNDUNa2sDLbV1lrshL2YhC4l+OB1wNOkzG7kcSl0Uftk/lv6aHwhfzkMOxwFFqIjdLn0xMXAMVL2C5rXqzL0OM0Gu2sz8LqG+jSWXVa2GXa3gNmr4zTpqzetVvEYVv+zVSu6IUK9Wwaxs8g9QiRImcOD0ngAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/952d52d1de7278047d444e826594ba0f/fcda8/Pasted%20image%2020230718173439.png&quot;
        srcset=&quot;/static/952d52d1de7278047d444e826594ba0f/12f09/Pasted%20image%2020230718173439.png 148w,
/static/952d52d1de7278047d444e826594ba0f/e4a3f/Pasted%20image%2020230718173439.png 295w,
/static/952d52d1de7278047d444e826594ba0f/fcda8/Pasted%20image%2020230718173439.png 590w,
/static/952d52d1de7278047d444e826594ba0f/efc66/Pasted%20image%2020230718173439.png 885w,
/static/952d52d1de7278047d444e826594ba0f/c83ae/Pasted%20image%2020230718173439.png 1180w,
/static/952d52d1de7278047d444e826594ba0f/0faf1/Pasted%20image%2020230718173439.png 1956w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;결과는 대상을 수상 했고. 결과를 보자마자 지도해주신 교수님과 팀원 들에게 전화로 감사한 말을 전했다. 프로젝트를 여기까지 준비한 과정이 짧지 않고 2학기 동안 진행 했었고 이 과정 속에는 팀장으로 미흡한 부분도 있었고 발표를 위해 프로젝트를 밤세 준비하며 많은 신경을 쓰다보니 스트레스도 많이 받았었다 하지만 좋은 결과로 보답을 받아 좋았다.&lt;/p&gt;
&lt;h2 id=&quot;한국전자통신연구원-인턴-수행&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%9C%EA%B5%AD%EC%A0%84%EC%9E%90%ED%86%B5%EC%8B%A0%EC%97%B0%EA%B5%AC%EC%9B%90-%EC%9D%B8%ED%84%B4-%EC%88%98%ED%96%89&quot; aria-label=&quot;한국전자통신연구원 인턴 수행 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;한국전자통신연구원 인턴 수행&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d8566032398bdb79d572cc2829530496/086f9/IMG_1061.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 42.567567567567565%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHvvO4ID//EABcQAAMBAAAAAAAAAAAAAAAAAAABIEH/2gAIAQEAAQUCUYf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAEBAAIDAAAAAAAAAAAAAAAAASExQVFx/9oACAEBAAE/Ice09Wpyhdv/2gAMAwEAAgADAAAAEOfP/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QJ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAIDAQAAAAAAAAAAAAAAAAERADFxEP/aAAgBAQABPxAiwDB6oSbgDuW12v/Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/d8566032398bdb79d572cc2829530496/1c72d/IMG_1061.jpg&quot;
        srcset=&quot;/static/d8566032398bdb79d572cc2829530496/a80bd/IMG_1061.jpg 148w,
/static/d8566032398bdb79d572cc2829530496/1c91a/IMG_1061.jpg 295w,
/static/d8566032398bdb79d572cc2829530496/1c72d/IMG_1061.jpg 590w,
/static/d8566032398bdb79d572cc2829530496/a8a14/IMG_1061.jpg 885w,
/static/d8566032398bdb79d572cc2829530496/086f9/IMG_1061.jpg 973w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;12월달에 한국전자통신연구원 (ETRI)의 동계 연구연수생 지원했었다. 한국전자통신연구원에 지원하게 된 계기는 같은 학부 연구실의 졸업하신 선배가 연구실에 계셨고 이전에 많은 조언과 관심을 주셨는데 백엔드 개발을 처음 시작 했을 때 많은 도움을 받았었다 그래서 선배가 계신 연구실에 인턴으로 같이 근무를 해보고 싶었고 매우 운이 좋게 합격하게 되어 근무하게 되었다.&lt;/p&gt;
&lt;p&gt;김해가 아닌 대전에서 2달 자취를 하면서 첫 회사 생활을 하게 되었다. 같은 대학교 형 두분과도 같이 합격하게 되어서 혼자가 아닌 셋이서 함께 출근과 퇴근 그리고 헬스... 하게 되어서 하루하루가 매우 알차고 바쁘게 지냈다.&lt;/p&gt;
&lt;p&gt;업무는 첫주 때 부터 연구실에서 적용하던 인증 서비스가 구 버전이라 최신 버전을 조사해서 한번 어떤지 써보고 발표를 해달라고 하셔서 첫날에 맥을 세팅하고 바로 업무를 시작했다.. 그렇게 하루에 업무 시간내내 코딩과 자료 조사를 하게 되었는데 업무의 강도는 연구실과 부서마다 다르겠지만 나에겐 괜찮았다. ETRI 인턴을 하기 전에 관련 분야에 대해 이미 공부를 했었기 때문에 괜찮았다 그래서 하루하루 코딩의 재미를 느끼고 평소에는 공식 문서도 깊게 안읽었지만 진짜 공식문서를 꿈에서 까지 상상할 정도로 읽었다.&lt;/p&gt;
&lt;p&gt;같이온 형들은 자기 관련 관심 전공과 다른 업무를 하고 있거나 하루종일 논문을 읽고 분석하고 계셨는데 만약 ETRI 인턴에 대해 관심이 있는 분이라면 논문에 대해서 평소 관심있거나 자주 읽는다면 지원하는 연구실의 진행하는 연구 과제를 잘 보고 지원하기를 바란다 의미있는 2달을 보내고싶다면.&lt;/p&gt;
&lt;p&gt;결론은 ETRI 인턴 한번즘은 해보는 것을 추천한다. 나는 좋은 경험과 많은 성장을 했고 대학교에서 쉽게 못 느끼는 박사님들의 지식에 감탄하며 나도 저렇게 지식이 깊었으면 하며 의의를 두었다.&lt;/p&gt;
&lt;h2 id=&quot;artscope-플랫폼-사이트-개발&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#artscope-%ED%94%8C%EB%9E%AB%ED%8F%BC-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EA%B0%9C%EB%B0%9C&quot; aria-label=&quot;artscope 플랫폼 사이트 개발 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Artscope 플랫폼 사이트 개발&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/ef315b8aad0233900a7df95308f5668a/1.gif&quot; alt=&quot;Alt text&quot;&gt;&lt;/p&gt;
&lt;p&gt;22년도 여름방학때 부산 금정구 금샘미술관에 좋은 기회로 전시에 참가했다. 개발자가 미술관에 전시라니? 나의 작품은 아니고 부산시에서 활동하시는 작가님의 전시 작품을 위해 개발자로 참가했다. 관람하는 관객들의 모습을 카메라로 촬영해 다른 화면에 그 모습은 영상 이펙트를 씌워 실시간으로 화면에 보여주는 것인데. 작품과 관객이 상호작용하는 그런 것을 하자고 전시 전에 얘기를 나눴고 같이 개발자로 참가한 친구와 함께 얼굴 인식 프로그램과 인식한 사진을 서버로 전송해서 파일로 저장하는 프로그램을 개발했다. 위 움짤한 그때 전시한 작품의 모습이다. (오른쪽에는 관람객의 모습이 보이고 왼쪽엔 일정 시간 이후에 인식한 모습을 이펙트를 씌워 보여준다.)&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5e1ae62dc78ff4d6449e98d6d16df72a/eee07/Pasted%20image%2020230718175726.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 112.16216216216218%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFhUlEQVQ4y62VWUxc1x3GrxdUNW4VtepDn1q1SuVGbR/aSE0qp22cuA3qQy03VtKExHZk3LgkBKiNDXZswHhsYGCMCYbBMBuz3VmZfWUY8Awz4JWBwSyOiVJsExKnUROwo7z8cmYUKep7r/TT+R/pnk/fd+7/niPdubtCbmaOD5bv8v94pJWVVRZvLbEsBNfW1lhfX2d97RvWBA/WH7D64TIf3vs391fv8snHK/z3P6t89ulHPHzwKeuf3+ez+/f44vOPkN5bvM1MbrbI1PVpcjdmuHFtukixvpojLxLYDErMfU0ErV3EHL2kgwayIQO2I9WEVI3kL5lZvmpFWlpaYmFhocj8/Pw39UKhnmdxcZHbt5dwGZU4Lp4gJqtIWJVkA2rsLYdQPPYkExX1vJ+WuZ21IM3PzzExMcHU1BRzc3PkcrkiN2/eJJ/PMzk5yfT0DB6TEltPLVFzCzF9I2lbI+baMjS/eIbZ1+v5IG4gnzQgzc7OCsGsWDQtHC6QmxJRp3JFtwXRguANMfdaO7H3HSOkP0lUV8+w9jAe5V5OV/yTpGeIO+lBMt4epEziCqOBYTKJNMngKCFbjFQ8S164yiQzTN+YZiwwQk9bHYq6PbSfLKdDIHfX0dFwgBffep13vWESLjVJuxLJb4rQf2YQl8YjGMLS7cBjCDISGsPR78al9aBRmGk+Xklt9T6O1x7kSPV+ulqqUbUdpqKyjJdqjtJ94Syei4eRFq6Ok5ItzCQC3EzHyYfNXHdpmE36yEdtpC16guY4Qe8gtsFOPHIvXrmHoFNNWLiKePrx2rsZHuom6uxCmk5FSGubGNeeYtxyjtRAEyl9C+OmdsbtvUzK51jMTXI9G2PE3U8maiUzLHMpbiEatBDwWRgJy4T8MomQLCJ7XPQoT6PuUNCraqWvsw216izqrg56etXotFpuida5kgrg03Zg6mzE5hYugwNo5AGa+zR0aHR0GQxY7YNCMBTFYLFjtLkxWJ2YHZ5iPSi7iqNZkMpcZnLUR1jE1OmVOIMavAENfp9WrNXTrTFiMBuJBoxIv3nlOCVPv8F3dlTxSIHn3mbLc5VsefYtvru9gke27efHf3oDr8NAYtiEK6rHIwT9fp3YVwMRt5mQ3U7MZScTE4392J5WpGcOs6G0Hul5wZ+PIu2oFYgv9mwN0tNv8mjpIYZcJoajBlz+fnx+LX6vEHQbCdhl3CYXQ1YXl8JCcOubaqSdZyh5ScnG3a1ibKfkxTY27Gxm884mpNJjfP+FJlxOE4mwjiHvRXzeAfxuHQGHGb9sxznowW0pCIrIW4+IjXztPCXlosv3vcvLJzrZ845o0Jfb2fx3Me5S8L1X2vF4bUwmRLygloiIG/WK2iHjMTux6X1EhuykIwXBBjvSwX5KKjVsqh7k1+X1/LKsio0V/Wza341UpuIH5RfQGPpx6DrQ97UxIJr44vk2bFodPqtX9KOTdNRCSiD9XOFBqhI/9REbWw+1U1VzgB2l2/lR+Qk215jYeKCHH1ZpUZ5X0aNqRnnmHc61NnCmqR6DukO4spIKGwRGUkWHrX6kQyY2NHj5XdkeTlfu5B+7nuQnf9iOVC1e2NvNJpFgwCIT9sgEvA6BnUjQTWYswrWJBJfH41z5GmmrMijcyWxpcPD71/axe3cpzYpGNFYrNc7LHPVe41TwOlPz7/F+4excvMXdlRXmxGk0MpxgbGxMnFaTZLITjGeyQrCl4NDKt4/J/PTVt/nZtj+SvDZTvB/urH75P/fFw4cPWb5zr1hPZceo2/tX9OdOkEqnhfAoo6OjQlDhE3toZGOdg28VRJ//G7994VWeaDbyq5YhHj9p5SmFA1sgRiwSJi5cqU4d4+BfnuJfu7Zx4exxkskk8XicRCLBV0KM/lJbuvTYAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/5e1ae62dc78ff4d6449e98d6d16df72a/fcda8/Pasted%20image%2020230718175726.png&quot;
        srcset=&quot;/static/5e1ae62dc78ff4d6449e98d6d16df72a/12f09/Pasted%20image%2020230718175726.png 148w,
/static/5e1ae62dc78ff4d6449e98d6d16df72a/e4a3f/Pasted%20image%2020230718175726.png 295w,
/static/5e1ae62dc78ff4d6449e98d6d16df72a/fcda8/Pasted%20image%2020230718175726.png 590w,
/static/5e1ae62dc78ff4d6449e98d6d16df72a/efc66/Pasted%20image%2020230718175726.png 885w,
/static/5e1ae62dc78ff4d6449e98d6d16df72a/c83ae/Pasted%20image%2020230718175726.png 1180w,
/static/5e1ae62dc78ff4d6449e98d6d16df72a/eee07/Pasted%20image%2020230718175726.png 1628w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;올해는 작품 전시에 직접적으로 참가는 안하고 부산시 작가분들이나 예술을 좋아하는 일반인들이 작품을 전시하거나 공모를 할 수 있는 것을 한번 만들어 보자고 얘기를 나눴고 그 결과 Artscope라는 사이트를 만들었고 나는 백엔드 개발을 수행했다. &lt;/p&gt;
&lt;p&gt;Artscope의 백엔드 개발자로 개발하면서 사이트 특성상 작가분들의 영상 파일이나 이미지 파일이 대부분 해상도가 높고 용량이 크다는 요구사항이 있어서 AWS의 S3로 정적 파일 저장소를 구성하고 이미지나 영상 파일들을 빠르게 사이트에 뿌릴 수 있도록 AWS Cloudfront과 AWS Lambda를 통해서 이미지를 최적화 처리를 하는 시스템을 적용했다 그 결과 해상도가 높은 2K 이상의 이미지를 기존에 5초 이상 받아온 것을 0.5초 이하로 밀리세컨드 단위로 받아올 수 있도록 성능을 개선했다.
또한 모니터링과 로그에 대해서도 신경쓰게 되었는데. 로그를 한곳에 모아서 모니터링을 할 수 있도록 ELK 스택을 도입하게 되었고 운영중인 스프링 어플리케이션의 다양한 메트릭 수집과 추적을 위한 Naver의 Pinpoint도 도입해서 운용하고 있다. &lt;/p&gt;
&lt;p&gt;처음 사이트를 배포하게 되니 많은 사용자들이 찾아와 주셨는데. Artscope는 실제 미술이나 예술계에 활동하시는 작가분들이 자신의 전시 이력이나 관련 정보를 작성할 수 있는데. 사이트에서 하나하나 작품을 감상하다가 하단에 위치한 작가 프로필을 보다보면 부산시에 있는 작가 뿐만 아니라 해외에 전시를 하신 분들까지 사이트에 찾아 와서 자신의 작품을 올려주시니 감회가 새로웠다. Artscope는 평균적으로 WAU는 250명 정도였고 사이트에 평균 머무는 시간이 4분정도로 많은 관심을 가져주셨다. 사이트에 올라온 작품의 수도 약 150개 이상이 업로드 되었고 작가 정보를 입력해주신 분들은 약 40명 정도로 찾아와서 작가 정보를 기입하신 분들에게 대해 매우 감사하다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/dfe8ca0d5b891668c56f716491787b33/5faa8/Pasted%20image%2020230718180941.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 94.5945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACAklEQVQ4y5VUi3KCMBDk/7+urVMfqIC8QXmKKKBebw9DtVVHM3OTBJLN3u0mWhDGNNWXNJsbtK12hHY+n4e4nr/SND+IaGms6HM0obLc/ltwDf4s1FotXicElvOlRWma035/kKg52q67AX7W1H+trvfUtC01TUO7XU2bJKU0ywW84hJg4fF4HDadTqch7jJ8dOJ6k9LH11hK4XFZ9IVJhmnTdLak8XROKBXmK9u9BQSrLC8oL0rK81LG5bYixw14sUeeHzLrjGzHJ9cLKIzWEgDEurbtbgETXmytXDIsm0F8YQMQACoAz49kjP/qIJTkngu0JM0EQAUAbN4IoRAAQ6/YqkPvgQnDDddKLY7izbAJKSlQOAHfE2YFMSDSQ9tA1et0wBAHAATChFEsB3Vd99Q6Q8ooOMBsxxNWAO9T79MUhsI8EuE6Zndgi+EARNO00v+KwmkAxL+IATUDZolvOERMz5bBd2RgsU0QpuX0BC6139V1zxBMTFY4ulghitfCGD1sUfB13FaV3B4YHmVAYIy7X7HtCmaurq0GJuOJTpPZgnR+IAxzRaPvqaT8bpOUURdlZrDAHEq+8zDc+BBgMDcoA/RVoEcPhhgbxYeiCvDV9O6+h1lWCCDAIH/LL88QMu+t0cqL1MdThtgALwIYvagopk5ESZQD1sEFUA/Dte/+th+vpbgsrJ9k9AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/dfe8ca0d5b891668c56f716491787b33/fcda8/Pasted%20image%2020230718180941.png&quot;
        srcset=&quot;/static/dfe8ca0d5b891668c56f716491787b33/12f09/Pasted%20image%2020230718180941.png 148w,
/static/dfe8ca0d5b891668c56f716491787b33/e4a3f/Pasted%20image%2020230718180941.png 295w,
/static/dfe8ca0d5b891668c56f716491787b33/fcda8/Pasted%20image%2020230718180941.png 590w,
/static/dfe8ca0d5b891668c56f716491787b33/efc66/Pasted%20image%2020230718180941.png 885w,
/static/dfe8ca0d5b891668c56f716491787b33/c83ae/Pasted%20image%2020230718180941.png 1180w,
/static/dfe8ca0d5b891668c56f716491787b33/5faa8/Pasted%20image%2020230718180941.png 1444w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이용자들의 피드백을 수용할 수 있도록 설문조사도 만들었고 8명의 소중한 피드백을 주셨고 사이트를 현재까지 개선하고 있다. 사이트를 몇번 배포해 본적은 있지만 이렇게 오래 운영하고 있는건 처음이다. 좋은 기회로 올해도 이런 프로젝트를 진행하게 되어서 몹시 기쁘다. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEA//EABUBAQEAAAAAAAAAAAAAAAAAAAMC/9oADAMBAAIQAxAAAAG6fdDuQcYf/8QAGRAAAwADAAAAAAAAAAAAAAAAAAECEBEh/9oACAEBAAEFAnJco0Jj7j//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFn/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BJ//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAICAwAAAAAAAAAAAAAAAAARATEQIXH/2gAIAQEAAT8hgSEtX0hILcn/2gAMAwEAAgADAAAAEMwf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EMhJf//EABURAQEAAAAAAAAAAAAAAAAAABEA/9oACAECAQE/EGzf/8QAGxABAQEAAgMAAAAAAAAAAAAAAREAITFRcYH/2gAIAQEAAT8QSjQnY4jpY4GMwiAnhut7F0JUH5k3/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Alt text&quot;
        title=&quot;Alt text&quot;
        src=&quot;/static/02be733908a0ac3739a35c75b7188c99/1c72d/IMG_5895.jpg&quot;
        srcset=&quot;/static/02be733908a0ac3739a35c75b7188c99/a80bd/IMG_5895.jpg 148w,
/static/02be733908a0ac3739a35c75b7188c99/1c91a/IMG_5895.jpg 295w,
/static/02be733908a0ac3739a35c75b7188c99/1c72d/IMG_5895.jpg 590w,
/static/02be733908a0ac3739a35c75b7188c99/a8a14/IMG_5895.jpg 885w,
/static/02be733908a0ac3739a35c75b7188c99/fbd2c/IMG_5895.jpg 1180w,
/static/02be733908a0ac3739a35c75b7188c99/d2602/IMG_5895.jpg 4032w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;
Artscope는 실제 작가분들의 작품을 전시하거나 공모 받고 있고 (사이트에 작품을 업로드하게 되면 금샘미술관에 공모하겠는지 묻고 있다) 그 결과 7월 한달 동안 부산 금정구 금샘미술관에 실제 작품들이 전시하고 있다. 관심이 있는 분이라면 &lt;a href=&quot;https://artscope.kr&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://artscope.kr&lt;/a&gt; 를 찾아와 주시거나 부산에 거주하고 있다면 금샘미술관으로 가보시길!&lt;/p&gt;
&lt;h2 id=&quot;이제는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4%EC%A0%9C%EB%8A%94&quot; aria-label=&quot;이제는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이제는.&lt;/h2&gt;
&lt;p&gt;4학년으로 취업 준비를 하고 있다. 저번주에 진행한 2023 토스 SLASH 코딩 테스트를 봐었는데 알고리즘 문제와 서술형 문제에 생각보다 해맸고 좋은 결과를 받지 못했다. 토스라는 앱을 고등학교 처음 토스앱이 출시할 때 부터 사용하고 있고(그때 당시에 등록할 수 있는 은행이 별로 없던걸로 기억) 내 삶에 매우 편리한 부분을 제공해서 이 회사에 많은 관심을 가지고 있고 꼭 백엔드 개발자로 들어가고 싶다는 생각이 예전부터 있었다. 이번 코테를 통해서 아직 내가 많이 부족하다는 것을 느꼈고 와중에 번아웃 + 감기가 오게 되서 그런지 코테 이후론 개발이나 공부를 안하고 집에서 휴식을 취하고 있었다. 이제는 내 현재를 잘 파악하고 정비해서 천천히라도 내가 꿈꾸는 회사에 도전하고 다시 번아웃을 이기고 달려보려고 한다. 글을 잘 못쓰지만 마지막까지 읽어주신 분들에게 감사하며 글을 마친다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[K8S] ArgoCD Notification을 이용해 Discord Webhook으로 알림을 보내보자]]></title><description><![CDATA[개요 ArgoCD에서는 알림 기능을 제공하는데 해당 기능을 사용하면 ArgoCD에서 사용되는 Application(예: Argo를 통해 배포한 k8s object)을 지속적으로 모니터링하고 상태의 변경 사항을 알릴 수 있다. ArgoCD에서는 Tri…]]></description><link>https://hoon9901.github.io/argocd-notification/</link><guid isPermaLink="false">https://hoon9901.github.io/argocd-notification/</guid><pubDate>Wed, 24 May 2023 12:09:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 530px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2467631c3503542f429a304ae2cb56ea/b6a9b/2023-05-24-12-30-01.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQoz3WS3ZKaQBCFff+7PEBu8x6pJGtla1fWReUfFBAUFQaZAc3NSU8DG0wqF18duqc53T0wWzy/45Dtcb5UKE4XVOIKqdqBbqBFI/tYfeQ6zk1RbYfZl0+fsZh/g+X4MFcbJGmG+irZ+FIKaiRQVjWqumE9nUturp913RRtOls7CVzPh+NqAmwsB5btwqbY80PYjseNzJVFccTn640NL4i46bVRj4bznyYWhkEseWVBk4zoYr1afijw/cccL68GGa+5Tr+sTXTNaMqG5jqiCT1k+ZETY8FYpFWvF4RbpPucG435cbIHwxfDoTUsxElGBy3EX/fSo6i44/OaX1b/nH8YLk2aLo1xKgr6ggpKDtBzqyYq5cBjXtNMJ/z67OPJcPH0HmF7lIgODRPkDZx9g/DQq47HMy/rY5fUJy1Kvfa4sq/wltywjDu87SSMrcRr1BMXCsdSse7PEvmFIE1PEhlpQqrzpejvkQ1Xdoog2iHcpvQr7OCHMdwg5jiOEyYK6RepBKTU60lIPc1Er7SuqHvTmajpHlrFxXK4O43UdyP/0N3u/+U2cL//wm9geDmtueksCAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;2023 05 24 12 30 01&quot;
        title=&quot;2023 05 24 12 30 01&quot;
        src=&quot;/static/2467631c3503542f429a304ae2cb56ea/b6a9b/2023-05-24-12-30-01.png&quot;
        srcset=&quot;/static/2467631c3503542f429a304ae2cb56ea/12f09/2023-05-24-12-30-01.png 148w,
/static/2467631c3503542f429a304ae2cb56ea/e4a3f/2023-05-24-12-30-01.png 295w,
/static/2467631c3503542f429a304ae2cb56ea/b6a9b/2023-05-24-12-30-01.png 530w&quot;
        sizes=&quot;(max-width: 530px) 100vw, 530px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h1 id=&quot;개요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EC%9A%94&quot; aria-label=&quot;개요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개요&lt;/h1&gt;
&lt;p&gt;ArgoCD에서는 알림 기능을 제공하는데 해당 기능을 사용하면 ArgoCD에서 사용되는 Application(예: Argo를 통해 배포한 k8s object)을 지속적으로 모니터링하고 상태의 변경 사항을 알릴 수 있다. ArgoCD에서는 Trigger와 Template이라는 매커니즘을 사용해 알림을 보내야하는 시기를 구성할 수 있다. &lt;a href=&quot;https://argo-cd.readthedocs.io/en/release-2.6/operator-manual/notifications/catalog/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식문서&lt;/a&gt;에서 참고하면 이런 Trigger와 Template을 이용한 예제가 있으니 참고하거나 사용자가 직접 알림 매커니즘을 구성해서 사용할 수 있다.&lt;/p&gt;
&lt;p&gt;제공하는 여러 서비스들에 알림을 보낼 수 있는데 자주 쓰는거로는 이메일이나, 깃허브, 그라파나, 프로메테우스의 AlertManager, Slack 그리고 Webhook 이 있다.
이중에서 Webhook을 이용해서 ArgoCD의 배포 상태 변경에 대해 디스코드로 알림을 보내보자!&lt;/p&gt;
&lt;h1 id=&quot;get-started&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#get-started&quot; aria-label=&quot;get started permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Get Started&lt;/h1&gt;
&lt;p&gt;이 글에서 운영환경은 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;argocd v2.6.5&lt;/li&gt;
&lt;li&gt;argo-notifications-controller v2.6.5&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;argocd-notification-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#argocd-notification-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;argocd notification 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ArgoCD Notification 설정&lt;/h2&gt;
&lt;p&gt;우선 ArgoCD Notification Controller에 알려줘야할 쿠버네티스 시크릿을 다음과 같은 내용을 생성해서 적용한다.&lt;/p&gt;
&lt;h3 id=&quot;argo-notifications-secretyaml&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#argo-notifications-secretyaml&quot; aria-label=&quot;argo notifications secretyaml permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;argo-notifications-secret.yaml&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Secret
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; argocd&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;notifications&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;secret
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; argocd
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Opaque
&lt;span class=&quot;token key atrule&quot;&gt;stringData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;notifiers.yaml&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
    webhook:
    - name: discord-webhook
      url: &amp;lt;여기에 웹훅 URL 입력&gt;
      headers:
      - name: Content-Type
        value: application/json&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;argocd-notifications-secret&lt;/code&gt; 이라는 이름의 Secret 파일을 생성해준다
그 후 &lt;code class=&quot;language-text&quot;&gt;kubectl apply&lt;/code&gt;로 Object를 적용한다&lt;/p&gt;
&lt;h3 id=&quot;argocd-notifications-cmyaml&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#argocd-notifications-cmyaml&quot; aria-label=&quot;argocd notifications cmyaml permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;argocd-notifications-cm.yaml&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ConfigMap
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; argocd&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;notifications&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;cm
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; argocd
&lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;service.webhook.discord-webhook&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
    url: &amp;lt;여기에 윕훅 URL 입력&gt;
    headers:
    - name: Content-Type
      value: application/json&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 configmap을 작성하는데. &lt;code class=&quot;language-text&quot;&gt;service.webhook.&amp;lt;webhook-name&gt;&lt;/code&gt; 형식으 로 아까 작성한 Secret과 동일하게 작성해준다. 이 부분은 ArgoCD에 Webhook을 등록한다.&lt;/p&gt;
&lt;p&gt;그 다음 Notification의 Trigger를 설정해준다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;  &lt;span class=&quot;token key atrule&quot;&gt;trigger.sync-operation-change&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
    - when: app.status.operationState.phase in [&apos;Running&apos;, &apos;Succeeded&apos;, &apos;Error&apos;, &apos;Failed&apos;]
      send: [ discord-alert ]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;sync-operation-change&lt;/code&gt; 트리거에서 조건은 Application의 상태가 &lt;code class=&quot;language-text&quot;&gt;Running, Succeded, Error, Failed&lt;/code&gt; 로 설정했고 위와 같은 상태에 도달했을때 discord-alert라는 template을 통해 알림을 전송한다. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;  &lt;span class=&quot;token key atrule&quot;&gt;template.discord-alert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;
    webhook:
      discord-webhook:
        method: POST
        body: |
          {
            &quot;embeds&quot;: [
              {
                &quot;title:&quot;: &quot;ArgoCD Notification - {{ .app.metadata.name }}&quot;,
                &quot;description&quot;: &quot; **{{ .app.metadata.name }}** 의 상태가 **{{ .app.status.operationState.phase }}** 로 변경되었습니다.&quot;,
                &quot;color&quot;: &quot;{{ if eq .app.status.operationState.phase &quot;Running&quot; }} 1127128 {{end}} {{ if eq .app.status.operationState.phase &quot;Succeeded&quot; }} 3066993 {{end}} {{ if eq .app.status.operationState.phase &quot;Error&quot; }} 15158332 {{end}} {{ if eq .app.status.operationState.phase &quot;Failed&quot; }} 15158332 {{end}}&quot;
              }
            ]
          }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 template을 정의하는데 template의 이름은 discord-webhook이고 &lt;code class=&quot;language-text&quot;&gt;webhook: &amp;lt;wehbook-name&gt;&lt;/code&gt; 을 통해서 해당 Template의 service를 정의한다. discord에서 webhook 메시지를 작성하는 방법은 &lt;a href=&quot;https://discord.com/developers/docs/resources/webhook&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식문서&lt;/a&gt;를 참고하면 된다.&lt;/p&gt;
&lt;p&gt;이렇게 해서 &lt;code class=&quot;language-text&quot;&gt;argocd-notifications-cm&lt;/code&gt; 을 작성했다면 적용해주면 된다.
그 후 ArgoCD의 대시보드에 접속해서 원하는 애플리케이션을 다음과 같이 따라해서 알림을 적용하면 된다.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/15680cb4496739790e1d10691b4503d8/58213/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVQoz3VSCW7CMBDM/19Hq3CklBZRaAgpJMTxfUzXTkwlpFpazV6zl1woY6C1hjEW+TnnIKVECAHe+38lxiNPkyjrYIlXKDKEkDDWIswFOdlNe016JKXCMz5LzsHcvFDaTF0IoyO+7j7gWDdJz5Nkovd56pA2iVNNOfgrqJQC5xyegiH41G1kI263Dh1J3/UwdBYhxOQjO2Pf9+lkjwklFXx+TCocmxacGg1cgNEJRpKYG+1RTn4Xp45bzLyIhaKgPh0gvvbgJLo+gh0+cd1tgesFoT3DNd8P8W0NO2OO+UsNdz7BUX4hGYNbLaB3G6j3NexHBbOrMKxLsjfkr8BWrxiWL+CbEuJtiXu5SOj3W2jKMcRRVQlLvrSy1wpOSdCh6M9YsK7DT3NJuqe1k9+aCWc9EAbiRTR0/6h7+im/Arpr1TDtikQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;2&quot;
        title=&quot;2&quot;
        src=&quot;/static/15680cb4496739790e1d10691b4503d8/fcda8/2.png&quot;
        srcset=&quot;/static/15680cb4496739790e1d10691b4503d8/12f09/2.png 148w,
/static/15680cb4496739790e1d10691b4503d8/e4a3f/2.png 295w,
/static/15680cb4496739790e1d10691b4503d8/fcda8/2.png 590w,
/static/15680cb4496739790e1d10691b4503d8/efc66/2.png 885w,
/static/15680cb4496739790e1d10691b4503d8/58213/2.png 902w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이미 생성된 애플리케이션이나 새로 생성할 애플리케이션에 Notification Subscriptions을 적용하면 된다. &lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;notification.argoproj.io/&amp;lt;trigger-name&gt;.&amp;lt;service-name&gt;= &quot;&quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;이렇게 하여 디스코드로 웹훅 알림을 전송하는 설정은 끝났다 이제 확인을 해보자&lt;/p&gt;
&lt;h2 id=&quot;notification-result&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#notification-result&quot; aria-label=&quot;notification result permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Notification Result&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 467px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3d3bd168b9bcf53725ced936d2e831cb/85ff8/2023-05-24-12-32-44.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 40.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVQoz22SCW6DQAxFc+qepmepeoAogZCVAllIOuzrQAJh5tcMBKlqQV+2bOt5gZmUEgBJ2f8eMXld1yEIQjDPB2MeypIPFUJMmvXAIH2ibQXSJEEURYjjmBTCvcbwQ4HHo0ZVk6oKRVGCc65gTdMooByH6e3MYS3e3n18GgUsZwtdN2DbDsnEUjvCOlKjjMBBhCzL/8wvR1DXiQHI7wIfixpmWMIqr7gcb7BPZ5zO5Lsu6YL9wcKXdYTtnHAwbWx2B+xNC+vtHtudCdNykOWlajB7dWrotdMbvq8eThcX1xujlRmCMEEYxaRExS4u1TAfcZJRLobnB2Qj8KoegK/9Sy7guBXu95r8GkVZ0Z0q5AVHkuZKKsaHWBSnKpbTZD1MCPkbmBUScz3Cer3CfKFDNzbQVxu1orHeqfXmCw0LbaViS83Aimr6lZkXTB9mAjatJOhTnbmjbmJUf+yXL+SQUzE55ulXeT67CfgDpJlfwrMIPg8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;2023 05 24 12 32 44&quot;
        title=&quot;2023 05 24 12 32 44&quot;
        src=&quot;/static/3d3bd168b9bcf53725ced936d2e831cb/85ff8/2023-05-24-12-32-44.png&quot;
        srcset=&quot;/static/3d3bd168b9bcf53725ced936d2e831cb/12f09/2023-05-24-12-32-44.png 148w,
/static/3d3bd168b9bcf53725ced936d2e831cb/e4a3f/2023-05-24-12-32-44.png 295w,
/static/3d3bd168b9bcf53725ced936d2e831cb/85ff8/2023-05-24-12-32-44.png 467w&quot;
        sizes=&quot;(max-width: 467px) 100vw, 467px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
ArgoCD로 배포된 애플리케이션 상태가 변경되면 알림이 전송되는데 &lt;code class=&quot;language-text&quot;&gt;Sync&lt;/code&gt;  버튼을 눌러 강제로 상태 변경을 일으키면 위와 같이 알림이 전송된다.&lt;/p&gt;
&lt;p&gt;간단하게 Discord로 알림을 전송하는 방법을 알아봤고 ArgoCD의 애플리케이션 상태를 자세히 분기해 알림을 적용하고 싶다면 &lt;a href=&quot;https://argo-cd.readthedocs.io/en/release-2.6/operator-manual/notifications/catalog/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식문서&lt;/a&gt;를 참조하면 좋을 것 같다. 그리고 Template을 작성할때 &lt;code class=&quot;language-text&quot;&gt;{{ ... }}&lt;/code&gt; 로 Kubernetes 애플리케이션에 대한 내부 속성들을 가져왔는데 이러한 속성들을 사용하는 방법에 대해서 궁금하면 &lt;a href=&quot;https://kubernetes.io/ko/docs/reference/kubectl/jsonpath/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;K8S JSONPATH&lt;/a&gt; 를 참고하면 된다.!&lt;/p&gt;
&lt;h1 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://argo-cd.readthedocs.io/en/release-2.6/operator-manual/notifications/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://argo-cd.readthedocs.io/en/release-2.6/operator-manual/notifications/&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[Spring] 간단한 이미지 업로드 및 정적 리소스를 통한 이미지 조회를 구현해보자.]]></title><description><![CDATA[필자가 진행하는 토이 프로젝트 냥피스에서는 이미지를 업로드 하는 기능과 이미지 조회 기능을 제공한다.
해당 기능을 구현하기 위해서 도움이 될만한 내용이 있으므로 이 기능을 구현하기 위한 분들은 읽어보면 좋을 것이다. Get Started 1. 이미지…]]></description><link>https://hoon9901.github.io/image-upload-view/</link><guid isPermaLink="false">https://hoon9901.github.io/image-upload-view/</guid><pubDate>Tue, 02 May 2023 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;필자가 진행하는 토이 프로젝트 냥피스에서는 이미지를 업로드 하는 기능과 이미지 조회 기능을 제공한다.
해당 기능을 구현하기 위해서 도움이 될만한 내용이 있으므로 이 기능을 구현하기 위한 분들은 읽어보면 좋을 것이다.&lt;/p&gt;
&lt;h1 id=&quot;get-started&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#get-started&quot; aria-label=&quot;get started permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Get Started&lt;/h1&gt;
&lt;h2 id=&quot;1-이미지-업로드-구현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%A1%9C%EB%93%9C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;1 이미지 업로드 구현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 이미지 업로드 구현하기&lt;/h2&gt;
&lt;p&gt;만약에 글을 생성할때 이미지 파일과 같이 단일 API로 처리할 수 있다. 이러한 요구사항은
이미지 업로드 시에 MultiPartFile 뿐만 아니라 DTO도 함께 처리할 수 있도록 코드를 작성하면된다
다음 내용들은 이러한 요구사항을 토대로 작성했다.&lt;/p&gt;
&lt;h3 id=&quot;11-multipart-config-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-multipart-config-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;11 multipart config 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.1 MultiPart Config 설정&lt;/h3&gt;
&lt;p&gt;우선 MultiPartFile에 대해 최대 사이즈 설정을 해준다.
이미지 파일을 업로드하기 때문에 기본값보다 높은 용량으로 제한해준다.
다음과 같이 설정을 추가한다. (&lt;a href=&quot;https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/autoconfigure/web/servlet/MultipartProperties.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;MultipartProperties&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;  &lt;span class=&quot;token key atrule&quot;&gt;spring&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	  &lt;span class=&quot;token key atrule&quot;&gt;servlet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	    &lt;span class=&quot;token key atrule&quot;&gt;multipart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
	      &lt;span class=&quot;token key atrule&quot;&gt;max-file-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10MB
	      &lt;span class=&quot;token key atrule&quot;&gt;max-request-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10MB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;max-file-size: 업로드된 파일에 허용되는 최대 크기를 지정. (기본값은 1MB)&lt;/li&gt;
&lt;li&gt;max-request-size: multipart/form-data 요청에 허용되는 최대 크기를 지정. (기본값은 10MB)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그외 MultiPart 업로드에 대한 설정이 있다. 기본적으로 Multipart 기능이 활성화 (&lt;code class=&quot;language-text&quot;&gt;spring.servlet.multipart.enabled : true&lt;/code&gt;) 되어있다.
업로드된 파일의 임시 저장 공간을 설정할 수 있는 설정도 있다. (multipart.location) 추가적으로 관리가 필요하면 해당 경로도 지정하면 좋다. 임시적으로 저장되는 경로라 요청이 처리 된 후에는 자동으로 파일이 삭제된다.&lt;/p&gt;
&lt;h3 id=&quot;12-upload-controller&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-upload-controller&quot; aria-label=&quot;12 upload controller permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2 Upload Controller&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;    &lt;span class=&quot;token annotation punctuation&quot;&gt;@PostMapping&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;consumes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MediaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;MULTIPART_FORM_DATA_VALUE&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;upload&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestPart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;dto&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; dto&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token annotation punctuation&quot;&gt;@RequestPart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MultipartFile&lt;/span&gt; image&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// 확장자 추출&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; originalFilename &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOriginalFilename&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; originalFilename&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;lastIndexOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; ext &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; originalFilename&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;index &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toLowerCase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;


        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;ext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;jpg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;이미지 파일만 업로드 가능합니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpStatus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;BAD_REQUEST&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; savePath &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;./images/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; storeFileName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;randomUUID&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; ext&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LocalDateTime&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DateTimeFormatter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ofPattern&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;yyyy-MM-dd&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; 
            &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; key &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; savePath &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; storeFileName&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token class-name&quot;&gt;File&lt;/span&gt; temp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;savePath &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;temp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                temp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;mkdirs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;token class-name&quot;&gt;FileOutputStream&lt;/span&gt; fileOutputStream &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FileOutputStream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            fileOutputStream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            fileOutputStream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

            dto&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setImageUrl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/images/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; storeFileName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;IOException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResponseEntity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;이미지 저장에 실패했습니다.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpStatus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;INTERNAL_SERVER_ERROR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;MultipartFile에 대해 확장자 유효성 검증을 처리하고 파일 저장을 하는 로직이 있다. 메서드 파라미터를 보면은 이미지 파일 뿐만 아니라 DTO 객체도 받아오는데. MultiPartFile과 JSON 요청을 같이 처리할려면  &lt;code class=&quot;language-text&quot;&gt;@ReqeustPart&lt;/code&gt; (@RequestBody가 아니다!)로 DTO를 받아야한다. 그렇지 않으면 스프링에서 예외가 발생한다. MultiPartFile로 DTO를 받고 해당 DTO는 요청시에 Content-Type을 application/json으로 지정하면 정상적으로 스프링에서 처리된다. 추가적으로 유효성 검증을 할때 파일의 위변조까지 체크할려면 추가적으로 &lt;a href=&quot;https://tika.apache.org&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Apache Tika 라이브러리&lt;/a&gt;를 이용하면 된다.&lt;/p&gt;
&lt;p&gt;이미지가 저장되는 경로는 프로젝트 경로의 &lt;code class=&quot;language-text&quot;&gt;images/2023-05-01/&lt;/code&gt; 형식의 폴더로 저장되고 저장되는 파일명은 중복성을 고려하여 UUID를 이용해서 저장된다. 따라서 파일이 업로드 되면 다음과 같이 저장되는 모습이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;./
├── README.md
├── build/
├── gradle/
├── gradlew
├── gradlew.bat
├── images
│   └── &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-05-01
│       ├── 0e04033c-c69b-4840-a17d-8052fb32653e.jpeg
│       ├── 27fe8ce7-8bca-4642-8f0d-756fb0a4e1a2.jpeg
│       ├── 34d274ca-6602-4305-979d-f28cdbdf8a91.jpeg
│       ├── 70558e10-d795-4358-b443-07e6fc469ee2.jpeg
│       ├── 88c6b931-b000-45c6-a5fb-ace650b54cb7.jpeg
│       ├── 9452b9c8-3a09-4fb1-9052-231945701526.jpeg
│       ├── 9572aa83-982c-4a45-8e9d-1164d1b375a0.jpeg
│       ├── 97c0f0b6-e601-40ae-808f-1f92ec94974b.jpeg
│       ├── d83dbdc6-ee63-49f4-b8e5-73c8049d069a.jpeg
│       ├── ec24b9f6-c57e-4935-8e0c-1d27d08daee5.jpeg
│       ├── fae23d62-57ec-4a93-9a96-cd7068c93dc7.jpeg
│       └── ffa7a8bf-f984-4c08-9cb1-de66655ae81f.jpeg
├── settings.gradle
└── src
    ├── main
    │   ├── &lt;span class=&quot;token function&quot;&gt;java&lt;/span&gt;
    │   └── resources
    └── &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt;
        └── &lt;span class=&quot;token function&quot;&gt;java&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;스프링을 jar 파일로 실행해서 기능을 수행한다면 jar 파일이 위치한 경로에서 저장된다.&lt;/p&gt;
&lt;h3 id=&quot;13-이미지-업로드-api&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%A1%9C%EB%93%9C-api&quot; aria-label=&quot;13 이미지 업로드 api permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3 이미지 업로드 API&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b85f153c1b21d99e0d20273c2099679f/f4b77/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 77.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVQ4y6VTSW4VMRD18bgQB0DiGFwA1uzCjk0gApJI6BMhhihRyO/ZPXloux/1nDgTUfQlLD1Vd7nquUblvYdzDlprDMOAXQ7ti6LAOI5YQhDNCoQe8ANU0zTo2haTXLYi+V/XNaqqSpKPzPOMaZpuQCLqCWdmPH874NmrDi/2Rig9ioE4zH4Rwg5lXaEoS1QiSUqnTMLIrLX3sHiHN0cWL99NeH1oocYv+9CHH2GODrAsC5YY4EadDFfJJMYIloXY5Sj38wR6c4zw+/uVZr29JAkfyWeVF3gdf53Aip//+hkY5PH1qq5eslR/tgU6aQhPpIOAUVEaYxLpeq0nUlN+fEPxaR/Nh/eIQhhFx/RJqjabDbaXl5Kiv43i2pG1Y5NyswjqnERtpO7scLxjT6mY0sMoMnLKOeoceRCikMYF//iox4j+B+qpjj2s3W5dlkIyfKbGbxf8o2PC+8kZmVdCZnBxMPKf5zHzqPLi/GYjdK/R6i59swE0zAPNbSFJBh+23qWHaceJSIS671HKRlBBzOwiCUTSkOQ5gqdKQ7I0NiyP5zZwn7dbdD3HIu5cs7v1TRFylnxcYWV/+9NT1E2Hs3LCRT2hHR2q3qLUBs1gUct3lu3g0n0I8V4D/wK+6Y/sxgfh6wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;1&quot;
        title=&quot;1&quot;
        src=&quot;/static/b85f153c1b21d99e0d20273c2099679f/fcda8/1.png&quot;
        srcset=&quot;/static/b85f153c1b21d99e0d20273c2099679f/12f09/1.png 148w,
/static/b85f153c1b21d99e0d20273c2099679f/e4a3f/1.png 295w,
/static/b85f153c1b21d99e0d20273c2099679f/fcda8/1.png 590w,
/static/b85f153c1b21d99e0d20273c2099679f/f4b77/1.png 770w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
위와 같이 이미지 업로드 API를 호출한 모습이다. 이미지 뿐만아니라 추가적인 JSON 형식의 요청도 처리하는 API 이다.
이러한 API (Form-data에 json 형식의 dto와 image를 사용하는 것)를 사용하는 Frontend 에서는 다음 코드를 참고하여 사용하면 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// axios를 이용한 api 호출 코드&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; axios &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;axios&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; FormData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;form-data&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; fs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;fs&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FormData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;dto&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;{\n  &quot;description&quot;: &quot;string&quot;,\n  &quot;name&quot;: &quot;string&quot;,\n  &quot;prize&quot;: 1000\n}&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token literal-property property&quot;&gt;contentType&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;application/json&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;image&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createReadStream&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;BAE171ED-8C6A-4D86-B855-79E26B3D2FD5.jpeg&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;post&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;maxBodyLength&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;http://localhost:8080/api/wanted&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
    &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getHeaders&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; data
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

axios&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;2-이미지-조회-구현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A1%B0%ED%9A%8C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;2 이미지 조회 구현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 이미지 조회 구현하기&lt;/h2&gt;
&lt;p&gt;저장된 이미지를 조회하기 위해서 저장된 이미지 파일들을 정적 리소스로 관리하여 불러올 수 있도록 스프링 서버를 설정한다.&lt;/p&gt;
&lt;p&gt;위 이미지 업로드를 구현하면 이미지의 저장경로는 &lt;code class=&quot;language-text&quot;&gt;/images/2023-05-02/5a3f680c-6d6a-4de4-a283-6d6f12c221c1.jpeg&lt;/code&gt; 와 같이 구성되는데. 해당 경로 그대로 &lt;code class=&quot;language-text&quot;&gt;localhost:8080/images/2023-05-02/5a3f680c-6d6a-4de4-a283-6d6f12c221c1.jpeg&lt;/code&gt;  와 같이 호출할 수 있도록 기능을 구현하였다.
즉 스프링 정적 리소스를 조회할때 images/ 경로로 요청이 들어오면은 images/ 폴더 경로에 있는 리소스들을 조회할 수 있도록 설정한다.&lt;/p&gt;
&lt;h3 id=&quot;21-uploadpath-config-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-uploadpath-config-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;21 uploadpath config 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1 UploadPath Config 설정&lt;/h3&gt;
&lt;p&gt;application.yaml에 다음 설정을 추가한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;uploadPath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; file&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;./images/ &lt;span class=&quot;token comment&quot;&gt;# Linux, Mac 경로&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;만약에 윈도우 환경에서 서버를 실행한다면 다음과 같은 경로로 지정해야한다.
&lt;code class=&quot;language-text&quot;&gt;file:///./images/&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;file:///C:images/&lt;/code&gt; &lt;/p&gt;
&lt;h3 id=&quot;22-webmvcconfiguration&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-webmvcconfiguration&quot; aria-label=&quot;22 webmvcconfiguration permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2 WebMvcConfiguration&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;WebMvcConfig&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;WebMvcConfigurer&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;${uploadPath}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; uploadPath&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addResourceHandlers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ResourceHandlerRegistry&lt;/span&gt; registry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        registry
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addResourceHandler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/images/**&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addResourceLocations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uploadPath&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;WebMvcConfigurer&lt;/code&gt;를 구현한 &lt;code class=&quot;language-text&quot;&gt;@Configuration&lt;/code&gt; 클래스를 작성한다.
설정한 uploadPath 속성값을 불러오고 &lt;code class=&quot;language-text&quot;&gt;addResourceHandlers&lt;/code&gt; 메소드를 오버라이드하여 &lt;code class=&quot;language-text&quot;&gt;/images/**&lt;/code&gt; 경로의 요청들은 지정한 uploadPath로 리소스 파일을 찾을 수 있도록 코드를 작성했다.&lt;/p&gt;
&lt;p&gt;즉 &lt;a href=&quot;&quot;&gt;localhost:8080/images/2023-05-02/5a3f680c-6d6a-4de4-a283-6d6f12c221c1.jpeg&lt;/a&gt; 링크를 누르면 업로드된 이미지가 조회될 것이다. &lt;/p&gt;
&lt;p&gt;만약에 Spring Security를 사용하면 httpSecurity에서 &lt;code class=&quot;language-text&quot;&gt;/images/**&lt;/code&gt; 경로를 permitAll 처리를 해줘야한다.&lt;/p&gt;
&lt;h3 id=&quot;23-이미지-조회-결과&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#23-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A1%B0%ED%9A%8C-%EA%B2%B0%EA%B3%BC&quot; aria-label=&quot;23 이미지 조회 결과 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3 이미지 조회 결과&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/cbbb376d81bfeaeeee272a8a6a150aa3/108f8/0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADAklEQVQ4y32T60/TVxjHebc3y5Zs/8qyLCG+MfGNZstimNE5ooky5hKU2fgGBhOzsCJBmbOAFypdkeINuworhGGg4VJbCr1Kf21/l15p6/TNRMla+Oz8CjMxiif55nsueT7neZ6TU7W29oLn2yoUn5DO5Mhkc+RWC+TyBfKFItlcvrJezesqbp9t+d9Pn/Hi5Uv+eb5WUVV5Y4MNoVKpRDiq4Q0k8AVlFv2ycIVFXQFZ7G/JsxTH7Yux4Isz7V4hrubRR6lcrnCq2B76Qoon8YdkAhGV5ZCCP6wJ1/AFFAFX8S4nBCjGvC/BnFdmal4iphUr8ZubmxWv+n+iAxOySmQlhhRTiUqa8DQrK+ISkbHPHxfAGB4BfSSy9/g1XN4E8dQWcENwdNZrQEURoGgMVVFIahqZdI50qkA6rauIJoKj8SxhKUNIyuH2q8jpJ6+Ab2QoRSUiocekkkmSqg7MkkmlmJlw8MBmYXZyQlyooKaeEYhmmVuWkTPvAIaCy3g9buYeOkkqCaRImJEhC22NdRzZ/QmnavZg7e0mEo5VerckoGr26U49LBP0u/G4XdwyX6b/wlmM51o429JCq+Ekpw5+TlvDMX49b2TQYiUYiDDpHBcPqbxK6M2SgwssLUyxNOtk/55dfPzBR5z+7hgX25ppP32C800/0HqmkS/37qN2/xfcvNZDKvuOkvPxBWTfnzwYNHG8tpbdn1VztfNnHAO9DF/uYuS6iaaGE3z43vtUf1qNfXiI7OpOJZdL/JubR1u0c6PvN3ovduAYvsn0qB374AD3bvQxNjSA3TaMoaGRn5p/pL+vt/KQby15fX0dQ2M93e0tWPuvMfaHHdfkX9isNozGbjo7uui/Ymb0vgPn2Di/my1cvzqAz+t9O1D/et+Ixh89sJfROzbmXbPcvX2P1tZfaDjZTFNzO8YOE9YhOw9nvNy568B0ycSj2ZmdgbdM5zAbDUxPjHGlp4f6b7/nQM0Rvqo5yuHDx/n6UB119QbMlhGc4zNc6urE7Zp6DfgfybCu/09L0U8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;0&quot;
        title=&quot;0&quot;
        src=&quot;/static/cbbb376d81bfeaeeee272a8a6a150aa3/fcda8/0.png&quot;
        srcset=&quot;/static/cbbb376d81bfeaeeee272a8a6a150aa3/12f09/0.png 148w,
/static/cbbb376d81bfeaeeee272a8a6a150aa3/e4a3f/0.png 295w,
/static/cbbb376d81bfeaeeee272a8a6a150aa3/fcda8/0.png 590w,
/static/cbbb376d81bfeaeeee272a8a6a150aa3/108f8/0.png 777w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이미지 업로드와 조회를 간단하게 구현해봤다. 이러한 기능들을 실제 배포를 위해서 구현한다면 이미지의 특성상 요청 크기가 매우 무겁기 때문에 미들웨어로 CDN과 같은 캐싱 서버를 둬서 리소스를 캐싱해서 제공하거나, 이미지의 크기가 요즘은 4K 이상은 넘기는 경우가 있으니 클라이언트에 보낼때 이미지 리사이징 기능을 적용하는 방법들을 고안해야한다....! &lt;/p&gt;
&lt;h1 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://velog.io/@orol116/Spring-%EC%9D%B4%EB%AF%B8%EC%A7%80%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://velog.io/@orol116/Spring-이미지파일-업로드&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://gilssang97.tistory.com/43&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://gilssang97.tistory.com/43&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://creampuffy.tistory.com/119&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://creampuffy.tistory.com/119&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://velog.io/@nestour95/Spring-boot-%EC%A0%95%EC%A0%81-%EB%A6%AC%EC%86%8C%EC%8A%A4%EB%A5%BC-%EC%99%B8%EB%B6%80-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC%EB%A1%9C-%EB%B6%80%ED%84%B0-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://velog.io/@nestour95/Spring-boot-정적-리소스를-외부-디렉토리로-부터-불러오기&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[AWS] Lambda@Edge를 통해 이미지 리사이징을 해서 웹 성능 개선을 해보자]]></title><description><![CDATA[AWS - S3 리소스를 CloudFront로 캐싱하자 이어서 S3 이미지 리사이징 동작 순서 클라이언트에서  요청을 보냄. CDN에서 w, h, f, q 쿼리 파라미터가 붙어있으면  해당 S3 Object(이미지)가 CDN에 캐싱이 되어있으면 해당…]]></description><link>https://hoon9901.github.io/aws-s3-image-resize/</link><guid isPermaLink="false">https://hoon9901.github.io/aws-s3-image-resize/</guid><pubDate>Wed, 12 Apr 2023 23:20:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://hoon9901.github.io/aws-s3-cloudfront/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS - S3 리소스를 CloudFront로 캐싱하자&lt;/a&gt; 이어서&lt;/p&gt;
&lt;h2 id=&quot;s3-이미지-리사이징-동작-순서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#s3-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95-%EB%8F%99%EC%9E%91-%EC%88%9C%EC%84%9C&quot; aria-label=&quot;s3 이미지 리사이징 동작 순서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;S3 이미지 리사이징 동작 순서&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;클라이언트에서 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;GET /image-url?w=100&amp;amp;h=100&amp;amp;f=webp&amp;amp;q=80&lt;/code&gt;&lt;/strong&gt; 요청을 보냄.&lt;/li&gt;
&lt;li&gt;CDN에서 w, h, f, q 쿼리 파라미터가 붙어있으면 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Lambda 함수를 트리거&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;해당 S3 Object(이미지)가 CDN에 캐싱이 되어있으면 해당 이미지를 사용하고, 없다면 S3에서 가져옴.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;Sharp&lt;/code&gt;&lt;/strong&gt; 모듈을 사용하여 &lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;w, h, f, q&lt;/code&gt;&lt;/strong&gt; 인자를 통해 원하는 사이즈와 포맷, 품질로 이미지 리사이징&lt;/li&gt;
&lt;li&gt;Base64 형식으로 인코딩하여 클라이언트에게 응답을 리턴&lt;/li&gt;
&lt;li&gt;클라이언트는 응답을 읽어 화면에 렌더링.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위와 같은 동작을 통해서 원하는 이미지를 얻을 수 있다.
다음 목차들을 수행하여 구현하는 과정을 나타낸다.&lt;/p&gt;
&lt;h2 id=&quot;aws-cloud9-환경에서-코드-작성-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#aws-cloud9-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1-%EC%8B%9C&quot; aria-label=&quot;aws cloud9 환경에서 코드 작성 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AWS Cloud9 환경에서 코드 작성 시&lt;/h2&gt;
&lt;p&gt;S3 원본 리소스를 이미지 리사이징할 Sharp 노드 모듈을 사용한 코드를 작성한다. 필자는 Cloud9 이라는 AWS IDE 를 사용함.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&apos;use strict&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; querystring &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;querystring&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AWS&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;aws-sdk&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; Sharp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sharp&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;S3&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AWS&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;S3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token literal-property property&quot;&gt;region&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ap-northeast-2&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BUCKET&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;버킷 이름&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Records&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cf&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Parameters are w, h, f, q and indicate width, height, format and quality.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; params &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; querystring&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;querystring&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Required width or height value.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;w &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Extract name and format.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; uri &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; imageName&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; extension&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uri&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token regex-source language-regex&quot;&gt;\/?(.*)\.(.*)&lt;/span&gt;&lt;span class=&quot;token regex-delimiter&quot;&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// gif 포맷은 원본 반환&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;extension &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;gif&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Init variables&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; format&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; quality&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Sharp는 이미지 포맷에 따라서 품질(quality)의 기본값이 다릅니다.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; s3Object&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; resizedImage&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Init sizes.&lt;/span&gt;
  width &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;w&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;w&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  height &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;h&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Init quality.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    quality &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Init format.&lt;/span&gt;
  format &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; extension&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  format &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; format &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;jpg&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;jpeg&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; format&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// For AWS CloudWatch.&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;parmas: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Cannot convert object to primitive value.&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;name: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;imageName&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;extension&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Favicon error, if name is `favicon.ico`.&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    s3Object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;S3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getObject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token literal-property property&quot;&gt;Bucket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BUCKET&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token literal-property property&quot;&gt;Key&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;decodeURI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageName &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;.&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; extension&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;promise&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;S3.getObject: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    resizedImage &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Sharp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s3Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;resize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toFormat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;format&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        quality
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toBuffer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Sharp: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; resizedImageByteLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Buffer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;byteLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;resizedImage&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;base64&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;byteLength: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; resizedImageByteLength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// `response.body`가 변경된 경우 1MB까지만 허용됩니다.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;resizedImageByteLength &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; resizedImage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;base64&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;bodyEncoding &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;base64&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;headers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;content-type&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token literal-property property&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Content-Type&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token literal-property property&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;image/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;format&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;코드를 작성 후에 다음 명령어들을 실행한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;$ npm init &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;y
$ npm install sharf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그러면 다음과 같이 구성된다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 158px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/779403e5c2efeb94fe43c97ecbe65926/c26ae/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 68.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVQ4y12UWXfSYBCG8x8skIVskEBIAgESIGUt0Jalpa222Krt8UZv9Hjl/z+v800Iohfvmfm2ObM8iaTpNhTNhNOI0B7MUKkFCDrncLwWan4bXitBMr5CPLpExc3Owu45mvEQ9TDmM7NS5xgilqSWLXYU1YCs6FDpoCRrrEJROapYUlEke1aQ/+6TL+7lMYSVNL0CWdXRn645q3S+RSe9QEgZDC62mN++ICXrR32Mrh4wmG1wcfOMyfoR4+v3aLR6nIwIyBmKVBXNgO340IwKlTNEgx7bVJ7fHlDgEVrJGF4zIcXHvazsEbUo5IREdiKW5Ik+kepek2yEihNwr9x6iErVo7UHy67BcX1e12jfpT7nEu8aQRZDSGp3Uwh14hRBq4+X+2v8+LLG7uEZr2/f8PPXb7x+/Y6nj6/YP78hpBI78Tm9IbFN/5EUdQbIFVKp9+s5Xu6WGI4XmC83uFrtsLjcYr19YNuMejh9878ki0aeyyaphgNFd6AbVZ64qlkoU28V9k2+Z9oui33LhWFWD+taPhSTm1pUDIx7TYwSHz4NZ7L6QJO9x2y7x3TzhNlmj95kRSTc8IQFm+n8ls866TwbSj5uIZmySdoBksiHG8QEccpY1MMuusMF2oSTAF9Mm6dOZwIvQUWVps3Y5ECqZRHUQqFURkEuM7AC4mJJY+DfnRVpXWKfISeV6J6s0F2SYPEAtn2kvEx9G13eYbjcMehTgldIwL28+4zF7hMSKlO0YrJ6RNSbEIMG9/gI9ulnIyTKcwWXh7JqQQcufedRf8ogZ4AnvGcRl/n7Y8A8mG7RZE2HSxDks0787Ps+rJVsL/8hnAb9A0cOpIGPCA5uAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;1&quot;
        title=&quot;1&quot;
        src=&quot;/static/779403e5c2efeb94fe43c97ecbe65926/c26ae/1.png&quot;
        srcset=&quot;/static/779403e5c2efeb94fe43c97ecbe65926/12f09/1.png 148w,
/static/779403e5c2efeb94fe43c97ecbe65926/c26ae/1.png 158w&quot;
        sizes=&quot;(max-width: 158px) 100vw, 158px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;node_modules를 위해서 cloud9을 사용했지만 로컬 환경에서 npm 구성 후에 람다로 프로젝트를 올려도될것같다.&lt;/p&gt;
&lt;p&gt;이제 동작할 코드 작성은 끝나고 람다를 생성해보자.&lt;/p&gt;
&lt;h2 id=&quot;로컬-환경에서-코드-작성-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A1%9C%EC%BB%AC-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1-%EC%8B%9C&quot; aria-label=&quot;로컬 환경에서 코드 작성 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;로컬 환경에서 코드 작성 시&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6c98c74d4c103cb9c5a0c5c371688566/dba9a/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVQ4y42T6W6bQBSFeQDHxoSBYRnAbMNis9jGS+zErtImjVq1lZq/ff/HOL2QREmlqumPoxmQ5tzvnjujLNoduqtbzJstQrkYFMkKQVqhbip8eTjg6vQZzeoGVXtAvlijrHboz6XFEnHeIilepRzP93j8+RXfHn9hd3OP+fKAan09qKRDy3WHpjuiIPNq1WC+qpFmc8RpAdv1wS0Hlu2C2wKmJaA0mwOOt3fYX9/h+OEBRbWhqs1zxSWSsoMs17BMB9pkAkNXwbQxdHWECX1PLjlUzYB2OQEzNSj1usbD9xtq+w7d/ow4qxCmfdsL2tfIFh0V2aIIWqQiRBk58ISLRBZwgwB+JiHSFLF0IGYWlJZa+vxwxunTDyy3J7SbE8pmT9ohJ1o5Xw+Gi4hoXTLwOVxRIElz6kQilTNwrhOhiovRCEooc7T7LXbHj0R5RlF3COKClA8DyhYbZBWZJh72sxi58FGmAeapD5nPEBUBZWnh4mKM8XgMZZaU6NW3GKZz+FFOZuVg2k9bUstlvUUW+Qi5hYBz+OaTTJ3B4IzotCHPJ8Pnwy96KfBi2BP210T6JbjOEQmGqaZCEzGYl9KEGdzQguPqZDjqCV9N3qo37FvOKb8+S90wYRKVrhvDekl0OjNo1cEMA4bBh//K38z+ICSzglqOfcrUi5BH3qAy8QeFnkN0nOLy4Pri34ZvCV3uQp+OYXGiYiYMpsMiMU3HVB3DZFOo6uQ9wifDkia/LBNUYQIvyCjXFmEUIqYc61hilQjI/krZ1v8SdnSZBRzDIyqDDjIIu8+SIRAm7YmYMuZE/36GNOWc7mFEr2JmRZSZjSx0hoEIWr3Yhe1Z9Goseik2fgNSypDSP/ATEgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;2&quot;
        title=&quot;2&quot;
        src=&quot;/static/6c98c74d4c103cb9c5a0c5c371688566/fcda8/2.png&quot;
        srcset=&quot;/static/6c98c74d4c103cb9c5a0c5c371688566/12f09/2.png 148w,
/static/6c98c74d4c103cb9c5a0c5c371688566/e4a3f/2.png 295w,
/static/6c98c74d4c103cb9c5a0c5c371688566/fcda8/2.png 590w,
/static/6c98c74d4c103cb9c5a0c5c371688566/dba9a/2.png 652w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
cloud9과 마찬가지로 코드를 작성해서 &lt;code class=&quot;language-text&quot;&gt;npm install sharf&lt;/code&gt; 를 실행하고 zip 으로 파일들을 압축한다.&lt;/p&gt;
&lt;h3 id=&quot;빌드-환경이-x86_64-생성한-람다-아키텍처이-아닐-경우&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B9%8C%EB%93%9C-%ED%99%98%EA%B2%BD%EC%9D%B4-x86_64-%EC%83%9D%EC%84%B1%ED%95%9C-%EB%9E%8C%EB%8B%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EC%9D%B4-%EC%95%84%EB%8B%90-%EA%B2%BD%EC%9A%B0&quot; aria-label=&quot;빌드 환경이 x86_64 생성한 람다 아키텍처이 아닐 경우 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;빌드 환경이 x86_64 (생성한 람다 아키텍처)이 아닐 경우&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0f8c1baf140433320399c566108fe6f7/c5bb3/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 27.027027027027025%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQY03WQzW6DMBCEef8X6qU9VL01hypJmxBQQwgYY/4MGAg0pdPB5VpLo/VY3m9H65hxhJASru/Dv1yQyhheKhBUJUSjEdWVVVAVCNe3uNYo+w7KtMg7g4y1GnoMXxOczzKHV2TwWbeE7ZTETgocVAI3kzjSR7pCQUDPhn6aMN7v+O84ktMPCyj500ea4J1AN0txoo6EXgmM+S/UBRNWSNsaZryhHQeY6YZu1fwzM2EQ4BKFTKmwJ+iUKwvaJpFNt5fLEIXns8KDe8VLkOPJF/QpHv2E98T6N9Eh6wh8jUpsvDMyThVNbXe01FCXdlcL9Ko1ZZhqZqoZze1OfVtvVt9P4CqAX+KCdf2j23ouAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;3&quot;
        title=&quot;3&quot;
        src=&quot;/static/0f8c1baf140433320399c566108fe6f7/fcda8/3.png&quot;
        srcset=&quot;/static/0f8c1baf140433320399c566108fe6f7/12f09/3.png 148w,
/static/0f8c1baf140433320399c566108fe6f7/e4a3f/3.png 295w,
/static/0f8c1baf140433320399c566108fe6f7/fcda8/3.png 590w,
/static/0f8c1baf140433320399c566108fe6f7/c5bb3/3.png 680w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt; 을 하고 람다에 배포하면 위와 같은 오류가 발생한다.&lt;/p&gt;
&lt;p&gt;로컬환경에서는 Linux 환경이 아니거나 또는 Apple ARM 일때 &lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt; 시 다음 명령어를 통해서 설치를 해야한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;npm i --platform=linux --arch=x64 {module}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;람다에서 핸들러 경로를 &lt;code class=&quot;language-text&quot;&gt;path/index.handler&lt;/code&gt; 로 지정하면은 해결되긴 한다.
패키지를 설치하고. 이제 zip 형식으로 압축하여 람다에 업로드하면 되는데. 압축 시 주의사항이 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fe21a77a789a0af8efcd9e3bfb457ab1/977f7/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.891891891891895%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQoz4VR2W7CQAzk/7+sap/aolAKIYEcm/sibMg5HW8D6lstjRxvvOPx7GZeFsRZhr1t49OycA4V/EShcA6I8xS7JIJTZHDKHMcsQdN1SNoG2a1FUFfImQVy1g0DNjUbLmkCy3VxiiP4ZYHk2kB3GuM0oScwT1iGHv04oCPuK9r+zjwaIskLxW0gMc84RgofgQevKrGNApzyDIoK4rZFd60xKR+aShSHVVojba8I+V9I5bvSN0P1S8jQnHipChIWsOIQF66omgpRUxuVI3sGDp6IQWqqlnzre6NQ1BnCnlIFskrM6UL25rl4OZ/wyvypAhzSGO+hhy/6KfWe9Zb54WG92mMIC0oVH7N1hW82i/mHB1jbfByXFpTslfXkjvSX5q42eaby58rzyq5pvMsXPXNdUSsQC3z6amcpHJLKAHn1XayMAFlZfJwehB3VjesL/cUjnmf4P6TvB7ECZO6DGwuIAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;4&quot;
        title=&quot;4&quot;
        src=&quot;/static/fe21a77a789a0af8efcd9e3bfb457ab1/977f7/4.png&quot;
        srcset=&quot;/static/fe21a77a789a0af8efcd9e3bfb457ab1/12f09/4.png 148w,
/static/fe21a77a789a0af8efcd9e3bfb457ab1/e4a3f/4.png 295w,
/static/fe21a77a789a0af8efcd9e3bfb457ab1/977f7/4.png 547w&quot;
        sizes=&quot;(max-width: 547px) 100vw, 547px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
압축을 코드가 위치한 곳에서 상위 디렉터리를 통해서 하면 위와 같은 오류가 발생한다.&lt;/p&gt;
&lt;p&gt;폴더로 압축해선 안되고. 압축 해제 시 파일이 바로 나오도록 압축하면 된다. 그렇게 하면 index.handler를 정상적으로 인식해서 람다가 실행한다&lt;/p&gt;
&lt;h2 id=&quot;lambda-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lambda-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;lambda 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lambda 생성&lt;/h2&gt;
&lt;h3 id=&quot;코드-업로드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C-%EC%97%85%EB%A1%9C%EB%93%9C&quot; aria-label=&quot;코드 업로드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코드 업로드&lt;/h3&gt;
&lt;p&gt;Lambda를 생성하자 버지니아 북부에서 생성해야한다. (서울에서 하면 배포 시  Lambda@Edge가 안뜸)
필자는 런타임 Node.js 18.x 버전을 선택하였다. &lt;/p&gt;
&lt;p&gt;람다를 생성하면 코드 소스를 업로드하면 된다. Cloud9에서 작업했다면 다음과 같은 방법을 따르고 로컬 환경에서 빌드를 했다면 .zip 파일 형식으로 압축하여 업로드한다.&lt;/p&gt;
&lt;h3 id=&quot;cloud9에서-람다로-업로드-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cloud9%EC%97%90%EC%84%9C-%EB%9E%8C%EB%8B%A4%EB%A1%9C-%EC%97%85%EB%A1%9C%EB%93%9C-%EC%8B%9C&quot; aria-label=&quot;cloud9에서 람다로 업로드 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cloud9에서 람다로 업로드 시&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 345px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/260be348be2337e4067d56af8b32ca3d/e4d6b/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 141.89189189189187%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEhElEQVRIx31VaXPaSBDlH2ylsk4MCHSfSEKAMLe5BY69vgK+4yTlVFxJ7X7Zn7B//G33CGJjvPuhSyON5s3r7jdvMm/evkNettE5eYRseHD8CkyPolQVT4ufz8ZuuQHd9CDLBjwvQi4nQ7FMuI0SwkqMzDQ5QD85wfjLP7Dph2rcgO3XaOEevKgBJ4jhhvU0xLcmNAGow3YCASjrBpzYhRdEyCwv7zAcz7HzXiIGFTjhngDkseGE8KttAZQvqNjNFrCbK0CisaKagmFeUsRcLq9AKmrI/Pbmd7zdyYqJgmKsQGPYlB6Hbvnie55+5oUchaKeApYo5Twx5HFQgR/WkGl3BwjKMe1cFAsNt0z1igi0Do/qpRgusjS3BsvxxgSurhgya8+PMJ0dYjSZI7O4uEF/OMV7mlgz5BRtvypSzxIDjk1AYqiYsG2uYRGqbqNcqaMWN5GRVqnkJFkACnbUCE5bpE9jWbMF0HOGDOhQjdc1zEsacgUDGf5hHSJl+skJagJIsKXUOe1XAd0wlY1pwvA9NPaoyxuprGrIKYdxF6VKUzTGr7VFB39tzIDqE8NsQUapHGE+n2wDcu1YwFy3NcB6foPhqilcQ40ysN0ABiliC9AkhjoJdv39ZWw0hf+jjQskcqFT0uh/MKy8CvQS0KXNU0ADCjXOtLcYmqLL3FXW16sMV8JWV8JmjZp2Cb3+GINRknaZf+SaSURdp1100pdKRpHWUBaRXT+ZkRC2hRJlwoCa6aLTG2J/sGoKL+QuagTiklwCOr9hrSvSKFI6Mi3mUChYxDKVRuHycA2llegllTD0FJCPnR/U0e8fottJ8PH8Frc3D7j79J3iEVfXD7j//ANn53eI60M4ZGWKasNi2RDjompAsx14YfTEUNUcAVqJe+jsJ2h1J4hbCdr9Y8z/uMX0wxWGyQKzoxuU4zFK0YDOeo+cR4ds6ohGEcJ++LyGRVFwbopFZ5gFbgdtRPUpjs4+4/D0HgmBjpIlyrUxlWUEvzKgehqQFBVW5MIsO9tdZsmwfHbe7dIxjFFtzjGcLTGaX6A3OoPmtMhkyaEI1Cvvi7oVVA1Fg4LWbwubGLLLsMDj9iHGB1+xuPkLpxc/cbL8gev7vzE//obe5A7twZKaZgqGfj3CZHbwAlBOT0pq92RHrQ8YJHdYXP+J88ufOF48inFy9AWd4RWavTPBiqXETRqOZtuAfI6FdRFTN+wg2psRy0sMpgtK+5KuhBFtNiDzmFDqacosOQatsh9u1ZAkwZeTLSyshepegrPlA04XX3F48okaMfwVpagvSDCYRZpstPY3AYW4rZJIm58OdbnaPEB3dE71OkWrf0LMpijTJsw8qA5prQad3MYNA0T7lScdrp8sHz5O7ByW1xCN+Xj1HZODK/LHEWlwKtJlYGapkH5lxYIdllAdVzcZvnQX3aLrwG8hqPTgRx0y28YqmvS9KcZsFBKx1By6V/rlJ8DnQE+MUzPgoymEv3oX9zJJzKUrIEuuZFgeMbXEXOb/jPT172v7suB6qR/mi2QMsiqM5F+o8UAx2H9AMAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;5&quot;
        title=&quot;5&quot;
        src=&quot;/static/260be348be2337e4067d56af8b32ca3d/e4d6b/5.png&quot;
        srcset=&quot;/static/260be348be2337e4067d56af8b32ca3d/12f09/5.png 148w,
/static/260be348be2337e4067d56af8b32ca3d/e4a3f/5.png 295w,
/static/260be348be2337e4067d56af8b32ca3d/e4d6b/5.png 345w&quot;
        sizes=&quot;(max-width: 345px) 100vw, 345px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
좌측에 AWS - US East - Lambda - 생성한 람다 이름 - Upload Lambda 를 선택한다.
그러고 다음 순서에 따라 선택한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Upload Type : Directory&lt;/li&gt;
&lt;li&gt;No&lt;/li&gt;
&lt;li&gt;index.js 가 위치한 폴더 경로 - Open
그러면 그 즉시 람다로 코드가 업로딩된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;로컬-환경에서-람다로-업로드-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A1%9C%EC%BB%AC-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EB%9E%8C%EB%8B%A4%EB%A1%9C-%EC%97%85%EB%A1%9C%EB%93%9C-%EC%8B%9C&quot; aria-label=&quot;로컬 환경에서 람다로 업로드 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;로컬 환경에서 람다로 업로드 시&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 254px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b83453c4bb551eb3468615afd22ef60a/6a91e/6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVQ4y6WTa2/TMBSG9/9/DJ/4wAfQYIKtawdlXVm7la5JmzTNzXHixLnn5dhbolaahGCWHp3j5Oj1udhnAWN4C2EUIU4SJEKAkX/G4xgD9OPE/xsUp8ROBPOiwDFF7+f5CfLYl/I5tiyRppkWHgSrqkJPXdc6OAgZIh4P8FhlIYZ9IlK4XoA0y5DJnL5xiFTo8s9KOqVHCarT0DWQFHB+/gU708T19RiXlyOYhoEql9hbFsW0KGSGtiqQJK9k2AuqH3PTxa3hYbQwMX06YLKycUX+DVm1v7o3yDqYbwPc7yNsDiGyLH3OUPVBkRcl2qaGGSS4We9heSHuHje4Xa4xms4xXaxguiGMQ4Cdx7DZ+7ADEnMjXK32kEqQkaBKXdG1DdSyWIrZ1gejXr17/wGfLr5pPn7+iiAW8KJY42u4Fr9Y2sh7QSsuYcUFlHVEhZWf4ceWYeHEWAUSBq+wTRqsWYFfNsfcjl7gOmZmcdxRAkPJUQ0o/LyDL1t4Wa0zLWgo3ycTzKZT3IzHeFwu8PvhgewSk9EIW2ODftVloe+iHspP6tF4tgCTNYQSLxqInALofu1sB8bWwuN6A/vgwnF9eAGDT6WFPIEsSn0f1bUapqya+2S74CSUUhuVaJCVCNJCf1PEZYsor8GIUFbgZM1IwoszCJHAD0O6hy8lOxI45DQMUtolz9ii0VgD9ZHfwMlaLINSH6SGefJSGJ2oiKjkfyHM6GW1HcqqRESCohfEG5d6EPxYsOs6/C+vCf4BEX/A5NIvlsEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;6&quot;
        title=&quot;6&quot;
        src=&quot;/static/b83453c4bb551eb3468615afd22ef60a/6a91e/6.png&quot;
        srcset=&quot;/static/b83453c4bb551eb3468615afd22ef60a/12f09/6.png 148w,
/static/b83453c4bb551eb3468615afd22ef60a/6a91e/6.png 254w&quot;
        sizes=&quot;(max-width: 254px) 100vw, 254px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;코드 소스 - 에서 업로드 - .zip 파일
을 통해서 압축한 코드를 업로드할 수 있다.
10MB 이상 넘으면 S3 에서 업로드를 권장하지만 업로드하는데 지장이 없다.&lt;/p&gt;
&lt;h2 id=&quot;iam-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iam-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;iam 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;IAM 설정&lt;/h2&gt;
&lt;p&gt;이렇게해서 바로 실행은 할 수 가 없고 람다 IAM 권한 설정을 해야한다
CloudFront로 요청이 들어올 때 Trigger로 Lambda@Edge가 작동되고. S3 원본에 접근하기 때문에 권한(정책)을 가지고있는 역활을 설정한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Lambda - 구성 - 권한 - 역활 이름 &lt;strong&gt;클릭&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;권한 추가 - 정책 생성 - JSON &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&quot;Version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2012-10-17&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&quot;Statement&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;Sid&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;VisualEditor0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;Effect&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;Action&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;iam:CreateServiceLinkedRole&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;lambda:GetFunction&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;lambda:EnableReplication&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;cloudfront:UpdateDistribution&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;s3:GetObject&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;logs:CreateLogGroup&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;logs:CreateLogStream&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;logs:PutLogEvents&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;logs:DescribeLogStreams&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;Resource&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;정책 편집을 종료하고, 역활 - 신뢰 관계 - 신뢰 정책 편집을 누른다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2012-10-17&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Statement&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Effect&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Principal&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token property&quot;&gt;&quot;Service&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&quot;edgelambda.amazonaws.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&quot;lambda.amazonaws.com&quot;&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Action&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;sts:AssumeRole&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위 설정을 통해 Lambda 함수가 기존에 가지고 있는 역활에 적절한 권한이 주어졌고 다음과 같이 볼 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/11e5a9cd0a40701ae45f8a84be5e6f67/898f6/7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQ4y6WSa26DMBCEff+D9Bj93wtUbaNGTeJAABsMGAw2MN11Eimp6EOqpU9+yDs767U4ZQV2hwRZlmGeZ4zj+C+EaxSsPsI0Ldq2hfce4wr+jwj7/Ijy6QHHwiBNU7hhAI+FWZYILmuu4DdEWRlkuYLSGjpSoigUkiRFXhRxLeURDbmfSXSaph8RXI5SGsPoIcsezk/RH2e7OuT1X4fgup0bYG1HLktyYmOmEIjpDO+vjx5CgCfCNwjnXGwGB3330HyxtRZd10W31yRR/GtTvA+oqgo9Ca+N5TJzYqUUfa88frGC3pcFVks2xsSAtU6yEz7nKpIkiQ2SUmK/P0RRdnm+O527XDty6CZUvY+U3Xg318MUacYZrV/u4DND8beI3AZslcXmcMJGZnjdp3gjXnYJPk4aqguEh+4pYFy+ABh/j2B3dQBOtcMur/CRlXhPCmxTHfd7+vAbmUPqBjUHrYjcCdadQ2kHGCqxdlRif51voL2h86obfuUTLWLxir00iGsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;7&quot;
        title=&quot;7&quot;
        src=&quot;/static/11e5a9cd0a40701ae45f8a84be5e6f67/fcda8/7.png&quot;
        srcset=&quot;/static/11e5a9cd0a40701ae45f8a84be5e6f67/12f09/7.png 148w,
/static/11e5a9cd0a40701ae45f8a84be5e6f67/e4a3f/7.png 295w,
/static/11e5a9cd0a40701ae45f8a84be5e6f67/fcda8/7.png 590w,
/static/11e5a9cd0a40701ae45f8a84be5e6f67/898f6/7.png 798w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;lambdaedge-배포&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lambdaedge-%EB%B0%B0%ED%8F%AC&quot; aria-label=&quot;lambdaedge 배포 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lambda@Edge 배포&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6e53c7a3fbc2c19e20c1e47c3afa1668/f73a1/8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 97.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACBUlEQVQ4y51UW27bMBDUMXu7HiJfvUEv0MQu3DR1AetBSaTeL1rTnVVYxI1R2BEwICmu9jE7q6goCuz2ezw+PmG32yNJEizLgmmabsY8zxjHEW3bIer7AU3ToW4atF2HQS4mMbjHYbCn4+j4vcHXLymMyxFnBqYs70ZuLTKptG5bRGVZ4/cxBUsfR4ki5Xrv4c9nLLLeDPnuLN9EJ3G4P/zA4XDA6RQjjmNY69TpR56IXplZ3/fKY13XQm6LYRjVYF3XuxA18nGaZsjzHIXwwQDhudVJsNUMu65HPwwbbx8sMzhTh85VMHkB65xmWJRWV54HCcTSCQal1kJgNoFUcb3IkDrMjEGaZchENroXCrgmSSrvjSKOE6GlUBUQDOCqWoNeOHRVhZMYt1I6hd1Jc8ir9+er5ZFjgg7CepmhROgkS6qdU8Izwf0o6v8Xk47ZpAmQGvbgwmEjUtlKy3QWyc88LxdE/68Z7zKshIfnny/aGJbKyMqNZKh8SUYblg38cciZ1FyTV8TL0m4dpnNyGsYojKC/Omr+urC9X6SjqWT5rJm+/DqqU/LIbOumlT/JfKsgEVnbyhxTFk5m2KLk34NTU5QqE0opSVNdeTYiJ+6N2NDWmPxVdrk2SybFi4FHXfm/kghyCHj7/j1e7+cOqxeH63r/7L7tbj+KKpoE7uET5m+f8QfX5cauLnPmiAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;8&quot;
        title=&quot;8&quot;
        src=&quot;/static/6e53c7a3fbc2c19e20c1e47c3afa1668/fcda8/8.png&quot;
        srcset=&quot;/static/6e53c7a3fbc2c19e20c1e47c3afa1668/12f09/8.png 148w,
/static/6e53c7a3fbc2c19e20c1e47c3afa1668/e4a3f/8.png 295w,
/static/6e53c7a3fbc2c19e20c1e47c3afa1668/fcda8/8.png 590w,
/static/6e53c7a3fbc2c19e20c1e47c3afa1668/f73a1/8.png 822w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
작업 - 기능 - Lambda@Edge 배포를 클릭한다. (리전 확인 필수)&lt;/p&gt;
&lt;p&gt;CDN은 생성한 CloudFront 로 연결하고 캐시 동작을 * 로 선택한다.
CloudFront 이벤트는 오리진 응답으로 선택한다.&lt;/p&gt;
&lt;p&gt;그리고 최종적으로 CloudFront에 다음과 같은 &lt;code class=&quot;language-text&quot;&gt;쿼리 문자열&lt;/code&gt; 설정을 해야한다. 해당 설정을 하지 않고 배포한다면 CDN으로 요청 시 쿼리 문자열을 지정해도 람다가 실행되지 않는다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ab4884eb5821064687577e3807d3ef7c/61c63/9.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 119.59459459459461%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQ4y51Va3ObMBDk//+8NP2Stp4xNknKGwRIQuDr7RkIYILtamYHLEt7e0+8Uil6+/Vb8PLySj9ef1KSpOScI2MtGWNJa0PaGGoaTZb3sC6Xi2C9PMMHXdtSVdd8oaGaUZSKlKoEJb/neTEB53cJK7Yepjn5vk+n05mCIKDzOaA4jiliJEkiisMwEvKR7Lvl5ZWmj1RRmsSsIBcipdRCxSMYz3tta6lhd+Fy1/fUdR21HD88n1kjqYfAF6zoxK4mWUYxuweoqiLLsUUSlmgHWGqH2OtZXD1kEdmLOVY4MLcIlfcAo6iIL0K2BDU+EvL+IRbzohTgv2fiN5UNJJ84syD9czjIE6qxD9X2G0CZlJvWXwpxybH0sizlcs+bPScHf47ve4DbeE6EI3sUJxJHuJpxAQMwcNkgHfekEtYuaybEDyiVVpsBbm25jLLKi0JEzBMyKcQLWs4MpWDvAIRozyTNFoSicE1oHyFsHyBEtu4pbBcKS2mAXYVjKdx2xxIgxuRBDKH2hhCr4Oyeg3d2I70ScwY3MfQ56reum0XJXOuQCVFvsIxSqdn1dcM/Ohim1kM8siyXiofrmOLrybzXdjfTBiSff0PpaQCEIEfw94AQoEXNYtqgiPlyyrFbu+iGS85t4RpLeLKYNvieRGVDbwefp3XExBmFUcQhyP5vwMKCcT19hjEdj0fOdnGdNLMJ8tQnwAzB7zonk3jL6jPrH5ipWBz+s6pdAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;9&quot;
        title=&quot;9&quot;
        src=&quot;/static/ab4884eb5821064687577e3807d3ef7c/fcda8/9.png&quot;
        srcset=&quot;/static/ab4884eb5821064687577e3807d3ef7c/12f09/9.png 148w,
/static/ab4884eb5821064687577e3807d3ef7c/e4a3f/9.png 295w,
/static/ab4884eb5821064687577e3807d3ef7c/fcda8/9.png 590w,
/static/ab4884eb5821064687577e3807d3ef7c/61c63/9.png 693w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이로써 이미지 리사이징 적용이 끝났다. CloudFront에 람다가 배포된 후 CDN URI를 통해서 가져올 이미지의 Key 를 지정한뒤 쿼리 문자열을 지정하여 리사이징을 호출한다.&lt;/p&gt;
&lt;h2 id=&quot;웹-성능-개선&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0&quot; aria-label=&quot;웹 성능 개선 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;웹 성능 개선&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2824b8d9d8da607e3d0062f2a86655e1/31aff/10.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 20.945945945945947%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAy0lEQVQY012Qyw6CMBBF+f8/cWNc+QFq0KVbWPCytECB8ljw5tqZaGJcTNqZuff0pk6WZajrGsYYdF2HpmkwzzPWdeXa9x1t26IoCmzbxtppmjAMA+vIU1UV99enC0cIAc/zuOI4hlIKfd9jWRY20qm1RhiGDHhZPZlpPo4jyB9FEZSUONyOcJIkge/7XHSXdkGvfoGUMs9zBEHAM/EBEpyBaYo4sj4lcXLPcFILIDElSO2SvuA/YVmWDCII7X+BphSodYhOC1wed7wBKgcs64EMYFIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;10&quot;
        title=&quot;10&quot;
        src=&quot;/static/2824b8d9d8da607e3d0062f2a86655e1/fcda8/10.png&quot;
        srcset=&quot;/static/2824b8d9d8da607e3d0062f2a86655e1/12f09/10.png 148w,
/static/2824b8d9d8da607e3d0062f2a86655e1/e4a3f/10.png 295w,
/static/2824b8d9d8da607e3d0062f2a86655e1/fcda8/10.png 590w,
/static/2824b8d9d8da607e3d0062f2a86655e1/31aff/10.png 823w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CDN으로 부터 이미지 리사이징된 리소스들을 받아온 모습이다. 원본 리소스를 조회했을 때 보다 매우 빠르게 작동한다.&lt;/p&gt;
&lt;h3 id=&quot;원본-리소스-크기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%90%EB%B3%B8-%EB%A6%AC%EC%86%8C%EC%8A%A4-%ED%81%AC%EA%B8%B0&quot; aria-label=&quot;원본 리소스 크기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;원본 리소스 크기&lt;/h3&gt;
&lt;p&gt;원본 이미지의 사이즈가 1200x750 일때 다음과 같이 받아온다.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4adadb6c4851644e40010b84d8670802/43142/11.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 31.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVQY02VQ26qDQAz0//9NKgqC9VJEH7y1erxbXadO2pWWExh3N5nMJBpKKWwH1Afbtp13Yt/3E7+1/3neDX4Y4ziiKAp0XSdvEhh936OqKtR1LW/NX5ZFuNM0QYcI6uayLBGGIUzTRBAE5yRZlsGyLHieB9u2Rej+aHD1wyN/kTzrNGYYWpluURTBcRzEcSxi67qKkeu6Ikyj55OCf4huMQLfF65/nMMwvAW/V+ZanECbULRtWyRJgjzPv1ZTmOcZTdMgTdOfnlNQ/1hd0OCUNONK5Ly5SkQI5lnXfS8Jxs8KlmE1HwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;11&quot;
        title=&quot;11&quot;
        src=&quot;/static/4adadb6c4851644e40010b84d8670802/fcda8/11.png&quot;
        srcset=&quot;/static/4adadb6c4851644e40010b84d8670802/12f09/11.png 148w,
/static/4adadb6c4851644e40010b84d8670802/e4a3f/11.png 295w,
/static/4adadb6c4851644e40010b84d8670802/fcda8/11.png 590w,
/static/4adadb6c4851644e40010b84d8670802/43142/11.png 599w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;캐싱-리소스-크기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BA%90%EC%8B%B1-%EB%A6%AC%EC%86%8C%EC%8A%A4-%ED%81%AC%EA%B8%B0&quot; aria-label=&quot;캐싱 리소스 크기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;캐싱 리소스 크기&lt;/h3&gt;
&lt;p&gt;이미지 리사이즈를 통해 640x640 이고 퀄리티를 75, 포맷을 webp 로 했을떄 다음과 같다.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 527px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fc758aad84105862744eaa5ec18f6dff/44385/12.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQoz31R24qDMBDN/39OQej7Pq2UiggF3xTayuK9YuItns0MjKul7EDQuZzLJMpMFoMx0FpjHEes6wpr7b8HsGiNxUvPGAcD4/DTNDFe9YN1BY2+11ykIFI5EiIkX1fBPmReYXUOh2FT+QMA8zw7oZ7di9i+Z8zAruhfSBUlz+cTaZqiqqoDiITu9zsejwfatj30tBPKsowxJLgRLsvC7sIwxPl8ZkUKqtNgFEW4Xq/wPA9BEHCvdCRf/jculwt838fpdEIcx9xTxEpO8jw/OJR60zQoigJd13FOQev/FDm7ruuar0XWVgQmorIs2dV+LRqk67jdbgexZV7QvToWSpKEV6ctN4dCsH+tDexEyJE8mMxTTj1yRs7FjPpEJPl7fKq9938BuEa7T/nSB0IAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;12&quot;
        title=&quot;12&quot;
        src=&quot;/static/fc758aad84105862744eaa5ec18f6dff/44385/12.png&quot;
        srcset=&quot;/static/fc758aad84105862744eaa5ec18f6dff/12f09/12.png 148w,
/static/fc758aad84105862744eaa5ec18f6dff/e4a3f/12.png 295w,
/static/fc758aad84105862744eaa5ec18f6dff/44385/12.png 527w&quot;
        sizes=&quot;(max-width: 527px) 100vw, 527px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
기존 리소스 크기가 약 290KB 일때 이미지 리사이즈를 통해서 약 22KB로 약  1/13정도로 크기가 줄어 든 것을 볼 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;이미지 리사이징을 통해서 원본 이미지를 그대로 받아오는 것 보다 스토리지 비용이 상대적으로 감소하고 또한 네트워크 전송량에 따른 비용도 감소한다. 새로운 해상도나 모바일 환경에 맞춰서 해상도 대응 문제를 해결하기 쉽다. 최종적으로 많은 이미지를 그려도 적은 용량으로 브라우저에서 로딩하기 떄문에 사용자 경험도 매우 좋게 상승한다.&lt;/p&gt;
&lt;h2 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://lemontia.tistory.com/1071&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://lemontia.tistory.com/1071&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://heropy.blog/2019/07/21/resizing-images-cloudfrount-lambda/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://heropy.blog/2019/07/21/resizing-images-cloudfrount-lambda/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://tech.wired.company/cloudfront%EC%99%80-aws-lambda-edge%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94-dab488c0ef35&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://tech.wired.company/cloudfront와-aws-lambda-edge를-활용한-이미지-최적화-dab488c0ef35&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://velog.io/@dankim/Lambdaedge-cloudFront-S3&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://velog.io/@dankim/Lambdaedge-cloudFront-S3&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://velog.io/@su-mmer/CloudFront%EC%99%80-LambdaEdge%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://velog.io/@su-mmer/CloudFront와-LambdaEdge를-이용한-이미지-리사이징&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/daangn/lambda-edge%EB%A1%9C-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-on-the-fly-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95-f4e5052d49f3&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://medium.com/daangn/lambda-edge로-구현하는-on-the-fly-이미지-리사이징-f4e5052d49f3&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[AWS] S3 리소스를 CloudFront를 통해 캐싱하자]]></title><description><![CDATA[S3에 CloudFront 적용하기 현재 개발중인 서비스에서 이미지를 불러오는것을 S3에서 직접적으로 가져와 사용하고 있는데
서비스 특성상 이러한 이미지와 영상과 같은 미디어 파일들을 많이 사용되는 서비스 구조라 
서비스의 구조가 많이 무거워지고 리…]]></description><link>https://hoon9901.github.io/aws-s3-cloudfront/</link><guid isPermaLink="false">https://hoon9901.github.io/aws-s3-cloudfront/</guid><pubDate>Wed, 05 Apr 2023 14:50:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;s3에-cloudfront-적용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#s3%EC%97%90-cloudfront-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;s3에 cloudfront 적용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;S3에 CloudFront 적용하기&lt;/h1&gt;
&lt;p&gt;현재 개발중인 서비스에서 이미지를 불러오는것을 S3에서 직접적으로 가져와 사용하고 있는데
서비스 특성상 이러한 이미지와 영상과 같은 미디어 파일들을 많이 사용되는 서비스 구조라
서비스의 구조가 많이 무거워지고 리소스 사용량이 상당히 늘어날 것 같아 캐싱을 적용하기 위해서
AWS에서 제공하는 CDN인 CloudFront를 통해서 적용하는 과정을 알아보자.&lt;/p&gt;
&lt;h2 id=&quot;cloudfront-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cloudfront-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;cloudfront 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CloudFront 생성&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/35ebd7ddbe54049c8a53fdba53be22f8/4ff83/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 101.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwklEQVQ4y6VU2XKDMAzk//+t7Uzz2ulLOY0NBGxuomqdOCVc6bSeURSMvay0kjyZn+nDFxQKRYkqKE4E5UVBZVX9ybwgDOn9dKKX1zdKhKBKazqX5Z/NK/knThLSxlDdNFTX9dr29hdngOGBphApDcNA4ziuDPt93z81nGsY1DOMLiXnj0E7ftE0LbVtR03b8pcbGhgU63K5HBoW7nugmeUFhXFCIpU2D9hDLsEeofT8dRzubmys5z0H5Hz/A5iTyjLLNCvN7eI1VIQ9TRONC8PenPkd0DBgKiX5QchekSpKZqapqqB2ZcFtLheGvU2GyGGF0Dhf7tB0Y2CZbQhljd/tAkKQKBYcdm4FeQCagS9tFxCJhxgAu4fHSYefCzK3XVEAmLPKSikrjFKZfbYlxKXjymZvrUVhQLADELwxtS0bgOE/Dh3V4SZDqIqSGZ+wmbPaen4omy8/IN/3KZIFaVYcHeO6pus621bwS1YrwFLX9BmkdOaRhWLGRdd6DuwK2LLvD0O/h2yVZlb/XVDe09yzYIDefSiZPdvoGjepWo7Kji/kMIwiHg7p72bfjmnN8xDMJANicqMW3fw7ZLmw+Tz8BlQAGTe6kiJAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;1&quot;
        title=&quot;1&quot;
        src=&quot;/static/35ebd7ddbe54049c8a53fdba53be22f8/fcda8/1.png&quot;
        srcset=&quot;/static/35ebd7ddbe54049c8a53fdba53be22f8/12f09/1.png 148w,
/static/35ebd7ddbe54049c8a53fdba53be22f8/e4a3f/1.png 295w,
/static/35ebd7ddbe54049c8a53fdba53be22f8/fcda8/1.png 590w,
/static/35ebd7ddbe54049c8a53fdba53be22f8/4ff83/1.png 843w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CloudFront &gt; 배포 &gt; 생성으로 이동&lt;/li&gt;
&lt;li&gt;원본 도메인은 사용중인 S3에 대한 도메인으로 선택&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a4fff00b9b8c2b0f7ddedec8c391dd31/d125e/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABL0lEQVQoz51S0W6DMAzM///hHlYKhEKgLbQkEEjgZnul6jZpQ4t0chI5l7PPqus6VFUFO4yw04Jtrev6xHbes9QwDNBFgZaIz5cr6qaBo7v/EqtpmlCcSpi6htYFjmmG3loM4wjv/ZfkPSqVvli8H45IjinFRGJ3u+Pe9wLnBvCnrwp/gwoxihJPjyQSRgKTzPMMbgmfdxMyQZZrMsaImhCCEDFeifYuNRNBRr3LtEaSpjgkn+VvMc1znMqKzDpLFdMD3k/Sa2udeMA5LE6xooac7alfvN9K5T1jHL24zslxWbA8wPtI7QohSg5XE+NCLtPF2yGDMTWubYuSSq+Mkcg/8zix47tLDssKXV9haLh5ZHIqkUm67iaRVewx42kKJwc2gFQ4537M3vf5+8ukDxWLWmZNA2aUAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;2&quot;
        title=&quot;2&quot;
        src=&quot;/static/a4fff00b9b8c2b0f7ddedec8c391dd31/fcda8/2.png&quot;
        srcset=&quot;/static/a4fff00b9b8c2b0f7ddedec8c391dd31/12f09/2.png 148w,
/static/a4fff00b9b8c2b0f7ddedec8c391dd31/e4a3f/2.png 295w,
/static/a4fff00b9b8c2b0f7ddedec8c391dd31/fcda8/2.png 590w,
/static/a4fff00b9b8c2b0f7ddedec8c391dd31/d125e/2.png 737w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;S3 버킷 액세스에 대한 설정인데. S3에 대한 모든 접근은 차단하고 CloudFront를 통해서만 접근이 가능하게 할려면 OAI 설정은 체크한다. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그리고 배포를 생성함.&lt;/p&gt;
&lt;h2 id=&quot;s3-버킷-권한-편집&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#s3-%EB%B2%84%ED%82%B7-%EA%B6%8C%ED%95%9C-%ED%8E%B8%EC%A7%91&quot; aria-label=&quot;s3 버킷 권한 편집 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;S3 버킷 권한 편집&lt;/h2&gt;
&lt;p&gt;Amzone S3 &gt; 버킷으로 이동해서 버킷 권한을 편집한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Version&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2008-10-17&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;PolicyForCloudFrontPrivateContent&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;Statement&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Sid&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Effect&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Principal&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token property&quot;&gt;&quot;AWS&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity OAI-Here&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Action&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3:GetObject&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Resource&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:s3:::your-s3-bucket-here/*&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Sid&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Effect&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Principal&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token property&quot;&gt;&quot;AWS&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity OAI-Here&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Action&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3:ListBucket&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token property&quot;&gt;&quot;Resource&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:s3:::your-s3-bucket-here&quot;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;자신에 맞게 수정하여 권한을 편집한다.
S3 버킷에 대해 &lt;code class=&quot;language-text&quot;&gt;GetObject&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;ListBucket&lt;/code&gt; 동작에 대한 권한을 부여하여 CloudFront가 S3 이미지를 가져올 수 있도록 한다.&lt;/p&gt;
&lt;h2 id=&quot;s3-퍼블릭-액세스-수정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#s3-%ED%8D%BC%EB%B8%94%EB%A6%AD-%EC%95%A1%EC%84%B8%EC%8A%A4-%EC%88%98%EC%A0%95&quot; aria-label=&quot;s3 퍼블릭 액세스 수정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;S3 퍼블릭 액세스 수정&lt;/h2&gt;
&lt;p&gt;추가적으로 기존 백엔드 코드(예: 스프링부트)에서 S3 에 대해 이미지 리소스를 업로드하는 코드를 작성해서 S3에 대해 AccessKey와 SecretKey를 통해서 작업했다면 S3 퍼블릭 액세스를 다음과 같이 수정한다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/914fbc946a6bf5b40da86a60df79ee25/31aff/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsUlEQVQoz3VSiY6bUAzk/3+w2RwcDwhXyHLDg0jTGWdbqe0WyXq2scfHOOj6HmEYIc9zyh1xnCBxDsuyYN93eO//lb/9sndvOcHnZ4fT6YwoinG9hThfriZlWaGuGzSPB5rm8db5Vnxrvm37pE29rlFWNeNarOuKoB8GOJchTlJ2liLNckTsUnK9RQhZSPqNU8jWK4kYf40znMIUjjkCNcCZbQ7DaNUlXddjnCbM82IjTNSnecY4Tm99mvlvpm9FP3s8pw37ceD1emHbNgQy2ucTl+sNSeI4TsNKG8FWLKyoIO93ezfuSw0cTP7uE2igoJ0LFZjGS9MMP04f+DhfbFT5tFMVlK2VaDQTFllYXA2IGJEYiKVx8bYH7TIj046gkbGdmv62Hffs6MswjCM79tb1+h1g0S22ZMdzUbJOx1ZgJGUGJL9YfZB1dfffkQVYDysuZDCK49/JGlVsSs/vhRWRT7bWIuIOI8J/EbgaOQbYjgKM7R4FooQ7QfTq2KUXvEuBZVxNUZR2p9qn3d8XcYcANfew7iiqxoLeh9sQoLTOJLox+cqq+tNmvA5c3f0a+ScoSz2GupKzCgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;3&quot;
        title=&quot;3&quot;
        src=&quot;/static/914fbc946a6bf5b40da86a60df79ee25/fcda8/3.png&quot;
        srcset=&quot;/static/914fbc946a6bf5b40da86a60df79ee25/12f09/3.png 148w,
/static/914fbc946a6bf5b40da86a60df79ee25/e4a3f/3.png 295w,
/static/914fbc946a6bf5b40da86a60df79ee25/fcda8/3.png 590w,
/static/914fbc946a6bf5b40da86a60df79ee25/31aff/3.png 823w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;다음과 같은 설정하면은 기존 백엔드 코드에 추가적인 설정 없이 이미지를 업로드하면 S3에 올라간다.&lt;/p&gt;
&lt;p&gt;이제부턴 기존 S3 리소스 요청을 CloudFront 도메인을 통해서 수행하면된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기존 URL &lt;code class=&quot;language-text&quot;&gt;https://s3-url/image.jpeg&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;적용 후 URL &lt;code class=&quot;language-text&quot;&gt;https://cloudfront-url/image.jpeg&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;cache-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cache-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;cache 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cache 확인&lt;/h2&gt;
&lt;p&gt;CDN 도메인으로 변경한 후 기존 S3 리소스를 가져오듯이 요청을 보내면 다음과 같이 응답 헤더를 볼 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 563px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a1ba6c5f85f71c2fe14942362c34bdf1/7cb89/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQoz42SjY6DIBCEff8X1JprvVNERQQUrdX+TBcuXGp6Sd3kC0pYdmeWyFoLxhj+i8fj8ZFwLkS0Xq9Q+gxZ9aikxjTP6Pse67piT7xe9nshJZZmRtkaZDnD6ZQhjmMcj0dwzj1SSiil/GqMQdd1nlB02yFt1sMFjZlQtx1qqbwFLllrDWdJSLrdbhvu9/ub/OhKkgt1xoEkx4VEkjGk6QGGZI/jiGEYPDNZsUe+77ChDrmeUAgNxisUee4lO5IkoQIpqqryXbnzy7J43Hfgr8OFflq7gJOPNclmJUeWZeTlCU0jvHfBM2dDWNu29QRPXYHNUL6ERfpT4vDNUEqDXBhIZSCa5m2SHyXLcYG0FwhtwWsBQ8N4fWN7cfEEs/24Npf/evoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;4&quot;
        title=&quot;4&quot;
        src=&quot;/static/a1ba6c5f85f71c2fe14942362c34bdf1/7cb89/4.png&quot;
        srcset=&quot;/static/a1ba6c5f85f71c2fe14942362c34bdf1/12f09/4.png 148w,
/static/a1ba6c5f85f71c2fe14942362c34bdf1/e4a3f/4.png 295w,
/static/a1ba6c5f85f71c2fe14942362c34bdf1/7cb89/4.png 563w&quot;
        sizes=&quot;(max-width: 563px) 100vw, 563px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;x-cache&lt;/code&gt; 를 보면은 최초 요청은 &lt;code class=&quot;language-text&quot;&gt;Miss from cloudfront&lt;/code&gt; 이고 새로고침을 통해서 다시 요청을 보내면 다음과 같이 바뀐다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 532px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/45b0197e13b19bf303df85d07a0e0cd9/89a37/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSUlEQVQoz42Si46CMBBF+f8vFB9IBVooFCkoL8G7M00k6K6rk9xMIZ3Tmdt6URzhr7jf70v+T+u9HJ4pLC7mAl2U6PoePWkYho+gt8C06iG1Rd70aNoeudaw1uLbWMMcMK46pNRdKhOkSiHLMkgpEcexk6YDjDHI89zl8/ns1qxxHH93mBBQmgZhLJ12ux0OQeAKGNy2LW63m7OBxZDHep7nJ58dUBEwKlsIc0VU1BAiJEi3bJqmyel1tNcLe3x7koBhXmN7UtgGAof93nW52fjwfZ/yxqlpmq+89HTdI7Us8jLTiISACI+QCXmapm5sQf/Y26IoXF6LfeUJlg4VgUIa95SVCJMMQazgHyPo0roCvnEuYO8eWnvJ+WlkBnJ3Ki8hEoWqvmCgA8dpJi+vy01++3w8240oLwNM06EoK2jqquvat+Z/euA/xoFUdGPrLT8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;5&quot;
        title=&quot;5&quot;
        src=&quot;/static/45b0197e13b19bf303df85d07a0e0cd9/89a37/5.png&quot;
        srcset=&quot;/static/45b0197e13b19bf303df85d07a0e0cd9/12f09/5.png 148w,
/static/45b0197e13b19bf303df85d07a0e0cd9/e4a3f/5.png 295w,
/static/45b0197e13b19bf303df85d07a0e0cd9/89a37/5.png 532w&quot;
        sizes=&quot;(max-width: 532px) 100vw, 532px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Hit from cloudfront&lt;/code&gt; 로 바뀐것을 볼 수 있고. 리소스 요청에 대한 응답 시간도 크게 줄은것을 볼 수 있다. (개인 환경과, 인터넷 속도, 이미지 크기에 따라 다름)&lt;/p&gt;
&lt;p&gt;필자는 리소스 36KB에 대해 약 120밀리세컨드로 받았고 그 후 캐싱된 이미지는 약 40밀리세컨드로 받아온 모습이다.&lt;/p&gt;
&lt;p&gt;이로써 AWS Cloudfront로 S3 리소스 캐싱 작업을 수행했고.&lt;/p&gt;
&lt;h2 id=&quot;cloudfront---s3-요금-정책&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cloudfront---s3-%EC%9A%94%EA%B8%88-%EC%A0%95%EC%B1%85&quot; aria-label=&quot;cloudfront   s3 요금 정책 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CloudFront - S3 요금 정책&lt;/h2&gt;
&lt;p&gt;AWS 문서에 따르면 Cloudfront - S3 간에 전송된 데이터는 S3에서 요금이 부과되지 않는다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://blog.kakaocdn.net/dn/dvQZ5Q/btrnFazzAb7/ttfyBK0Xn02p0BhX7b17cK/img.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;CloudFront와 S3 간에 대한 데이터는 요금이 부과되지 않는거지 Client (인터넷) 에서 CloudFront 간에 데이터 송수신 과 HTTP 요청에 대해선 부과된다. &lt;/p&gt;
&lt;p&gt;자세한 요금은 다음 이미지를 참고하자&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://blog.kakaocdn.net/dn/bNlRAh/btrnBzNjJZb/kf5n4Yw0xlfszmzTfWNPM0/img.png&quot;&gt;
&lt;img src=&quot;https://blog.kakaocdn.net/dn/cVU1N0/btrnHSebQNc/TfigOAnI0JSSk3dKoB1H4K/img.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://jw910911.tistory.com/110&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://jw910911.tistory.com/110&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[Wakatime] 와카타임이 갑자기 죽었다. won't send heartbeat due to backoff 오류 해결법]]></title><description><![CDATA[이 문서는 필자가 와카타임 작동이 안되는 문제를 해결하는 과정을 담았습니다.  빠르게 결론부터 보고 싶으시면은 해결법을 봐주세요. 오류 내용  
이번주에 갑자기 와카타임이 갑자기 측정이 안된것을 확인. 인텔리제이에서도 와카타임이  로 뜨고 작업 시간…]]></description><link>https://hoon9901.github.io/wakatime-is-dead/</link><guid isPermaLink="false">https://hoon9901.github.io/wakatime-is-dead/</guid><pubDate>Thu, 30 Mar 2023 22:10:33 GMT</pubDate><content:encoded>&lt;p&gt;이 문서는 필자가 와카타임 작동이 안되는 문제를 해결하는 과정을 담았습니다. &lt;/p&gt;
&lt;p&gt;빠르게 결론부터 보고 싶으시면은 해결법을 봐주세요.&lt;/p&gt;
&lt;h1 id=&quot;오류-내용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EB%A5%98-%EB%82%B4%EC%9A%A9&quot; aria-label=&quot;오류 내용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오류 내용&lt;/h1&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0617378925629b6891120f777c29245b/0b6f4/0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpElEQVQY01WPzU4TYRhGexUmbiRgBgbmfzqdoQWmlAScYptSrYkI1kBp4s+ChTu27rHQSKiRNBKMK3cuQDfGSxDNlCbWYEpoWhZ6BcevhI2Lk7zJ+yTPeSLHJy2OGy2+hT9ptNo0f53RPO0KLmj+vuC084d27y9n5106nS7n/9G7ov/r0RaZyM7eAZuv3vByZ4+t3TrbtTqV2j6V1wdUdvfZqr3l3YeP1L+cUDkKqX4K2e7zuUH16AfVw+9Uxb15GPL+a0gkngoYGrMYMVyG9RiSaiNPZdEyqwzbE9yQFDKFJWZKG1yfecRQusxgIJhbYWDhOQOFDW4GJa5NFymsvyAyHeQYs+MYno/uCpwEdrCIlX+C7QeM6A6F5RLZ/D1kRceMuhi2i6lpqLP3UXKPsU0TSVYprpSJ+HNZZGsczZ1EjU2gC6z0Ikq2jJOavzS+s7TKbWEp6a7I+SInsGKMBkXk/DpG1GNQdVheeyYM0zmUWAIznkQf97ESSQz/FmpynmhyVpR5l4aZuw8YNT1MsaS/xhDF2lQaPbWA5U0iaQ4P157yD0NjD0HZawHnAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/0617378925629b6891120f777c29245b/fcda8/0.png&quot;
        srcset=&quot;/static/0617378925629b6891120f777c29245b/12f09/0.png 148w,
/static/0617378925629b6891120f777c29245b/e4a3f/0.png 295w,
/static/0617378925629b6891120f777c29245b/fcda8/0.png 590w,
/static/0617378925629b6891120f777c29245b/efc66/0.png 885w,
/static/0617378925629b6891120f777c29245b/0b6f4/0.png 984w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 344px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/431f5c8df38055a1502c62b5aa178b86/75d93/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlklEQVQY063KSQ6CMBgF4F5FEgdiFBA1oS3SAVIWSgt6IVd66yeg7ICViy/v/QPxxBP/RBbqhXnvUd7EnvhxiTnryGAVFlgGg/w3f3PQ3TYHAxIGW0zZ73zQ5AytMkjBoWSKXGcQGe9Tq0vbGZRI+346RiCUpxjDWgllKEwJ62pcK4vKOri66bO5P2C77hxu7a37kVrjAznHsaxX3T7WAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/431f5c8df38055a1502c62b5aa178b86/75d93/1.png&quot;
        srcset=&quot;/static/431f5c8df38055a1502c62b5aa178b86/12f09/1.png 148w,
/static/431f5c8df38055a1502c62b5aa178b86/e4a3f/1.png 295w,
/static/431f5c8df38055a1502c62b5aa178b86/75d93/1.png 344w&quot;
        sizes=&quot;(max-width: 344px) 100vw, 344px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
이번주에 갑자기 와카타임이 갑자기 측정이 안된것을 확인.&lt;/p&gt;
&lt;p&gt;인텔리제이에서도 와카타임이 &lt;code class=&quot;language-text&quot;&gt;initialized&lt;/code&gt; 로 뜨고 작업 시간 측정이 안되더라
그래서 플러그인을 재설치했지만 해결하지 못했음.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/525717b80528d049c616dc392d462975/898f6/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVQ4y31T227TQBD1/z/wwgNVHxr+gQdAFCIuUlugakEtzcV27Nj1Pb7f7eQws4qjNClYOvLsnp2zZ2Z3pYWuYxVFMC0Lc1mGrCiQVRWKukAQhgijWMBxXET0d30fhmnA8z04rgPbcWARl2QZLq6+Q+Kkqm7Qti02APr1Gl3fC6wpXm82aIir6lrEA183jYiZayjmT9N0SLrtQfVTZHGEJElRliW6rnuCmsSSJNlhWNMTOGbw5hm5lBa2jxvNweTPnbBfVZVYzLsy2HlRFLCoJbZtU+kO4jgW8wyO0zQVOXmeQ1JJ8HphQ53PoFE/OZF3arel/E+QRdgxC/bUhq2gJwTl6QTT2QymaSKkvv5LkBHRIR463AlyyT9VG8psCmvrwPM80bchaRB0XVeIceLg8FjQ8fFL9zCfPCAikpvLC59zOGzGZe4cHpas2SzoYrlQRQ85eRDbF2QxBpe8fyhHPdTI4Q310LVMcdf2nR0KsjsWGzZ99lC4h7eaC5l6aJiPyItSXPQBddMiy6lkmwT9gEpMd2uY43GSZnTBO7odJLgKV0jiAKY2R+AYKBMPbRHRvW+36Oj5lEhCFymhSgP0dcpvCps2R5WFyJMADeV0dQHpeuZh9MnG6VsVJ+9NvHhj4NW5j9G3DGdfUwL9v8R4PXZw+sHCy3c2Tj4GOCN+9HmF0Xibf+5hfB9Dmi193D82mFoNbvUKF3KJyz3w+Ida4s6oBX+lVLhUaH5e0Aur8HtZCe5Gr/FgpJDCMBD2qQ5g0+yVegDmjvjmyXxb5/gLBhJteqlFLo0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/525717b80528d049c616dc392d462975/fcda8/2.png&quot;
        srcset=&quot;/static/525717b80528d049c616dc392d462975/12f09/2.png 148w,
/static/525717b80528d049c616dc392d462975/e4a3f/2.png 295w,
/static/525717b80528d049c616dc392d462975/fcda8/2.png 590w,
/static/525717b80528d049c616dc392d462975/898f6/2.png 798w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
WakaTime 인텔리제이 플러그인이 위치한 곳을 확인해봄. jar 형식으로 플러그인이 등록되어있는데 클린 삭제하면 될거 같아서 해당 파일을 삭제 후 IDE를 다시 실행하니 플러그인이 삭제됨. 그 후 다시 플러그인을 설치해도 같은 증상.&lt;/p&gt;
&lt;p&gt;혹시나 API Key 형식이 이번에 &lt;code class=&quot;language-text&quot;&gt;waka_&lt;/code&gt; 접두사가 붙은 형식으로 바뀌었길래 그 문제가 싶어서
API Key를 다시 넣어주기 위해 Wakatime config 파일이 위치한 &lt;code class=&quot;language-text&quot;&gt;~/.wakatime.cfg&lt;/code&gt;  를 열어보고 API Key를 다시 등록했다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 437px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/75e0f3bb7e44012c65beeb83182b0585/5a428/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQoz63RTUvDQBAG4FmT2Y+oiJfmoN70oEKNbSTRk0orSXNSsRHSnvL/f8PrbKmlB7G25vAwuzAzvMtS27Zomgbvb6+opx/4rGvMZzOURYG7NEWeZcj+IF+iMNRQAUOxgZIz7YUgot3FvRgX/RSD5wn6jwXyJ0l2wLjShGujBG3kewdWIT7cByVJgvFohKos8VJVmAxvMD8OccuEB0vIze/upWcoC6dHAcaX5yBjDJgZWmuwcHI/cRpnjrdyKjORNSDnHKy18PX7HFi3EyOzi4Q+3TqzVrfhZ35c+B+rJ3dlsdCn7GxhFEWrD+nCF64mBk3y0TDvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/75e0f3bb7e44012c65beeb83182b0585/5a428/3.png&quot;
        srcset=&quot;/static/75e0f3bb7e44012c65beeb83182b0585/12f09/3.png 148w,
/static/75e0f3bb7e44012c65beeb83182b0585/e4a3f/3.png 295w,
/static/75e0f3bb7e44012c65beeb83182b0585/5a428/3.png 437w&quot;
        sizes=&quot;(max-width: 437px) 100vw, 437px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그래도 같은 증상으로 안됬다. &lt;/p&gt;
&lt;p&gt;이제는 로그를 확인해야할 것 같아서 &lt;code class=&quot;language-text&quot;&gt;.wakatime.cfg&lt;/code&gt; 설정 파일에 &lt;code class=&quot;language-text&quot;&gt;debug = true&lt;/code&gt;로 debug를 활성화하여 인텔리제이 IDE 로그를 확인해봤다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 573px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/aeaa12d7fbf97a8ba5843973ce0c6210/3c024/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 115.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEgElEQVQ4y22VWXPadhTFeW+fM1N3mmZqBwNGSCBWL8RLHKdJmkzzlqd+jMw009Q7NjaxsdkkECC0sNtOvuDp+Qvjxm0ezogRw2/uPffci2/mlyAe+iX4pThC0TSyz37D23d/4Oeggh9mFzDzOIyZuW/rR/7uwaMAvnvwE75/8NCTT4kqUKJRyLKMWCyG7Z09VKo6ShUNmm5AqxvQhcRnveGpRlW1OoxWBx/++ghJjiDK3wqOLxJfhKwkEFaSkKJJ5I4LaJk2avUmbLePbn/kqdcfotcbotsdwKXEd73BGPsHR1D4ezWehqqm4JMSq5CUDDKpDawuPsPJSRFtuwenfwVneA13wGd/TI0IGsJxB3CcASy7j9H4Mw4P84ipGSSTK0ilsvCFgjKCARkr8iKeJ9ZRyJ9Db3ZYYRtlrYmG6cAZXMPujWATZBMkYJ1OF4PhDba3DzA7G8L8fAR+euoLcxhSJI5VNYut5Abyx5/QbFv0qkX/2nfPtumyuuE94JDAnZ1D+OclhBZiCIXoYZTlSkoKCXXZKzmXO4VWa6BUqvFp4PKyhmKxAnMKdG5btvoecHf3CEHCJDnpySeFVSiSimzsCbKpVZwenqLJVislDdVKHS4hXfppd9myO7yDWlbPA27vHOAxoxVkzIR8qppGJp3Bm8QW3i2/xvnhGdpaG1UCdb0Ns9ND25oMyRI+3g7GskTL1/8HRiIJ9s8cLohKE8ixBZ2VlQksl3UU2fJlWYPTG/9bpTMBjkbX9JBADkP45wEX2H9gXvaMlcJxHNPDlsEpE1rnQFwPMGlz6p/jiMH0vNgI4NxsEPP+MAJiylJEZShTUGIZbDKHxaNzmATq1QYMrYWuzSDfwmx3ItedQMdXN9jnIkj0PrH2EtHMOluW44jIKhZXNrHMF4XDAqyWjSarE0Cb8XCnwxBPejgJeB9XV5+xlztBSEkjuriOiLrEYIveAwrSS+vYXHmBk/0TLzaXF1WcnZdQ4WdLtEn/LOEhJaC2V+GXSbAfzcPPcPt5MFhhEsLH5NIafl99DS1fgtl2UG90uCkGTFEVJ9whaCqL7zoEDsY3XoVhJkXJZBFNpCdTFtNJs+TNzVconhbRaTkw6GO9ZU1WT+w05YEJ+xq4e3CMEDctEs9AjibEUOIeMENgdusF8oUzNPTm5HQ1mijVdFZaR5MXyOCOCy8twjoi2KPJLs+x3QB3WeyzT5LidxWubr1E/tM5mi0TdZ4vnaoQVqpq3n00DPP20vQI/E+wpzmctpxZ2kDmyQYOcnnCWqhxjzWuoNlxvTVrtW0vzFOYeN/jWfv49x78X29KmHsc4PlaXH6KBI/D3m6OsAYuLireplQYcAEWuROTFddG6K7C7f37q7dwe3ZSjM3z7CsUDgrelbm4rFI1FM5KKBE83ZSpvOMw+tYuywksEChi83btDfSTMkxvyhZaDLXOkDfYnsPL7Q6Fxp4c/iVc3XzB3l7uPnA6ZRHstae/IrdzhPJZlafL4HBcAh1UeXArTZNqT2RQ9Qb/ezp4//7Pe8B/AFqIP3Yvhf3/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/aeaa12d7fbf97a8ba5843973ce0c6210/3c024/4.png&quot;
        srcset=&quot;/static/aeaa12d7fbf97a8ba5843973ce0c6210/12f09/4.png 148w,
/static/aeaa12d7fbf97a8ba5843973ce0c6210/e4a3f/4.png 295w,
/static/aeaa12d7fbf97a8ba5843973ce0c6210/3c024/4.png 573w&quot;
        sizes=&quot;(max-width: 573px) 100vw, 573px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;인텔리제이의 로그를 확인하는 방법은 &lt;code class=&quot;language-text&quot;&gt;Help - Show Log in folder&lt;/code&gt; 를 눌러서 &lt;code class=&quot;language-text&quot;&gt;idea.log&lt;/code&gt; 파일을 열어보면된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-03-30 &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;:22:10,598 &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;690863&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;   FINE - WakaTime - Executing CLI: &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;/Users/seonghun/.wakatime/wakatime-cli-darwin-arm64, --entity, /Users/seonghun/Desktop/dev/art-be/src/main/java/com/example/codebase/ArtBackendApplication.java, --time, &lt;span class=&quot;token number&quot;&gt;1680175310.3830&lt;/span&gt;, --key, XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXbada, --lines-in-file, &lt;span class=&quot;token number&quot;&gt;31&lt;/span&gt;, --alternate-project, art-be, --alternate-language, JAVA, --plugin, idea/2023.1 idea-wakatime/14.1.4, --extra-heartbeats&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;-03-30 &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;:22:10,612 &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;690877&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;   WARN - WakaTime - Cannot run program &lt;span class=&quot;token string&quot;&gt;&quot;/Users/seonghun/.wakatime/wakatime-cli-darwin-arm64&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;, No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
java.io.IOException: Cannot run program &lt;span class=&quot;token string&quot;&gt;&quot;/Users/seonghun/.wakatime/wakatime-cli-darwin-arm64&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;, No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
	at java.base/java.lang.ProcessBuilder.start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ProcessBuilder.java:1143&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.ProcessBuilder.start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ProcessBuilder.java:1073&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.Runtime.exec&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Runtime.java:594&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.Runtime.exec&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Runtime.java:453&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at com.wakatime.intellij.plugin.WakaTime.sendHeartbeat&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WakaTime.java:305&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at com.wakatime.intellij.plugin.WakaTime.processHeartbeatQueue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WakaTime.java:298&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at com.wakatime.intellij.plugin.WakaTime.access&lt;span class=&quot;token variable&quot;&gt;$000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WakaTime.java:52&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at com.wakatime.intellij.plugin.WakaTime&lt;span class=&quot;token variable&quot;&gt;$3&lt;/span&gt;.run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;WakaTime.java:159&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.util.concurrent.Executors&lt;span class=&quot;token variable&quot;&gt;$RunnableAdapter&lt;/span&gt;.call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Executors.java:539&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.util.concurrent.FutureTask.runAndReset&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FutureTask.java:305&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor&lt;span class=&quot;token variable&quot;&gt;$ScheduledFutureTask&lt;/span&gt;.run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ScheduledThreadPoolExecutor.java:305&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ThreadPoolExecutor.java:1136&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.util.concurrent.ThreadPoolExecutor&lt;span class=&quot;token variable&quot;&gt;$Worker&lt;/span&gt;.run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ThreadPoolExecutor.java:635&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.Thread.run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Thread.java:833&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Caused by: java.io.IOException: &lt;span class=&quot;token assign-left variable&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;, No such &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; or directory
	at java.base/java.lang.ProcessImpl.forkAndExec&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Native Method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.ProcessImpl.&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;init&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ProcessImpl.java:314&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.ProcessImpl.start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ProcessImpl.java:244&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	at java.base/java.lang.ProcessBuilder.start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ProcessBuilder.java:1110&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token number&quot;&gt;13&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;more&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;로그를 살펴보니 &lt;code class=&quot;language-text&quot;&gt;.wakatime/wakatime-cli-darwin-arm64&lt;/code&gt; 파일이 없어서 wakatime-cli 실행을 하지 못한다고 나와있다. wakatime-cli를 다시 설치해보자&lt;/p&gt;
&lt;p&gt;wakatime-cli의 실행은 공식문서에 나온대로
&lt;code class=&quot;language-text&quot;&gt;python3 -c &quot;$(wget -q -O - https://raw.githubusercontent.com/wakatime/vim-wakatime/master/scripts/install_cli.py)&quot;&lt;/code&gt;
해당 명령어를 실행하면 되는데 다음과 같은 에러가 뜨면서 설치가 되지 않았다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;WakaTime Install&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Downloading wakatime-cli&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;WakaTime Install&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; GitHub API Response &lt;span class=&quot;token number&quot;&gt;304&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;WakaTime Install&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Downloading wakatime-cli from https://github.com/wakatime/wakatime-cli/releases/download/&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;v1.70.1
&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; v1.68.3&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;/wakatime-cli-darwin-arm64.zip
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;WakaTime Install&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Traceback &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;most recent call last&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;:
  File &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;string&gt;&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;198&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; downloadCLI
  File &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;string&gt;&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;469&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; download
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; urlopen
    &lt;span class=&quot;token builtin class-name&quot;&gt;return&lt;/span&gt; opener.open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url, data, &lt;span class=&quot;token function&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;519&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self._open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;req, data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;536&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; _open
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self._call_chain&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self.handle_open, protocol, protocol +
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;496&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; _call_chain
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; func&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;*args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1391&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; https_open
    &lt;span class=&quot;token builtin class-name&quot;&gt;return&lt;/span&gt; self.do_open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;http.client.HTTPSConnection, req,
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1348&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; do_open
    h.request&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;req.get_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;, req.selector, req.data, headers,
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1282&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; request
    self._send_request&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method, url, body, headers, encode_chunked&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1293&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; _send_request
    self.putrequest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method, url, **skips&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1127&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; putrequest
    self._validate_path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  File &lt;span class=&quot;token string&quot;&gt;&quot;/opt/homebrew/Cellar/python@3.10/3.10.6_2/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/client.py&quot;&lt;/span&gt;, line &lt;span class=&quot;token number&quot;&gt;1227&lt;/span&gt;, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; _validate_path
    raise InvalidURL&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;f&lt;span class=&quot;token string&quot;&gt;&quot;URL can&apos;t contain control characters. {url!r} &quot;&lt;/span&gt;
http.client.InvalidURL: URL can&lt;span class=&quot;token string&quot;&gt;&apos;t contain control characters. &apos;&lt;/span&gt;/wakatime/wakatime-cli/releases/download/&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;v1.70.1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; v1.68.3&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&quot;/wakatime-cli-darwin-arm64.zip&lt;span class=&quot;token string&quot;&gt;&apos; (found at least &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;n&apos;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;WakaTime Install&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Finished extracting wakatime-cli.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;살펴보니 &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;http.client.InvalidURL: URL can&apos;t contain control characters. &apos;/wakatime/wakatime-cli/releases/download/&quot;&quot;&quot;v1.70.1\n= v1.68.3&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;/wakatime-cli-darwin-arm64.zip&apos; (found at least &apos;\n&apos;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;유효하지 않는 URL&lt;/strong&gt; 로 확인되는데. 해당 경로중에 문제되어 보이는 부분은 무수한 따옴표로 둘러싸인 부분이다. 아마 내부적으로 파싱이 잘못된것으로 보이인다.  Wakatime 내부 작동이 어디선가 잘못됬거나 설정이 꼬인것으로 보인다. 그리고 와카타임의 로그를 살펴보면 (와카타임 로그 파일의 위치는 &lt;code class=&quot;language-text&quot;&gt;~/.waktime.log&lt;/code&gt; )&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;{&quot;caller&quot;:&quot;cmd/run.go:292&quot;,&quot;file&quot;:&quot;Terminal&quot;,&quot;func&quot;:&quot;cmd.runCmd&quot;,&quot;level&quot;:&quot;error&quot;,&quot;message&quot;:&quot;failed to run command: sending heartbeat(s) failed: rate limited: won&apos;t send heartbeat due to backoff&quot;,&quot;now&quot;:&quot;2023-03-30T20:45:14+09:00&quot;,&quot;os/arch&quot;:&quot;darwin/arm64&quot;,&quot;plugin&quot;:&quot;iterm2-wakatime/0.0.1&quot;,&quot;time&quot;:1680176714.53137,&quot;version&quot;:&quot;v1.70.1&quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;won&apos;t send heartbeat due to backoff&lt;/code&gt; 오류가 발생하는데 다음과 같은 해결방법을 따라하면 해결된다.&lt;/p&gt;
&lt;h1 id=&quot;해결법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EA%B2%B0%EB%B2%95&quot; aria-label=&quot;해결법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해결법&lt;/h1&gt;
&lt;p&gt;와카타임 개발자에 &lt;a href=&quot;https://github.com/wakatime/wakatime-cli/issues/770&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;따르면&lt;/a&gt;
&lt;code class=&quot;language-text&quot;&gt;won&apos;t send heartbeat due to backoff&lt;/code&gt; means previously there was a connection error so it&apos;s waiting a while.
You can reset the rate limit backoff by deleting &lt;code class=&quot;language-text&quot;&gt;~/.wakatime-internal.cfg&lt;/code&gt;. What error message do you see after deleting the internal file&lt;/p&gt;
&lt;p&gt;즉 와카타임 에러 중에 &lt;code class=&quot;language-text&quot;&gt;won&apos;t send heartbeat due to backoff&lt;/code&gt; 가 발생하면 해당 wakatime-internal.cfg 파일을 삭제하라고 한다. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/aa8110c1492576d2de33f012ad2170e2/c6ff8/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABJ0lEQVQoz+2PTU/CQBBAK6Xd7nZbtgX7AcWAJ0NMjBe4GBMVuRIu/gH1YPErxpP6359YEo1iJHr28DIzOzMvs9Z0dsbT8wvl3QPz+0fmN7ecX1xyVc4py2um0xlHxyeMTyfrGU+wim6f0WjI8OCQnb19BrsDer0eWZaRJEkVO90OeTsnS9OqruJX3t4XWDqM8X3Ndr9H0mphGgbPk1iW9Y7rC0Rb4zQlItOI1EcWIV6ukd0QWzsf841oE60DWgtZURTkeU4YhsRxTDNuEpsIpRV+GuB3DXrLIJoKmWq8RONGssrryl0KTZTgugKp5OJSH6VU1bCdOo7xEIEg0JJG5CNCj5pX/3T9CiZOvm3YdRtbOdSc2s+CFeHiy8ti43eL64XWv/BvvAKjrv7k5WUTfAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/aa8110c1492576d2de33f012ad2170e2/fcda8/5.png&quot;
        srcset=&quot;/static/aa8110c1492576d2de33f012ad2170e2/12f09/5.png 148w,
/static/aa8110c1492576d2de33f012ad2170e2/e4a3f/5.png 295w,
/static/aa8110c1492576d2de33f012ad2170e2/fcda8/5.png 590w,
/static/aa8110c1492576d2de33f012ad2170e2/efc66/5.png 885w,
/static/aa8110c1492576d2de33f012ad2170e2/c6ff8/5.png 1088w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
그리고 해당 파일에 내용을 보면 cli_version 이 아까 파이썬으로 설치했을때 실패한 로그와 비슷하지 않는가?.. wakatime 내부 설정 파일이 잘못되서 발생한 오류였던것!
( 왜 저런 식으로 된지는 이유를 모르겠다. )&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/90a9c69edc3b2946bebc4e8081e48cef/339e3/6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADQ0lEQVQ4y0WTy28bZRTF/RewRkIqpE4Tx55xPB7b8fj9SJw28SNK4kdju05ip3GchwN5lCYiommTUpWCAqoqkU2hlA2ER4tQk0gIVSDBgh3tnhWFf+LH9SCVxdG936c757v33DOWo+9P+OrxMV8+esLj4594JPjuyVO++UHy0184efobP//+jB+fv+Dk2d+cvsQ/nP7xl+CFmR8Lfn3+JxZ3II5DD6B4Qma0awMo8TFcI1XscndOcVOcXcRXv8HrE2/TXdjC2sHkFc5W97GWd+ktbvFqZo2rBw/+J1S9IROK248mZNp4C6eRxOb0UJ5dIJpIYVdcODUvTrePfnsffdkF7Ik8LlXlbHcvO7v7WPRg4iWhInD5QkJYQc3MoUdSOOLjVOZXiaQy2NwGqi+COhBDdXmwj7fpH7mEbkToCmTYuX5TCEMJFF9QikIyohB38tgo9lgWb2wYx2CKUr1FZChNn+aXh4M4PEF6VZ1Q+iIfHX7Gg88fMlptsbl9Dct8e5PZ1iqNpTWWN7ZZXt+mubJOQ+6mm21mmsvsvf8xK5vvmOe55TWW1rZYFCytXeXdm3e4cetDWu0NDj/9AosnlDTHdfmjGPFhDOnKFxmS/LwZveFBZhbaRIez2GXkzjk8NCoSpPHHUrgGRAJfGJt0f/3WB1gUaf+c6qHH6TWhytkrj/RLUadYkcWUpueJCoHbiMnDEXP0DrmpvdRrgQRWd5hr+7exVBuLTM00KdUuS5w3N1pttJiszArqjEvc3Nmj3npTiC9TktpCtW4iX22YNcXaHGPFMp/cf4glW7zEhVye4VyB0cky5ek6uWJN8grpySlS2TyrV3aErEkqPc6FdI50vsZUY5lCuUZ6okQmXxEJstw9vC8jS9vdWhDrxAZdEwf0BCbocQ3gDJ2XkcP09vvMToxIkjN6kq71IzZqOhGfgx5vHLfIo4kMr3U72H3vjizFb4hBt3FmlnCGx+gr3UPVfTj9cTQjSkfjikhgJLOUs7p8tMK32zY2J604hTAa/2+B3YoubjgQHxriv+hFegv30Cp3UUba8rd4TZN3tm+Tbju6GoM5kkGVr1uvcPTWGXJDuixH3CG+1GRZb/S52Lt9wL+yeAjUg3vp3wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/90a9c69edc3b2946bebc4e8081e48cef/fcda8/6.png&quot;
        srcset=&quot;/static/90a9c69edc3b2946bebc4e8081e48cef/12f09/6.png 148w,
/static/90a9c69edc3b2946bebc4e8081e48cef/e4a3f/6.png 295w,
/static/90a9c69edc3b2946bebc4e8081e48cef/fcda8/6.png 590w,
/static/90a9c69edc3b2946bebc4e8081e48cef/efc66/6.png 885w,
/static/90a9c69edc3b2946bebc4e8081e48cef/339e3/6.png 977w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;해당 파일을 삭제하니 정상적으로 되는 모습이다..&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[K8S] Cert-Manager 설치 및 ACME DNS01 챌린지를 통한 Let's encrypt 인증서 발급 및 사용]]></title><description><![CDATA[Cert-Manager 
Cert-Manager는 Kubernetes 내부에서 HTTPS 통신을 위한 인증서를 생성하고 인증서가 만료되면 자동으로 갱신해주는 Certificate Manager Controller 이다. 해당 문서에서는 Cert-Ma…]]></description><link>https://hoon9901.github.io/cert-manager-begin/</link><guid isPermaLink="false">https://hoon9901.github.io/cert-manager-begin/</guid><pubDate>Tue, 14 Mar 2023 17:09:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;cert-manager&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cert-manager&quot; aria-label=&quot;cert manager permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cert-Manager&lt;/h1&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/77f959d65a7b998e8ce7277ee7a7a0a0/ab986/0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABuUlEQVQoz42SS2/TUBCF8+PoCjb9AfAfABHozgskdiwQQl2wpkvEY4OQEKCKQptgJ1GakDqkIU5T/I7fjmN/XBtQW5JKjGak0blzzj1Xd2qu42BZDt7wKT8bNzlt1DFaEuH0FU57i9PmXUz5Fu7oGdHosehvYyp1IvUhofacoFtn1riH371DYuxSK4qcPC/IgiELVyEym/j6VyL3mMSWCYwGC1uBVIf4B6mlEFtNEqdL6H4nNPbFnEI2V1gmOjUuiUJUloNIxsaMntbjUOujWXqFlWfFGp5wWCCS0un5KsFlnlVDj95K3Nje4PqTK2y/e1Bh2TJb4ZRaFxyWwFl/hgexztQcookKE4PLOecE/x78dlxUjx7rMe2RT3voY3vgR6AcubRUm+7YJ0mXK6IrgnEcM5lozB0TaWfKNanFVanDzkeDF591NrYO2JS+sHm/IxynFaf81BXBf28qo68lfPoWstvzObEXnFgJe4OQvb7PwVFA/D8O0zTFNE3mnk8eGkQTsUbH+7AIhJWMWJNxBx/EFg3WmlgrqKoqumnhzVQM+SW6/JosmpMmCebhe6zOG7xJ9w8vvyD6C29l7jKRJscYAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/77f959d65a7b998e8ce7277ee7a7a0a0/fcda8/0.png&quot;
        srcset=&quot;/static/77f959d65a7b998e8ce7277ee7a7a0a0/12f09/0.png 148w,
/static/77f959d65a7b998e8ce7277ee7a7a0a0/e4a3f/0.png 295w,
/static/77f959d65a7b998e8ce7277ee7a7a0a0/fcda8/0.png 590w,
/static/77f959d65a7b998e8ce7277ee7a7a0a0/efc66/0.png 885w,
/static/77f959d65a7b998e8ce7277ee7a7a0a0/c83ae/0.png 1180w,
/static/77f959d65a7b998e8ce7277ee7a7a0a0/ab986/0.png 2114w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Cert-Manager는 Kubernetes 내부에서 HTTPS 통신을 위한 인증서를 생성하고 인증서가 만료되면 자동으로 갱신해주는 Certificate Manager Controller 이다.&lt;/p&gt;
&lt;p&gt;해당 문서에서는 Cert-Manager에 대해 간단한 설치 방법과 Kubernetes의 인그레스에 적용하는 방법을 알아본다.
그리고 ACME의 HTTP01 챌린지가 아닌 DNS01 챌린지를 통해 도메인 검증을 하는 과정을 적용한다.&lt;/p&gt;
&lt;h2 id=&quot;시작하기-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;시작하기 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시작하기 앞서&lt;/h2&gt;
&lt;p&gt;Cert-Manager를 Helm를 통해서 설치한다 설치하는 차트 버전은 1.11 이다.
&lt;code class=&quot;language-text&quot;&gt;installCRDs=true&lt;/code&gt;를 통해 CRD 또한 함께 설치한다.&lt;/p&gt;
&lt;h3 id=&quot;설치&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EC%B9%98&quot; aria-label=&quot;설치 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설치&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;helm repo &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; jetstack https://charts.jetstack.io &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    helm &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; cert-manager jetstack/cert-manager &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token parameter variable&quot;&gt;--namespace&lt;/span&gt; cert-manager &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        --create-namespace &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token parameter variable&quot;&gt;--version&lt;/span&gt; v1.11.0 &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token parameter variable&quot;&gt;--set&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;installCRDs&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;true&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;cert-manager-issuer-생성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cert-manager-issuer-%EC%83%9D%EC%84%B1&quot; aria-label=&quot;cert manager issuer 생성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Cert-Manager Issuer 생성&lt;/h2&gt;
&lt;p&gt;ACME 발급자에 대해 다양한 DNS 공급자가 지원되는데 Cloudflare를 이용해보자.&lt;/p&gt;
&lt;p&gt;토큰은 사용자 프로필 &gt; API 토큰 &gt; API 토큰에서 생성할 수 있다. 다음 설정이 권장된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Permissions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Zone - DNS - Edit&lt;/li&gt;
&lt;li&gt;Zone - Zone - Read&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zone Resources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Include - All Zones&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;새 Issuer를 만들려면 먼저 새 API 토큰을 포함하는 Kubernetes Secret를 만든다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Secret
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cloudflare&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;secret
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cert&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;manager
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Opaque
&lt;span class=&quot;token key atrule&quot;&gt;stringData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;api-token&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;API_TOKEN_HERE&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;cloudflare-api-token-secret&lt;/code&gt; 이름을 가진 Secret 리소스를 생성한다.
api-token의 value로 cloudflare에서 발급받은 key를 넣어주면된다.
중요한 부분으로 namespace는 cert-manager가 설치된 곳으로 지정한다. 생략하면 Issuer에서 secret를 참조하지 못한다.&lt;/p&gt;
&lt;p&gt;Cert-Manager에서 제공하는 Issuer는 ClusterIssuer와 그냥 Issuer가 있다 둘의 차이점은 네임스페이스이다. Issuer는 생성된 네임스페이스에서만 적용이 되고 Cluster Issuer는 전체 네임스페이스의 여러 앱에서 사용할 수 있다.&lt;/p&gt;
&lt;p&gt;다음은 두개의 ClusterIssuer를 생성하는 YAML 이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cert&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;manager.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterIssuer
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; letsencrypt&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;staging
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;acme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# The ACME server URL&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//acme&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;staging&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;v02.api.letsencrypt.org/directory
    &lt;span class=&quot;token comment&quot;&gt;# Email address used for ACME registration&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;Email&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Name of a secret used to store the ACME account private key&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;privateKeySecretRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; letsencrypt&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;staging
    &lt;span class=&quot;token key atrule&quot;&gt;solvers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;dns01&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;cloudflare&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;Email&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;apiTokenSecretRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cloudflare&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;secret
            &lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;token
&lt;span class=&quot;token punctuation&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cert&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;manager.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClusterIssuer
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; letsencrypt&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;prod
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;acme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# The ACME server URL&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//acme&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;v02.api.letsencrypt.org/directory
    &lt;span class=&quot;token comment&quot;&gt;# Email address used for ACME registration&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;Email&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Name of a secret used to store the ACME account private key&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;privateKeySecretRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; letsencrypt&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;prod

    &lt;span class=&quot;token key atrule&quot;&gt;solvers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;dns01&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;cloudflare&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;Email&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;apiTokenSecretRef&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; cloudflare&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;secret
            &lt;span class=&quot;token key atrule&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; api&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;token&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&apos;s Encrypt에 대해 스테이징 및 프로덕션의 두 발급자를 설정하는데.&lt;/p&gt;
&lt;p&gt;Let&apos;s Encrypt 프로덕션 발급자는 매우 &lt;a href=&quot;https://letsencrypt.org/docs/rate-limits/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;엄격한 속도 제한&lt;/a&gt;이 있다. 실험하고 학습할 때 이러한 한계에 도달하기가 매우 쉽습니다. 이러한 위험 때문에 Let&apos;s Encrypt 스테이징 발급자로 시작하고 작동하는 것이 만족스러우면 프로덕션 발급자로 전환한다.&lt;/p&gt;
&lt;h2 id=&quot;ingress-tls-적용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ingress-tls-%EC%A0%81%EC%9A%A9&quot; aria-label=&quot;ingress tls 적용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Ingress TLS 적용&lt;/h2&gt;
&lt;p&gt;Ingress에 CertManager의 TLS를 적용하기 위해선 YAML 명세 파일에 두가지 부분을 추가하면 된다.&lt;/p&gt;
&lt;p&gt;만약 두개의 서비스를 인그레스로 각각 서브 도메인을 지정한다면 다음과 같은 모습으로 구성된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;apiVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; networking.k8s.io/v1
&lt;span class=&quot;token key atrule&quot;&gt;kind&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Ingress
&lt;span class=&quot;token key atrule&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; service&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ingress
  &lt;span class=&quot;token key atrule&quot;&gt;namespace&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; default
  &lt;span class=&quot;token key atrule&quot;&gt;annotations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;kubernetes.io/ingress.class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; nginx
    &lt;span class=&quot;token key atrule&quot;&gt;nginx.ingress.kubernetes.io/proxy-body-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1000000m&quot;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;cert-manager.io/cluster-issuer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;letsencrypt-staging&quot;&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;spec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;tls&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;hosts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &amp;lt;domain1&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &amp;lt;domain2&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;secretName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;TLS_SECRET_NAME&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;rules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;domain1&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /
            &lt;span class=&quot;token key atrule&quot;&gt;pathType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Prefix
            &lt;span class=&quot;token key atrule&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;token key atrule&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;service_name&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
                &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                  &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; port1
    &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;domain2&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /
            &lt;span class=&quot;token key atrule&quot;&gt;pathType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Prefix
            &lt;span class=&quot;token key atrule&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;token key atrule&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &amp;lt;service_name&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;
                &lt;span class=&quot;token key atrule&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                  &lt;span class=&quot;token key atrule&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; port2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;annotations 부분에 &lt;code class=&quot;language-text&quot;&gt;cert-manager.io/cluster-issuer: &quot;letsencrypt-staging&quot;&lt;/code&gt; 부분을 추가한다. cluster-issuer가 아닌 경우 issuer를 사용하면 된다.
즉 &lt;code class=&quot;language-text&quot;&gt;cert-manager.io/issuer&lt;/code&gt; 이다.
그 다음으론 TLS secret를 지정한다 &lt;code class=&quot;language-text&quot;&gt;secretName: &amp;lt;TLS_SECRET_NAME&gt;&amp;lt;/TLS_SECRET_NAME&gt;&lt;/code&gt; 해당 Secret은 우리가 생성해야하는 것이 아닌, cert-manager가 생성하는 secret이다. 해당 인그레스를 적용해서 생성하면은 자동으로 Cert-Manager가 해당 Secret Name으로 TLS 비밀키를 생성한다. 생성된 Secret의 데이터는 TLS 관련 개인키와 공개키가 데이터로 포함된다.&lt;/p&gt;
&lt;p&gt;스테이징이 잘 등록되면은 Prod으로 변경한다. 스테이징 인증서로 인그레스 도메인에 접속하면은 신뢰되지 않는 인증서로 등록된다. &lt;/p&gt;
&lt;h2 id=&quot;tls-적용된-모습&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tls-%EC%A0%81%EC%9A%A9%EB%90%9C-%EB%AA%A8%EC%8A%B5&quot; aria-label=&quot;tls 적용된 모습 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TLS 적용된 모습&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 579px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/50e73cbfd8ba3d81018943bed6bfff9a/c08bc/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVQ4y41TTW/TQBD1v0VwgPYvwAUBdy6cEFA4QYVEBVKRmh4qRCoUCLShEonzaeOs7fjb6919zKyVoiAIHenpjXZ3nsezbx0FoJQGHFEUYz6fw3VdDIdDi+l0itlshtFoZJn31+uTyQRSShhjoLW27KjlN/z49BJBUiAUS/R6n9Hv94l7GAwGtpAxHo+tILPrtjkLep6HMAyJfTRNAwf+R5x29nDhF4CqsVrFyPMMaZrQ12tshqEu9OaK7Uxb5n2H/3Z9RFLSEKRq87oBKjpwiYaBljfW2ryhOifJcoQBzckTCESMkiqsoDJQJHpVaGpMpApO5zzH0+MpXp24OOzH6HyvcEx4f1bgbb/Fu6//B5+78Co4jzoZrj2O8OAgwP0DgTv7S9x7E+H26wQ7z2Psvohxa0/g5jNBHP4VO4TrTwSOzgu6lI2QOPtyivDnDLpKoIoIuozxe8rbo8hTsg0NoFF8e0BelAiWAkVZ0SxrpHmBLC8h6aYUDanRxvK/UNc1HK2NNSTHarVCt9u1xmbDKqXsXmtcc5n/Cd5jSPbhWmwdbFY2L5uVwcLbYqNaS/5lZZ8NB7e8WCwghLC5LTDbO+NZLTMDLyUkZJuyLO2TWQv6vo8gCJBl2dUEqceHHwxu7BvcPQJ+ASuj2GvGLAhAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Untitled&quot;
        title=&quot;Untitled&quot;
        src=&quot;/static/50e73cbfd8ba3d81018943bed6bfff9a/c08bc/1.png&quot;
        srcset=&quot;/static/50e73cbfd8ba3d81018943bed6bfff9a/12f09/1.png 148w,
/static/50e73cbfd8ba3d81018943bed6bfff9a/e4a3f/1.png 295w,
/static/50e73cbfd8ba3d81018943bed6bfff9a/c08bc/1.png 579w&quot;
        sizes=&quot;(max-width: 579px) 100vw, 579px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
인증서를 letsencrypt-prod으로 등록해서 인그레스를 다시 수정해서 적용하면은 인증서가 정상적으로 등록되는데 만약에 제대로 등록이 안된다면 기존 Secret를 삭제하면된다.&lt;/p&gt;
&lt;p&gt;공식 문서에서 따르면 cert-manager가 감시하고 업데이트된 발급자로 요청을 다시 처리하도록 하는 기존 Secret를 삭제해야 한다고 한다. 이렇게 하면 새 인증서를 받는 프로세스가 시작되고 설명을 사용하여 상태를 볼 수 있다. &lt;/p&gt;
&lt;h1 id=&quot;레퍼런스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4&quot; aria-label=&quot;레퍼런스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레퍼런스&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://cert-manager.io/docs/tutorials/acme/nginx-ingress/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://cert-manager.io/docs/tutorials/acme/nginx-ingress/&lt;/a&gt;
&lt;a href=&quot;https://cert-manager.io/docs/configuration/acme/dns01/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://cert-manager.io/docs/configuration/acme/dns01/&lt;/a&gt;
&lt;a href=&quot;https://github.com/cert-manager/cert-manager/issues/2131&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/cert-manager/cert-manager/issues/2131&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[NestJS의 개요 및 특징]]></title><description><![CDATA[NestJS란  Node.JS에 기반을 둔 웹 API 프레임워크
Express 또는 Fastify 프레임워크를 래핑하여 동작함 Node.js는 쉽게 사용하고 뛰어난 확장성이 있지만, 과도한 유연함으로 인해 SW의 품질이 일정하지 않고 알맞는 라이브러…]]></description><link>https://hoon9901.github.io/what-is-nestjs/</link><guid isPermaLink="false">https://hoon9901.github.io/what-is-nestjs/</guid><pubDate>Fri, 10 Feb 2023 18:23:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;nestjs란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#nestjs%EB%9E%80&quot; aria-label=&quot;nestjs란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;NestJS란&lt;/h1&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1b4454700307bf243f459357d3ff8df9/9f82e/nest-og.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz21RO07DQBB1gQgh2d2ZXa9/G2M7SwDLUohiGhqSAikVEhHQcQgqrsANOAc3iERBwQFoEGfgCoydxIkinrYYzc6bN/PGAQBEhBoUCCGaDAJKCrYziEqq6inluq7DOV8y+RaoUEJFa/NuhzPgoqkRFAuQKLWrHViDNKs/IYjZEWJPsAPBhmgS0F3guC6TUgZ+EIWRMWZDXk1O7QFSdF9M+RbP3uO7J/+CwUqZBD3tEdn3/H7Wd3CN1UqILeAPQf/DTr/tzVc2X8S3917RAqawWoW2pRZU3It6FVnW2LaNJLSUj6H9Gcx+jx+eo3Ifua59IrcqI6UkcachNKA2bRDXfvyani/s5aedFirsgiDBKIjSo5RoJjQ2s7tjN40oMKjmfnKidBu4rJO0cJZk+Wle5MVoONo9FWNsmSGLKGoxdsg2p6KZSXxgB+W4nFxN/jlVY3t1tvptjiGAZk6TND/Lx6PxH8vaOcKj51iWAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;nest og&quot;
        title=&quot;nest og&quot;
        src=&quot;/static/1b4454700307bf243f459357d3ff8df9/fcda8/nest-og.png&quot;
        srcset=&quot;/static/1b4454700307bf243f459357d3ff8df9/12f09/nest-og.png 148w,
/static/1b4454700307bf243f459357d3ff8df9/e4a3f/nest-og.png 295w,
/static/1b4454700307bf243f459357d3ff8df9/fcda8/nest-og.png 590w,
/static/1b4454700307bf243f459357d3ff8df9/9f82e/nest-og.png 820w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Node.JS에 기반을 둔 웹 API 프레임워크
Express 또는 Fastify 프레임워크를 래핑하여 동작함&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Node.js는 쉽게 사용하고 뛰어난 확장성이 있지만, 과도한 유연함으로 인해 SW의 품질이 일정하지 않고 알맞는 라이브러리를 찾기 위해 개발자가 많은 시간을 할애해야함. 이에 반해 NestJS는 데이터베이스, ORM, 설정(Configuration), 유효성 검사 등 수많은 기능을 기본으로 제공.
그리고 기본적으로 설치하면 Express를 Platform으로 사용함. &lt;/p&gt;
&lt;h2 id=&quot;특징&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8A%B9%EC%A7%95&quot; aria-label=&quot;특징 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;특징&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;기본 기능과 추가적으로 필요한 라이브러리를 설치해 쉽게 확장할 수 있는 Node.js의 장점을 가짐&lt;/li&gt;
&lt;li&gt;Angular로 부터 영향을 많이 받아. 모듈/컴포넌트 기반으로 작성하여 재사용성을 높임&lt;/li&gt;
&lt;li&gt;IoC, DI, AOP 와 같은 객체지향 개념을 도입함&lt;/li&gt;
&lt;li&gt;기본적으로 Typescript를 채택&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;자세한건 &lt;a href=&quot;https://docs.nestjs.com&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;NestJS 공식 가이드 문서&lt;/a&gt; 참고&lt;/p&gt;
&lt;h1 id=&quot;expressjs-vs-nestjs&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#expressjs-vs-nestjs&quot; aria-label=&quot;expressjs vs nestjs permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Express.js vs NestJS&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;구분&lt;/th&gt;
&lt;th&gt;Express.js&lt;/th&gt;
&lt;th&gt;NestJS&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;유연함, 확장성&lt;/td&gt;
&lt;td&gt;가볍게 서버를 띄울 수 있음. 하지만 높은 자유도로 인해 개발에 맞는 라이브러리를 찾아야함, 깃허브에 보일러플레이트를 이용한 코드베이스가 많음&lt;/td&gt;
&lt;td&gt;미들웨어, IoC, CQRS 등 이미 많은 기능이 프레임워크 자체에 포함됨. 사용자는 문서를 보고 쉽게 따라할 수 있음, 원하는 기능이 없다면 다른 라이브러리를 적용하면됨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TypeScript 지원&lt;/td&gt;
&lt;td&gt;추가 설정을 통해 사용&lt;/td&gt;
&lt;td&gt;기본적으로 Typescript, 추가 설정으로 JS로도 작성 가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;커뮤니티&lt;/td&gt;
&lt;td&gt;가장 큼&lt;/td&gt;
&lt;td&gt;꾸준히 증가&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;nest-js-벤치마크&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#nest-js-%EB%B2%A4%EC%B9%98%EB%A7%88%ED%81%AC&quot; aria-label=&quot;nest js 벤치마크 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Nest JS 벤치마크&lt;/h1&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3264ac73c10df5531f1a8e7adbfea611/5c744/benchmark.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 33.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABRUlEQVQozzVR2XKDMBDjuZOkEM5wG2OuQEiaTvP/X6auNu2DB9ar1Uqyd/AT/J/P8ILGLjDDinNSIq8djFtxqSySvEU3bqi7Cf10wzmtUJnxjRdM6644nTN4UVYj/DsktAIelgf8KEcpA/P2VMJQCCb553DROO03/QI332XJjKzs3oTj+lSC8fqFKGswyLdsRxyCVAfm7VsX+XGBft6V/OMUaU21dEPsUciI85yQkYQnzg2sbORdWlp0047l/kLeDEirHsv+Emur4tjvBcu5pOi0DuIS3iQK7SiZJJXaoK1KNnOjkVxWIWQsBLNXCPlRFAWikJm65a7KeE5USBvMypcB5siaOYVprWomsZyIIsZhRTEfKlBso32SUgzxFOTN+w9qeSkCksII4IZettIGwbSciV3WJCzNpORcYoZN7+JLqzEw118VQb+723bP2QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;benchmark&quot;
        title=&quot;benchmark&quot;
        src=&quot;/static/3264ac73c10df5531f1a8e7adbfea611/fcda8/benchmark.png&quot;
        srcset=&quot;/static/3264ac73c10df5531f1a8e7adbfea611/12f09/benchmark.png 148w,
/static/3264ac73c10df5531f1a8e7adbfea611/e4a3f/benchmark.png 295w,
/static/3264ac73c10df5531f1a8e7adbfea611/fcda8/benchmark.png 590w,
/static/3264ac73c10df5531f1a8e7adbfea611/efc66/benchmark.png 885w,
/static/3264ac73c10df5531f1a8e7adbfea611/c83ae/benchmark.png 1180w,
/static/3264ac73c10df5531f1a8e7adbfea611/5c744/benchmark.png 1206w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
NestJS에 Express와 Fastify를 적용했을 경우(Platform으로)와 Express, Fastify 자체 성능 측정표&lt;/p&gt;
&lt;p&gt;측정 결과는 Express가 Fastify보다 느리고, NestJS Platform으로 적용하면 약간 더 성능이 떨어지는 것을 알 수 있음. 이는 NestJS가 기본 제공하는 프레임워크의 크기가 크기 때문. 하지만 순수 Express나 Fastify로 서버를 개발하다보면 추가적으로 요구되는 라이브러리들이 추가되므로 결국 NestJS에서 제공하는 기능들을 모두 구현한다고 했을땐 성능 차이가 크게 나지는 않음.&lt;/p&gt;
&lt;p&gt;Express 프레임워크는 2022년도에 4.18.2 버전을 업데이트하였지만 최근에 와서야 활발하게 업데이트가 되고 있지만 그전에는 진짜 몇달동안 공백기가 있었음. 5.0을 준비하는 이유 때문일 수 있고, 매우 안정적인 프레임워크라 문제없이 운용되고 있다고 볼 수 있지만 최신 트렌드를 따라가지 못한다는 우려가 있는것은 사실.&lt;/p&gt;
&lt;p&gt;반면에 NestJS는 꾸준히 발전 중. 최근 릴리즈가 v9.3.6 (2023-02-08, 현재 글이 생성된 날짜기준) 이고 &lt;a href=&quot;https://github.com/nestjs&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;깃허브&lt;/a&gt;를 통해 커뮤니티도 활발히 하고 있음.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[Monitoring] Prometheus 개요 및 특징 그리고 데이터 수집 방식]]></title><description><![CDATA[Prometheus는 메트릭 수집, 알림, 서비스 디스커버리 기능을 제공하는 오픈소스 모니터링 시스템입니다. Prometheus는 단기 작업을 위해 직접 스크랩 하거나
short-lived jobs를 push gateway를 통해 스크랩합니다.
스크…]]></description><link>https://hoon9901.github.io/what-is-prometheus/</link><guid isPermaLink="false">https://hoon9901.github.io/what-is-prometheus/</guid><pubDate>Thu, 09 Feb 2023 10:09:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/deada13263aaf9b4e16dc560fd0ccebb/6edca/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADaElEQVQozz2SS2wbVRiFLzh1EtpFkWjJhgU7aHdRQAhCSpEQj6oLloQNQoiwIRVKpQgh2V2kUV8gyoIdLYkIIg2icpKaOICJmzpuHKexa7t+zTPz8oztuZ6XZ8bj0WXsphzpW9xfV0fn3P8CURRzLMtCUayyvCifhKoV1gwTcULVphnWIUja0XTD1s02qmvuMEIIeHrOw4+Xs6BAl1/N1Eu/FyEZxiX6IyBDOM1xfLzRkBcU3XiRlYzEPldDNE0hCJtIliFiGAY1oIokXnrbFujZGlaMQApbc4jCcIkhh8kak2PqHC5AcRJ8DYAvl81ezKeSJ+qqAkq0NJbOFX8uV5X3WR2N7ivOqTIHT5VYOEbupIachph0GpLm1Ku6TJQ+oxluTJGbe7AhVwzdOAfa9WrFI99uSKxJVz5wZPFLyFBpC89ft7HsFZt4dK3DU1eQof7QKuy+1K38hDvzPx310n+oqMquoiiEoqrngM3TYYOuRFyR/cMlH73escyca1uoLdeQ3ZBQG9aRo6vIdV1kMsRZniTA5ubmN4lkaiQe2+gZT50/f2h8fLwvGAw+DZwaDxCZB/e2k1/sbMZOt5ryXUXTkG5attYyHcO0nLosW4rSRMY+/i5FUuDv9fWR9bXIUNeMrxR9geAFMDExAaampgAoZfb88fDyQGp3d/xh4t4rLQUmFEVFhqG7TQiRpqlI142OaduIz+2d8bb7jEffdtRLV0wDi6JAvpQBwcAFEFpdBcAwjF7sXPoBGOm+jW3tocdqe3S6uBJnm7FVpHPUewffps9mqYttlixaLH3tYAYWv70EAI7jHxME8ck+w5xduH71cCWb+UegKbWQSQs/fv+d+Ff4jihgJZ5ObemZrbtvEYV8L0CLL8838AJqCditaB2Bk6+909dzhV4tSZK8ahrCMPzEvxsbf2IYpsdisero6JvSzMyMxHK8UCEpYy0SOf3/ljvSL6aQRcit3fJsjvh8/uH+/kNHQSgUejkQCJyZm5t7w7voD92+/aw3G0qldo575x6Lvy4cDy3+9vz8zRv+ycmvnuoa1oTizSZ3HzVrlQXPcHBw8PALAwP9R8BB/2MevunpaRCNRsHKygqIx+OPq7VaYGlpCSwvL4PZ2Vlw+fKlnmF86/6n26mHN7YSyc/T6R3wRP8Bv6Khni6cOA0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Prometheus아키텍처&quot;
        title=&quot;Prometheus아키텍처&quot;
        src=&quot;/static/deada13263aaf9b4e16dc560fd0ccebb/fcda8/1.png&quot;
        srcset=&quot;/static/deada13263aaf9b4e16dc560fd0ccebb/12f09/1.png 148w,
/static/deada13263aaf9b4e16dc560fd0ccebb/e4a3f/1.png 295w,
/static/deada13263aaf9b4e16dc560fd0ccebb/fcda8/1.png 590w,
/static/deada13263aaf9b4e16dc560fd0ccebb/efc66/1.png 885w,
/static/deada13263aaf9b4e16dc560fd0ccebb/c83ae/1.png 1180w,
/static/deada13263aaf9b4e16dc560fd0ccebb/6edca/1.png 1351w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Prometheus는 메트릭 수집, 알림, 서비스 디스커버리 기능을 제공하는 오픈소스 모니터링 시스템입니다.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Prometheus는 단기 작업을 위해 직접 스크랩 하거나
short-lived jobs를 push gateway를 통해 스크랩합니다.
스크랩한 모든 sample(TSD, 시계열 데이터)을 local 저장소에 저장하고 이 데이터에 대한 규칙(rules)을 실행하여 기존 데이터에서 새 시계열을 집계 및 기록하거나 alert를 생성합니다.
Grafana 또는 기타 APIConsumers를 사용해 수집된 데이터를 시각화할 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;prometheus-특징&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus-%ED%8A%B9%EC%A7%95&quot; aria-label=&quot;prometheus 특징 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus 특징&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TSD를 스크랩하고 저장하는 메인 Prometheus 서버&lt;/li&gt;
&lt;li&gt;Application 코드를 계측하기 위한 &lt;a href=&quot;https://prometheus.io/docs/instrumenting/clientlibs/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Client Libraries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;short-lived jobs를 위한 push gateway&lt;/li&gt;
&lt;li&gt;특수 목적의 exportes (HAProxy, StatsD, Graphite)&lt;/li&gt;
&lt;li&gt;alert를 핸들링하는 (처리하는) alertManager&lt;/li&gt;
&lt;li&gt;다양한 지원 도구&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;prometheus-데이터-수집-방식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%88%98%EC%A7%91-%EB%B0%A9%EC%8B%9D&quot; aria-label=&quot;prometheus 데이터 수집 방식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus 데이터 수집 방식&lt;/h2&gt;
&lt;p&gt;Prometheus의 데이터 수집방식은 Pull 방식입니다. (Push 방식도 지원함)
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d06fff49c204ba4cf080295a662562a7/e8950/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 23.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKUlEQVQY022QvUrDABSFAwWfwxdwcfaFnDq56KAuioiLtU4u4qCgLqKCUKhUjMVq/amU0qQ2SdukpA0hzY/WmnzGSpfg5Z47HM4993IE/qsojMfXH6JvwigpCAnDcCKO+1c7jOkRQkbU2S+b2MGQfq+L6zr47geHF2V2j0Sequ3xWsXw2LnTOXjuoxgWqqKitTq8ywonVy/sHRepVDWE1NIt05uPlBUHTbOQ5TY1qcRs9pHUygMbN/rYcFvsICwWmcsUqNdKdOIDRoxXxWYmW2Fq9Z4t0UBYuGyydt1CtwMC/xPPDbAGDut5lfRZg5xkjw0LTYf0eazNK7RNC7M3oG/5mM6Q5ZzG/GmNQvENYZKK73k0GnL8pUqUyCxKEJ7nI0l1ul0jEe2IH0tPZyJjnFY8AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Push/Pull방식&quot;
        title=&quot;Push/Pull방식&quot;
        src=&quot;/static/d06fff49c204ba4cf080295a662562a7/fcda8/2.png&quot;
        srcset=&quot;/static/d06fff49c204ba4cf080295a662562a7/12f09/2.png 148w,
/static/d06fff49c204ba4cf080295a662562a7/e4a3f/2.png 295w,
/static/d06fff49c204ba4cf080295a662562a7/fcda8/2.png 590w,
/static/d06fff49c204ba4cf080295a662562a7/efc66/2.png 885w,
/static/d06fff49c204ba4cf080295a662562a7/c83ae/2.png 1180w,
/static/d06fff49c204ba4cf080295a662562a7/e8950/2.png 2000w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Push 방식 - 데이터를 가진 곳에서 필요한 곳(모니터링 서비스)으로 보내준다.&lt;/li&gt;
&lt;li&gt;Pull 방식 - 데이터가 필요한 곳(모니터링 서비스)에서 가진 곳에 접속해 데이터를 긁어간다(Scrape)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이러한 방식들의 장단점은 4가지 측면에서 자세히 살펴 볼 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;수집 대상이 Auto-scaling 등으로 가변적일 경우&lt;/li&gt;
&lt;li&gt;수집 대상의 데이터 유연성 측면&lt;/li&gt;
&lt;li&gt;보안 측면&lt;/li&gt;
&lt;li&gt;HA* 측면&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;*프로그램 등의 시스템이 상당히 오랜 기간동안 지속적으로 정상 운영이 가능한 성질&lt;/p&gt;
&lt;h3 id=&quot;1-수집대상이-가변적일-경우&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EC%88%98%EC%A7%91%EB%8C%80%EC%83%81%EC%9D%B4-%EA%B0%80%EB%B3%80%EC%A0%81%EC%9D%BC-%EA%B2%BD%EC%9A%B0&quot; aria-label=&quot;1 수집대상이 가변적일 경우 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 수집대상이 가변적일 경우&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1da97a71775632b6f0a7af41d1157f47/efb68/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 35.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABwElEQVQoz3WRzWoTARSFZ+XGpfgKCj6BT+EbuBcUF910I4guqiK4cVXtSlrppiaCEBEMWrSmjU1DJ4m1Sdp0Emcy//+Zyfx9DoNb7+pcOOfcyznCUF/w/MuU1y2FKM353xz/CdjqqOyeB9WepBlpVoBjga6AqVIUBUK9b3LpYYtrL444mfp47pKkJCaGgT++IJhIlcFqY4Lw4IC7299xVRlFX1bcj6LCau0XtWYP8hRhMvd49XnI9o9SHKX4YYE1l9nZ/cr1pwfcfjuoDD8cTlnZ7LDzbYBre8zmPskiYaVxweVHLZ419qCIEdojg3tbXdYaQ0wnRJq5hJZOvbXPjZc97mz+LC9HvNmXubV+xEaziy5PGU1MNM2nPQ14350yE+vEjorwrmdxZe2Qm+t9JDUkCCKyLCcrv1qksIziEuU8bs64+qTD/ZpI5DgYdoznJ/8STskdl9T3EWamz6f+nL2xyVxVOTsbIUkSSVJmGUcs47iSKG5M+9xgrIUosszp8LSMJySKlwSLqMw9q3iC59pEnkXoWphlEYZpYts2Rok1TcfQtKo9ipzId/BsE1EUEQcndLvH/O730HUdz/Mqw7/Cq/XBa5TkTAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;가변적&quot;
        title=&quot;가변적&quot;
        src=&quot;/static/1da97a71775632b6f0a7af41d1157f47/fcda8/3.png&quot;
        srcset=&quot;/static/1da97a71775632b6f0a7af41d1157f47/12f09/3.png 148w,
/static/1da97a71775632b6f0a7af41d1157f47/e4a3f/3.png 295w,
/static/1da97a71775632b6f0a7af41d1157f47/fcda8/3.png 590w,
/static/1da97a71775632b6f0a7af41d1157f47/efc66/3.png 885w,
/static/1da97a71775632b6f0a7af41d1157f47/c83ae/3.png 1180w,
/static/1da97a71775632b6f0a7af41d1157f47/efb68/3.png 2032w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Push 방식이 유리합니다.&lt;/p&gt;
&lt;h3 id=&quot;2-수집-대상의-데이터-유연성-측면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%88%98%EC%A7%91-%EB%8C%80%EC%83%81%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9C%A0%EC%97%B0%EC%84%B1-%EC%B8%A1%EB%A9%B4&quot; aria-label=&quot;2 수집 대상의 데이터 유연성 측면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 수집 대상의 데이터 유연성 측면&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8a64750e2f017deb3e18355d40d824d7/08485/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABj0lEQVQY0yWQT4vTUBTF803cutGV+AFEXOjWtRuX+kUGFNzoblApuHArCsMwoLSgpbQNTZvG6bSvTWOaafOnNUnb17zk55t64Szu5QfnnmOosiI/KHZFSVmVcCM9ZbpnL6bImUt1kFT6JgvFXnO5VPzdJOTbjG2WIuceUrPVwsM4u0y486bL449DBiJAiDmb0KfeaXH3pMWDtyb+Rh5NH334zb13FmfNJuORy2Do0XfmPKv1uH/S4Ot3E+ObE3P7dZuHp31Gi4woLoi003nzgqfvG7z4dM5yHZPsKl5+/sXz0y90rTppqojXimUieVIbcutVh5qVYNwETAvYKthtc1bLgCQKj7GLfIlKXcpDhtKZKxlx0LvcpYSra6JVcORiCX6myPYFhu959LodbHfFT9Pm4keDetuiqWO1Oyaj8RSldL9KMZ3NGV0JxrM/mP0h3YGDczVBODb+dKLrLzHWcczS97nUUKdnY5o9LHuE2WoRBAvCcEVRFP8/0awQE7woZR5nWjnudcxMCKIoPjL/AFjPrisA7qskAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;유연성&quot;
        title=&quot;유연성&quot;
        src=&quot;/static/8a64750e2f017deb3e18355d40d824d7/fcda8/4.png&quot;
        srcset=&quot;/static/8a64750e2f017deb3e18355d40d824d7/12f09/4.png 148w,
/static/8a64750e2f017deb3e18355d40d824d7/e4a3f/4.png 295w,
/static/8a64750e2f017deb3e18355d40d824d7/fcda8/4.png 590w,
/static/8a64750e2f017deb3e18355d40d824d7/efc66/4.png 885w,
/static/8a64750e2f017deb3e18355d40d824d7/c83ae/4.png 1180w,
/static/8a64750e2f017deb3e18355d40d824d7/08485/4.png 2014w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Pull 방식이 유리합니다.&lt;/p&gt;
&lt;h3 id=&quot;3-보안-측면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%EB%B3%B4%EC%95%88-%EC%B8%A1%EB%A9%B4&quot; aria-label=&quot;3 보안 측면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 보안 측면&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0a7b6060dfb09ec4b285729b2d6cfa0e/ed8a2/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.054054054054056%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABb0lEQVQY04WRTUsbURiF51+4KYL/wF1Xom5clO4L3bnwTxQXguBCBL8qiAhahK5KdioiQfwgYhqjBsHUz0nrTSZmxjgTvXNvcmeeTgQLWfXAWbznPavnWLoV0XYUx3QoSu529C9XiSX/kzXy44q+xQJrOec1kEqjPYH6lSc8O4Bnn0DDQvqYsdQ2m7kL5LPkydf4jRbafaRplxLbxCrEev/1lJ7JHOPrd7gPioqosXe0w/BKmk/LabKlOi+qxZfUAcPf0sxuZCjbt9hC4tUkqXyF/rksn9fOqb4YrK6JLL2zJ2Qu6wSBIaj7HJ6f0jtfoHvqjEypge1JPiwdMjC3w/fdPDXxh1I5xPcUKz8d3k0XGJrZwxMCa3TLZmZfILXBtDRhKGmaiGqjiXhSrxiu3ZCPq0UGl4sc3ZRRfo3KQwPXDaj6iuOq4qp4Q+z8xnqDaYzBcRzsNg+tO0DHyTAmipJOxNtETqXMvbhPnlFH9y9Bba4/Z9qHuAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;보안&quot;
        title=&quot;보안&quot;
        src=&quot;/static/0a7b6060dfb09ec4b285729b2d6cfa0e/fcda8/5.png&quot;
        srcset=&quot;/static/0a7b6060dfb09ec4b285729b2d6cfa0e/12f09/5.png 148w,
/static/0a7b6060dfb09ec4b285729b2d6cfa0e/e4a3f/5.png 295w,
/static/0a7b6060dfb09ec4b285729b2d6cfa0e/fcda8/5.png 590w,
/static/0a7b6060dfb09ec4b285729b2d6cfa0e/efc66/5.png 885w,
/static/0a7b6060dfb09ec4b285729b2d6cfa0e/c83ae/5.png 1180w,
/static/0a7b6060dfb09ec4b285729b2d6cfa0e/ed8a2/5.png 1972w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Push 방식이 유리합니다. &lt;/p&gt;
&lt;p&gt;그 이유는 Pull 방식은 수집 대상에서 중앙 모니터링이 접근할 수 있는 IP, Port 등을 수신 대기해야합니다.&lt;/p&gt;
&lt;h3 id=&quot;4-ha-측면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-ha-%EC%B8%A1%EB%A9%B4&quot; aria-label=&quot;4 ha 측면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. HA 측면&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d3516168bc6d34495f9d436dfd627df7/a4f52/6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfElEQVQY01WRS2sUURSEe+8/EP+A+B8EdyEEXPoX3GUrCG6zEUxWQfGBWUiCILjISlzMQDKLyUMxM3HoZEKmJ+lu5pG2n7cf9345060L7+Zw6xRFVR3LGENWaJK8ouL/V/0JKYdDdFE0gHAXfFMvhV2WNUaRw8SHXGHlpWblQ48H6z/43LmUxYTUmxDFc57u9Hj4co/d/rTWW/16zuOPfb6dCC+YkV2JSJzwdt/hyUabzY6LpcTd0vsT7r86Ymv/inSa4F8HTH2b5deH3H3R5tOxXws+evOLe2tdtvcOxKGSVI3x1S8D7jxr8fzdd6wFEClNkFaUehFGSwpdE8dRhT1ThKopo+8ldEcR07QRyjKF0ZrhTU57nOEdH2AV0k+uUso8E/cpg7MLBvY5UZKgBdPSVVEZtDH/mqUqFK7r8vv0FE+mkT9/L2AFQYDjjBmNRrjzEC/MuZ5HTIJYcAdnFuPHBZVuXAdyKNs+o91q0T36Sac35LBnE4ZhfaBb55e2V4SRAzwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;HA&quot;
        title=&quot;HA&quot;
        src=&quot;/static/d3516168bc6d34495f9d436dfd627df7/fcda8/6.png&quot;
        srcset=&quot;/static/d3516168bc6d34495f9d436dfd627df7/12f09/6.png 148w,
/static/d3516168bc6d34495f9d436dfd627df7/e4a3f/6.png 295w,
/static/d3516168bc6d34495f9d436dfd627df7/fcda8/6.png 590w,
/static/d3516168bc6d34495f9d436dfd627df7/efc66/6.png 885w,
/static/d3516168bc6d34495f9d436dfd627df7/c83ae/6.png 1180w,
/static/d3516168bc6d34495f9d436dfd627df7/a4f52/6.png 2024w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Pull 방식이 유리합니다.&lt;/p&gt;
&lt;p&gt;Push 방식은 수집 대상이 중앙에 데이터 전송을 재시도를 지속적으로 해야하므로 영향이 생깁니다.
Pull 방식은 중앙 모니터링이 장애가 발생하더라도 수집 대상에는 영향이 없습니다.&lt;/p&gt;
&lt;h2 id=&quot;prometheus-metrics&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus-metrics&quot; aria-label=&quot;prometheus metrics permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus Metrics&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Metrics 구성
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2928ab6a07b40e1a50c34206ae864cdc/d53ff/7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+0lEQVQ4y41T2ZKbMBDk/z9vk+wmWwaDLsRtG2wOA50esqRwnkJVo5ZG0+rREazrChDrAf/zyax1XXDMlzbYg8dvrDMMhcOQW/Rebf2xKdCnCXqOTZfyJeuYH2zK04T5fkftPSqiOIfIf73Dvr/B/niD+/iG7POD7Xf4nwR5kzoUluLdHXg+sY7jl8OuA5IEKOiAbR/HeCiFwVg82O/CE3ptCI1eacY0BvYHzumiCLNWWDTzyde2pcPrFWNZ4r4s6LnSyPZJ64JpmXFtSgyHMYHMe0hV5G17Q8U5z6oCbjcES9NsrrI0hWPb5DlGrvSQheg+Z1mFcxvvmTAwltKdlUouFzhW4azD43wGmBMsnDicTliyDDMTBVL6ZAxGljkavY0Jl3HZhvGr5EFJjPvIuGzbeu9YMm17ulJMUBRxdJqQW7aWE2MmJuKIPOfWOGeQpwqpiXG9VCjKCp5m9tMOVu5PKoksQWAodqZ9TRHDBWQs4oYLL/KC8QTexbA6wqXOkdOM5G+CcsryS8UVLQt2EU3hncsCwjMmW5Mg2wRDNLyfIuiOggsduoNDERJHig4FYRi+9FUcwVtWEH+iLj0FC1RywkeHnpdZhAQiLk4tT1ewOxdueDc1Haae7m2Mmq+nrmtenfZVcJ5niNP9LR/5v33h8/wH+/jfJ0j+GwAb22jJzm2/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;metrics&quot;
        title=&quot;metrics&quot;
        src=&quot;/static/2928ab6a07b40e1a50c34206ae864cdc/fcda8/7.png&quot;
        srcset=&quot;/static/2928ab6a07b40e1a50c34206ae864cdc/12f09/7.png 148w,
/static/2928ab6a07b40e1a50c34206ae864cdc/e4a3f/7.png 295w,
/static/2928ab6a07b40e1a50c34206ae864cdc/fcda8/7.png 590w,
/static/2928ab6a07b40e1a50c34206ae864cdc/efc66/7.png 885w,
/static/2928ab6a07b40e1a50c34206ae864cdc/d53ff/7.png 1068w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Prometheus 메트릭 구성은 아래와 같습니다.
&lt;code class=&quot;language-text&quot;&gt;메트릭이름{필드1=값,필드2=값} @시간 샘플데이터(float 64)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Metrics 표현 형식
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/09ede/8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 32.43243243243243%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA7UlEQVQY01WRSYrDMBREdf/TZJcDZB3TkWfaYGyMQW7PI9iLapWIRLIo6mv4TyVJxLcbpOfh5/WC93xChiF+Hw/85Tn6aULf905d1xkNw2DEuWVZnLZtg/DjGGEUwfd9SCkRamBeFFBNYzbM8+wa1nX9cmrSh9Kv68JxHBAExIRqjzS40DCmIMimoI/j6JLahFZco9gnCCEwCAIDjfU4TVNUVYW6ro2UUsYbndoeQsD0fpIvIEFJkhhgpD3LMpRl6Roo1gSxZnLKXvVzjvuETcakwf2OXH+OaluTptVOEN1+Bp1vte+78fM8XU3oP0QTvfIIttLFAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;metrics&quot;
        title=&quot;metrics&quot;
        src=&quot;/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/fcda8/8.png&quot;
        srcset=&quot;/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/12f09/8.png 148w,
/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/e4a3f/8.png 295w,
/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/fcda8/8.png 590w,
/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/efc66/8.png 885w,
/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/c83ae/8.png 1180w,
/static/f8b6a1a1a4e2ac0dce8882501b45e2d9/09ede/8.png 1710w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
Prometheus Metrics은 사람이 쉽게 이해할만한 표현 형식입니다.&lt;/li&gt;
&lt;li&gt;# HELP 는 메트릭 이름, 간단한 설명(주석)&lt;/li&gt;
&lt;li&gt;# TYPE 은 메트릭 타입 (Prometheus Metric Type : Counter, Gauge, Histogram, Summary)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;prometheus-아키텍처&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98&quot; aria-label=&quot;prometheus 아키텍처 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus 아키텍처&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/90c21ae2c2c41a1adf326fc5fc39a627/536c7/9.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 64.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACgUlEQVQ4y21TyW7bMBD1X7aHnttDP65/0JyKLkAQF0ESu27iTbIWWiLFRZS4vY4Uw+ghBAYaQuR7b+YNF1xY1EygrBqcGwVlPEJMMHYE7xRaIed89BE+JHjvIYSAMQbTijFi8NP/ESklLLgw6ARHVRbQWqMhgimyLMNut0Oe5yiKAlJp2NHD2R6b1ROK7DgDCtNhI/bYdhmGccSiHyL6waKsGRypaOWIE1M4leyqrmKkvu3oQkDgZ7hzCccKeKMxOIe2bcA5n9UvtLTwSqCr6RApHHo6UJ7AGUPyDp4UxXFAmL5uROw1gpaIRsEqCU2lN00DcQXkEr6p4InR8QZGKITRYmQlxuIAV+XwbY00gQ39a5lSwg7DnE8gjlR6Io8hEKAeSAk1tTfQHTESgaW8J2ZLiqcwSkFSnyO1ZlpVVUOSYW+then9nEzSn7c7dE2H5szAyUnRdWiplClvpKaeCQI+kTGcbpCQRIqjIUEKKWj6dmSKfQVMKSJNx2T/JnNcfkcUGRg7QUmBRO76tkIwEik6AqD7nmOh9IiBSumpzEAu7+sCm/wP9tUey9USt4+32BcvWN18wbn+e5m9hLEh4O0DvKj/Y1VYtK0iy9t57tzg8fvwjG/LH1hvN/j4+RPefXiPp+cVlscXPBb3sxIfPDlPLcmeaG+QZwfc3z9gMIxMMQ51XWG9XkMrA0YmFKZBqVvcZHf4erwDMxxHWUP1jFSE15ckS6jiF3p9prE5I8tpKvpm6mEgIEUsOY2Cg7XxWgHpmOO6psYHixAc9bLE4XikoT5PDlz+kykDlZnzEQ+lhVDTPMX5TUaK+RxFvOxT9DMoLo6m7ieSfiSSnvZydvofntbjCd/FzYYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;아키텍처&quot;
        title=&quot;아키텍처&quot;
        src=&quot;/static/90c21ae2c2c41a1adf326fc5fc39a627/fcda8/9.png&quot;
        srcset=&quot;/static/90c21ae2c2c41a1adf326fc5fc39a627/12f09/9.png 148w,
/static/90c21ae2c2c41a1adf326fc5fc39a627/e4a3f/9.png 295w,
/static/90c21ae2c2c41a1adf326fc5fc39a627/fcda8/9.png 590w,
/static/90c21ae2c2c41a1adf326fc5fc39a627/efc66/9.png 885w,
/static/90c21ae2c2c41a1adf326fc5fc39a627/c83ae/9.png 1180w,
/static/90c21ae2c2c41a1adf326fc5fc39a627/536c7/9.png 1480w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
모니터링의 기능으로 아키텍처를 파악하면 3가지로 구분될 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;수집 - 수집 대상으로 부터 Exporter를 설치, Prometheus Server가 Pull 방식으로 데이터 수집
Service Discover를 통해 Target 서버에 대한 정보를 편리하게 가져옴&lt;/li&gt;
&lt;li&gt;저장 - Prometheus는 Sample(시계열 데이터) 수집시, In-Memory에 저장하고 있다가 주기적으로 Disk에 Flush함&lt;/li&gt;
&lt;li&gt;서빙 - PromQL를 통해 질의하거나 외부 API 나 Prometheus Web UI, Grafana를 통해 데이터를 내보내거나 시각화&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;prometheus-적합성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus-%EC%A0%81%ED%95%A9%EC%84%B1&quot; aria-label=&quot;prometheus 적합성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus 적합성&lt;/h2&gt;
&lt;h3 id=&quot;prometheus는-언제-적합한가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus%EB%8A%94-%EC%96%B8%EC%A0%9C-%EC%A0%81%ED%95%A9%ED%95%9C%EA%B0%80&quot; aria-label=&quot;prometheus는 언제 적합한가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus는 언제 적합한가?&lt;/h3&gt;
&lt;p&gt;이러한 경우에 Prometheus가 적합할 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;단순 숫자로 된 시계열 기록&lt;/li&gt;
&lt;li&gt;모니터링과 고도의 동적인 서비스 지향 아키텍처 모니터링&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Prometheus는 MSA(Micro Service Architecture)에서 다차원 데이터 수집 및 쿼리 지원은 강점
Prometheus는 모니터링 시스템으로서 안정성을 위해 설계되었고 각 프로메테우스 서버는 독립형이며 네트워크 스토리지 또는 원격 서비스에 의존하지 않습니다.&lt;/p&gt;
&lt;h3 id=&quot;prometheus는-언제-적합하지-않는가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prometheus%EB%8A%94-%EC%96%B8%EC%A0%9C-%EC%A0%81%ED%95%A9%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EA%B0%80&quot; aria-label=&quot;prometheus는 언제 적합하지 않는가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prometheus는 언제 적합하지 않는가?&lt;/h3&gt;
&lt;p&gt;요청당 청구 (per-request billing)과 같이 100% 정확도가 필요한 경우 수집된 데이터가 충분히 자세하고 완전하지 않을 수 있어서 좋은 선택이 아닐 수 있습니다.&lt;/p&gt;
&lt;p&gt;청구(billing)을 위해 데이터를 수집하고 분석하는데 다른 시스템을 사용하고 나머지 모니터링을 Prometheus를 사용하는게 가장 좋음&lt;/p&gt;</content:encoded></item></channel></rss>